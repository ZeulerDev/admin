import{r as o,y as ue,A as u,j as s,h as he}from"./index-D3QfJGEc.js";import{a as $}from"./axios-Cm0UX6qg.js";import{P as H,F as xe,O as ge}from"./OccasionalEmployeePDF-Cs1OsiUA.js";import{B as Q}from"./config-HOLfLxHr.js";import{b as pe,a as x}from"./CContainer-SkiLYL4n.js";import{C as _,a as ye,b as fe,d as je,e as g}from"./DefaultLayout-D1JUfsyf.js";import{C as Ce}from"./CNavbar-DrnOaIAd.js";import{C as Pe}from"./CFormInput-kbUX0XsV.js";import{C as be,a as me,b as A,c as n,d as we,e as l}from"./CTable-0Zi6KOL_.js";import{C as Se,a as E}from"./CPaginationItem-WVPg8jye.js";import{C as W,a as Y,b as U,c as q}from"./CModalTitle-CePgAe4s.js";import"./inheritsLoose-BR9xv5Kf.js";import"./typeof-QjJsDpFa.js";import"./index-B81hxpGb.js";import"./CFormLabel-WCNlfVmk.js";const Oe=()=>{const[C,R]=o.useState(!1),[G,p]=o.useState(!1),[{user:J,token:P},d]=ue(),[K,b]=o.useState(!1),[m,B]=o.useState([]),[y,X]=o.useState([]),[Z,I]=o.useState("All"),[F,L]=o.useState(""),[c,w]=o.useState(""),[ee,z]=o.useState(c),[M,S]=o.useState(""),[V,se]=o.useState(""),[te,ae]=o.useState(0),[f,k]=o.useState(1),[T,D]=o.useState(0),[oe,O]=o.useState(!0);o.useEffect(()=>{const e=setTimeout(()=>{d({type:u,payload:{status:!0,title:"Data Loading",message:"Data loading error: Timeout exceeded",color:"warning"}}),b(!1)},2e4);return j(0,e),()=>{clearTimeout(e)}},[F,ee]),o.useEffect(()=>{const e=setTimeout(()=>{(c.length>=3||c.length===0)&&z(c)},500);return()=>{clearTimeout(e)}},[c]);const j=(e,t)=>{b(!0),$.get(Q+`assistant/pickers/payouts/${e}?status=${F}&no=${c}`,{headers:{Authorization:`Bearer ${P}`}}).then(a=>{a.status===200?(B(a.data.data),ae(a.data.count),b(!1),clearTimeout(t),a.data.list.length<50?(O(!0),console.log("ok")):a.data.list.length>49&&O(!1)):a.status===204?d({type:u,payload:{status:!0,title:"Error",message:a.data.message,color:"warning"}}):a.status===500&&(console.log("error","500"),d({type:u,payload:{status:!0,title:"Error",message:a.data.message,color:"warning"}}))}).catch(a=>{console.log("Error",a)})},le=()=>{k(f+1);const e=T+50;D(e),j(e,!0)},ne=()=>{k(f-1);const e=T-50;console.log(e),D(e),j(e,!1)},re=(e,t)=>{R(!C),X({type:e,item:t}),console.log("Toggle",e,t)},v=(e,t)=>{p(!C),se(e),console.log("VIew",e,t),t==="waiting"||t==="sent"?S("ready"):t==="ready"&&S("done")},ce=()=>{console.log("Confirmation",M,V);const e={status:M};J&&P&&$.patch(Q+"assistant/payout/change/"+V,e,{headers:{Authorization:`Bearer ${P}`}}).then(t=>{if(t.status===200){console.log("updated"),p(!1);const a=t.data,r=m.map(N=>N.id===a.id?a:N);B([...r]),d({type:u,payload:{status:!0,title:"Pricker Payout status",message:"Payout status updated successfully",color:"success"}})}else t.status===203?d({type:u,payload:{status:!0,title:"Pricker Payout status error",message:t.data.message}}):t.status===204?(console.log("204"),d({type:u,payload:{status:!0,title:"Pricker Payout status error",message:t.data.message}})):t.status===500&&d({type:u,payload:{status:!0,title:"Pricker Payout status update error",message:t.data.message}})}).catch(t=>{console.error(t)})},h=e=>{e==="all"?(L(""),I("All"),w("")):(console.log(e),L(e),I(e),w(""))},ie=e=>{k(e);const t=(e-1)*50;D(t),j(t,!0)},de=()=>{const e=Math.ceil(te/50),t=[];for(let i=1;i<=e;i++)t.push(i);const a=Math.max(f-2,1),r=Math.min(a+4,e);return t.slice(a-1,r).map(i=>s.jsx(E,{active:f===i,onClick:()=>ie(i),children:i},i))};return s.jsxs(pe,{children:[s.jsx(_,{style:{marginLeft:"75%"},color:"secondary",children:"Filter by"}),s.jsxs(ye,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[s.jsx(fe,{style:{color:"white"},children:Z}),s.jsxs(je,{children:[s.jsx(g,{onClick:()=>h("all"),children:"All"}),s.jsx(g,{onClick:()=>h("pending"),children:"Pending"}),s.jsx(g,{onClick:()=>h("sent"),children:"Sent"}),s.jsx(g,{onClick:()=>h("ready"),children:"Ready"}),s.jsx(g,{onClick:()=>h("waiting"),children:"Waiting"}),s.jsx(g,{onClick:()=>h("done"),children:"Done"})]})]}),s.jsx(Ce,{style:{marginTop:"1%"},className:"bg-body-tertiary",children:s.jsx(Pe,{type:"text",placeholder:"Search By No",style:{width:450,marginLeft:"0%"},value:c,onChange:e=>w(e.target.value)})}),K?s.jsx("div",{className:"d-flex justify-content-center",children:s.jsx(he,{style:{marginTop:"15%"}})}):s.jsxs(be,{children:[s.jsx(me,{children:s.jsxs(A,{children:[s.jsx(n,{scope:"col",children:"#"}),s.jsx(n,{scope:"col",children:"No"}),s.jsx(n,{scope:"col",children:"Name"}),s.jsx(n,{scope:"col",children:"Status"}),s.jsx(n,{scope:"col",children:"Date"}),s.jsx(n,{scope:"col",children:"Total"}),s.jsx(n,{scope:"col",children:"Tax"}),s.jsx(n,{scope:"col",children:"Tips"}),s.jsx(n,{scope:"col",children:"Payable"}),s.jsx(n,{scope:"col",children:"Action"}),s.jsx(n,{scope:"col",children:"PDF"})]})}),s.jsx(we,{children:m.length===0?s.jsx(A,{children:s.jsx(l,{colSpan:"11",style:{textAlign:"center",backgroundColor:"white"},children:s.jsx("h6",{style:{marginTop:"1%"},children:"No Data"})})}):m.map((e,t)=>{let a="info",r="";return(e==null?void 0:e.status)==="pending"?(r="Pending",a="info"):(e==null?void 0:e.status)==="done"?(r="Paid",a="primary"):(e==null?void 0:e.status)==="sent"?(r="Sent",a="success"):(e==null?void 0:e.status)==="waiting"?(r="Waiting",a="warning"):(e==null?void 0:e.status)==="ready"&&(r="Ready",a="danger"),s.jsxs(A,{children:[s.jsx(l,{children:t+1}),s.jsx(l,{children:e.no}),s.jsx(l,{children:e.name}),s.jsx(l,{children:s.jsx(_,{style:{width:60},color:a,children:r})}),s.jsx(l,{children:e.date}),s.jsx(l,{children:e.total}),s.jsx(l,{children:e.tax}),s.jsx(l,{children:e.tips}),s.jsx(l,{children:e.payable}),s.jsxs(l,{children:[(e==null?void 0:e.status)==="waiting"&&s.jsx(x,{onClick:()=>v(e.id,e.status),size:"sm",color:a,style:{width:90},children:"Received"}),(e==null?void 0:e.status)==="sent"&&s.jsx(x,{size:"sm",onClick:()=>v(e.id,e.status),color:a,style:{width:90},children:"Received"}),(e==null?void 0:e.status)==="ready"&&s.jsx(x,{size:"sm",onClick:()=>v(e.id,e.status),color:a,style:{width:90},children:"To Pay"})]}),s.jsxs(l,{children:[s.jsx(x,{size:"sm",style:{backgroundColor:"#ff4d4d",width:80,color:"white"},onClick:()=>re(e.type,e),children:"View"})," "]})]},t)})})]}),s.jsxs(Se,{"aria-label":"Page navigation example",children:[s.jsx(E,{disabled:T<=0,onClick:ne,children:"Previous"}),de(),s.jsx(E,{disabled:oe===!0,onClick:le,children:"Next"})]}),s.jsxs(W,{visible:C,scrollable:!0,size:"xl",onClose:()=>R(!1),children:[s.jsx(Y,{closeButton:!0,children:s.jsx(U,{children:"Information"})}),s.jsx(q,{style:{overflowY:"auto",maxHeight:"70vh",display:"flex",justifyContent:"center"},children:s.jsx(o.Suspense,{fallback:s.jsx("div",{children:"Loading PDF Viewer..."}),children:y.type==="flat_rate"?s.jsx(H,{style:{width:"100%",height:"100vh"},children:s.jsx(xe,{data:y.item})}):y.type==="occasional"?s.jsx(H,{style:{width:"100%",height:"100vh"},children:s.jsx(ge,{data:y.item})}):null})})]}),s.jsxs(W,{alignment:"center",visible:G,scrollable:!0,size:"sm",onClose:()=>p(!1),children:[s.jsx(Y,{closeButton:!1,children:s.jsx(U,{children:"Confirmation"})}),s.jsxs(q,{children:[s.jsx("a",{children:"Are you sure you want to pay out status ?"}),s.jsx("br",{}),s.jsx("br",{}),s.jsxs("div",{style:{display:"flex",justifyContent:"center"},children:[s.jsx(x,{onClick:()=>ce(),style:{backgroundColor:"#ff4d4d",color:"white",marginRight:"10px"},children:"Yes"}),s.jsx(x,{onClick:()=>p(!1),style:{backgroundColor:"#ff4d4d",color:"white",marginLeft:"10px"},children:"No"})]})]})]})]})};export{Oe as default};
