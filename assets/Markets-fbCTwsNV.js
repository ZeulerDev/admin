import{r as o,_ as ae,u as te,a as l,b as z,P as c,c as S,x as se,l as le,z as d,j as a,L as re,i as oe}from"./index-B2mJY6nk.js";import{a as F}from"./axios-B4uVmeYG.js";import{b as ne,a as J}from"./CContainer-HxaQKhHw.js";import{C as ie}from"./CNavbar-C6aw6t1r.js";import{C as K,a as Q,b as W,c as P}from"./DefaultLayout-CXJ534N4.js";import{C as ce,a as de,b as X,c as k,d as ue,e as C}from"./CTable-D7t5m_Bv.js";import{a as _,C as Y}from"./CFormLabel-BMh_f0jF.js";import{C as he,a as Z}from"./CPaginationItem-DTZe_mIK.js";var y=o.forwardRef(function(s,u){var n=s.className,i=s.button,B=s.feedback,L=s.feedbackInvalid,V=s.feedbackValid,R=s.floatingLabel,T=s.tooltipFeedback,j=s.hitArea,h=s.id,m=s.indeterminate,w=s.inline,E=s.invalid,p=s.label,I=s.reverse,D=s.type,U=D===void 0?"checkbox":D,b=s.valid,$=ae(s,["className","button","feedback","feedbackInvalid","feedbackValid","floatingLabel","tooltipFeedback","hitArea","id","indeterminate","inline","invalid","label","reverse","type","valid"]),f=o.useRef(null),g=te(u,f);o.useEffect(function(){f.current&&m&&(f.current.indeterminate=m)},[m,f.current]);var v=function(){return l.createElement("input",z({type:U,className:S(i?"btn-check":"form-check-input",{"is-invalid":E,"is-valid":b,"me-2":j}),id:h},$,{ref:g}))},M=function(){return l.createElement(_,{describedby:$["aria-describedby"],feedback:B,feedbackInvalid:L,feedbackValid:V,floatingLabel:R,invalid:E,tooltipFeedback:T,valid:b})},A=function(){var x;return l.createElement(Y,z({customClassName:S(i?S("btn",i.variant?"btn-".concat(i.variant,"-").concat(i.color):"btn-".concat(i.color),(x={},x["btn-".concat(i.size)]=i.size,x),"".concat(i.shape)):"form-check-label")},h&&{htmlFor:h}),p)},N=function(){return i?l.createElement(l.Fragment,null,l.createElement(v,null),p&&l.createElement(A,null),l.createElement(M,null)):p?j?l.createElement(l.Fragment,null,l.createElement(v,null),l.createElement(Y,z({customClassName:S("form-check-label stretched-link",n)},h&&{htmlFor:h}),p),l.createElement(M,null)):l.createElement("div",{className:S("form-check",{"form-check-inline":w,"form-check-reverse":I,"is-invalid":E,"is-valid":b},n)},l.createElement(v,null),l.createElement(A,null),l.createElement(M,null)):l.createElement(v,null)};return l.createElement(N,null)});y.propTypes=z({button:c.object,className:c.string,hitArea:c.oneOf(["full"]),id:c.string,indeterminate:c.bool,inline:c.bool,label:c.oneOfType([c.string,c.node]),reverse:c.bool,type:c.oneOf(["checkbox","radio"])},_.propTypes);y.displayName="CFormCheck";const xe=()=>{const[{user:s,token:u},n]=se(),[i,B]=o.useState([]),[L,V]=o.useState([]),[R,T]=o.useState(""),[j,h]=o.useState(""),[m,w]=o.useState(0),[E,p]=o.useState("All Cities"),[I,D]=o.useState("All Chains");o.useState();const[U,b]=o.useState(!1),[$,f]=o.useState(!0);le(),o.useEffect(()=>{u&&F.get("http://localhost:8003/assistant/market/chains/all",{headers:{Authorization:`Bearer ${u}`}}).then(e=>{e.status===200?B(e.data):e.status===500&&n({type:d,payload:{status:!0,title:"Chain Loading error",message:e.data.message}})}).catch(e=>{console.error("Error: ",e)})},[]),o.useEffect(()=>{s&&u&&g(0)},[R,j,s]);const g=(e,t)=>{b(!0),F.get(`http://localhost:8003/assistant/market/locations/${e}?brand=${R}&city=${j}`,{headers:{Authorization:`Bearer ${u}`}}).then(r=>{r.status===200?(V(r.data.data),b(!1),r.data.data.length<20?(f(!0),console.log("ok")):r.data.data.length>19&&f(!1)):r.status===500&&n({type:d,payload:{status:!0,title:"Market Loading error",message:r.data.message}})}).catch(r=>{console.error("Error: ",r)})},v=()=>{const e=m+20;w(e),g(e)},M=()=>{const e=m-20;console.log(e),w(e),g(e)},A=(e,t)=>{e==="all"?(T(""),D("All Chains")):(T(e),D(t))},N=e=>{e==="all"?(h(""),p("All Cities")):(h(e),p(e))},x=(e,t,r)=>{console.log(e),console.log(L),r==="delivery"?(q({market:e,service:r}),console.log("add delivery")):r==="pickup"&&(q({market:e,service:r}),console.log("add pickup"))},H=(e,t,r)=>{r==="delivery"?(G({market:e,service:r}),console.log("remove delivery")):r==="pickup"&&(G({market:e,service:r}),console.log("remove pickup"))},q=e=>{F.post("http://localhost:8003/assistant/markets/add/services",e,{headers:{Authorization:`Bearer ${u}`}}).then(t=>{t.status===200?console.log("Updated add service"):t.status===203?n({type:d,payload:{status:!0,title:"Market Updated error",message:t.data.message}}):t.status===204?n({type:d,payload:{status:!0,title:"Market Updated error",message:t.data.message}}):t.status===500&&n({type:d,payload:{status:!0,title:"Market Updated error",message:t.data.message}})}).catch(t=>{console.error("Error:",t)})},G=e=>{F.post("http://localhost:8003/assistant/markets/remove/services",e,{headers:{Authorization:`Bearer ${u}`}}).then(t=>{t.status===200?console.log("Updated remove service"):t.status===203?n({type:d,payload:{status:!0,title:"Market remove error",message:t.data.message}}):t.status===204?n({type:d,payload:{status:!0,title:"Market remove error",message:t.data.message}}):t.status===500&&n({type:d,payload:{status:!0,title:"Market remove error",message:t.data.message}})}).catch(t=>{console.error("Error:",t)})},ee=e=>{console.log(e),F.delete("http://localhost:8003/market/"+e,{headers:{Authorization:`Bearer ${u}`}}).then(t=>{t.status===200?(n({type:d,payload:{status:!0,title:"Market Delete",message:"Market Remove Success",color:"success"}}),g(0),console.log("Remove Market")):t.status===404?n({type:d,payload:{status:!0,title:"Market remove error",message:t.data.message}}):t.status===500&&n({type:d,payload:{status:!0,title:"Market remove error",message:t.data.message}})}).catch(t=>{console.error("Error:",t)})};return a.jsxs(ne,{children:[a.jsxs(ie,{className:"bg-body-tertiary",children:[a.jsx(re,{to:"/markets/addmarket",children:a.jsx(J,{color:"success",variant:"outline",style:{marginLeft:"3%",width:"200px"},children:"Add New Market"})}),a.jsxs(K,{style:{marginLeft:"55%",width:"10%",backgroundColor:"#ff4d4d"},children:[a.jsx(Q,{children:E}),a.jsxs(W,{children:[a.jsx(P,{onClick:()=>N("all"),children:"All"}),a.jsx(P,{onClick:()=>N("Milano"),children:"Milano"}),a.jsx(P,{onClick:()=>N("Napoli"),children:"Napoli"})]})]}),a.jsxs(K,{style:{marginRight:"1%",width:"15%",backgroundColor:"#ff4d4d"},children:[a.jsx(Q,{children:I}),a.jsxs(W,{children:[a.jsx(P,{onClick:()=>A("all"),children:"All"}),i.map((e,t)=>a.jsx(P,{onClick:()=>A(e.id,e.name),children:e.name},t))]})]})]}),U?a.jsx(oe,{}):a.jsxs(ce,{children:[a.jsx(de,{children:a.jsxs(X,{children:[a.jsx(k,{scope:"col",children:"Name"}),a.jsx(k,{scope:"col",children:"Address"}),a.jsx(k,{scope:"col",children:"City"}),a.jsx(k,{scope:"col",children:"Delivery"}),a.jsx(k,{scope:"col",children:"Pickup"}),a.jsx(k,{scope:"col",children:"Scraped"}),a.jsx(k,{scope:"col",children:"Remove"})]})}),a.jsx(ue,{children:L.map((e,t)=>a.jsxs(X,{children:[a.jsx(C,{children:e.chain.name}),a.jsx(C,{children:e.address}),a.jsx(C,{children:e.city}),a.jsx(C,{children:e.services.includes("delivery")?a.jsx(y,{id:"flexCheckChecked",label:"",defaultChecked:!0,onChange:()=>H(e._id,!0,"delivery")}):a.jsx(y,{id:"flexCheckChecked",label:"",onChange:()=>x(e._id,!0,"delivery")})}),a.jsx(C,{children:e.services.includes("pickup")?a.jsx(y,{id:"flexCheckChecked",label:"",defaultChecked:!0,onChange:()=>H(e._id,!0,"pickup")}):a.jsx(y,{id:"flexCheckChecked",label:"",onChange:()=>x(e._id,!0,"pickup")})}),a.jsx(C,{children:e.scraped}),a.jsx(C,{children:a.jsx(J,{size:"sm",style:{backgroundColor:"#ff4d4d"},variant:"outline",onClick:()=>ee(e._id),children:"Remove"})})]},t))})]}),a.jsxs(he,{"aria-label":"Page navigation example",children:[a.jsx(Z,{disabled:m<=0,onClick:M,children:"Previous"}),a.jsx(Z,{disabled:$===!0,onClick:v,children:"Next"})]})]})};export{xe as default};
