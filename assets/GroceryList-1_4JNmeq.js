import{r as l,y as re,A as P,j as e,h as T,m,L as z}from"./index-DL088vmD.js";import{a as ce}from"./axios-Cm0UX6qg.js";import{B as ie}from"./config-HOLfLxHr.js";import{b as ne}from"./CContainer-Cz7hNUvN.js";import{C as de}from"./CNavbar-BVF-796O.js";import{C as B,a as F,b as u,c as a,d as R,e as o}from"./CTable-BSxJfPDp.js";import{c as w}from"./cil-info-CmGCY32x.js";import{e as A}from"./DefaultLayout-CbdqckCh.js";import{C as xe,a as S}from"./CPaginationItem-QA40uF-_.js";import{C as H,a as V,b as G,c as O}from"./CModalTitle-gMqvNIMh.js";import{C as me}from"./CCardImage-u0t1JMSY.js";import{C as Y}from"./CModalFooter-BbdK8yzN.js";import{C as ue}from"./CRow-BMXIPApQ.js";import{C as v}from"./CFormLabel-Be3SnnEd.js";import{C as L}from"./CCol-B72LVP_5.js";import{C as N}from"./CFormInput-CpQLZKmo.js";const ke=()=>{const[D,I]=l.useState(!1),[_,M]=l.useState(!1),[{user:k,token:h},j]=re(),[q,Q]=l.useState([]);l.useState([]);const[U,p]=l.useState(!1),[C,he]=l.useState(!1);l.useState([]);const[f,$]=l.useState([]),[J,K]=l.useState([]),[i,g]=l.useState(0),[W,E]=l.useState(!0),[X,Z]=l.useState(0),[n,y]=l.useState(1);l.useEffect(()=>{const s=setTimeout(()=>{j({type:P,payload:{status:!0,title:"Data Loading",message:"Data loading error: Timeout exceeded",color:"warning"}}),p(!1)},2e4);return k&&h&&d(0,s),()=>{clearTimeout(s)}},[k,h]);const d=(s,r)=>{p(!0),ce.get(ie+"assistant/grocery/list/"+s,{headers:{Authorization:`Bearer ${h}`}}).then(t=>{t.status===200?(Q(t.data.list),Z(t.data.count),p(!1),clearTimeout(r),t.data.length<50?(E(!0),console.log("ok")):t.data.length>49&&E(!1)):t.status===204?j({type:P,payload:{status:!0,title:"Grocery List loading error",message:t.data.message}}):t.status===500&&j({type:P,payload:{status:!0,title:"Grocery List loading error",message:t.data.message}})}).catch(t=>{console.error("Error:",t)})},ee=()=>{y(n+1);const s=i+50;g(s),d(s,!0)},se=()=>{y(n-1);const s=i-50;console.log(s),g(s),d(s,!1)},te=s=>{y(s);const r=(s-1)*50;g(r),d(r,!0)},ae=()=>{const s=Math.ceil(X/50),r=[];for(let c=1;c<=s;c++)r.push(c);const t=Math.max(n-2,1),x=Math.min(t+4,s);return r.slice(t-1,x).map(c=>e.jsx(S,{active:n===c,onClick:()=>te(c),children:c},c))},le=s=>{I(!D),K(s)},oe=s=>{M(!C),$(s)};return e.jsxs(ne,{children:[e.jsx(de,{className:"bg-body-tertiary"}),U?e.jsx(T,{}):e.jsxs(B,{children:[e.jsx(F,{children:e.jsxs(u,{children:[e.jsx(a,{scope:"col",children:"#"}),e.jsx(a,{scope:"col",children:"Name"}),e.jsx(a,{scope:"col",children:"Date"}),e.jsx(a,{scope:"col",children:"Type"}),e.jsx(a,{scope:"col",children:"Address"}),e.jsx(a,{scope:"col",children:"Items"}),e.jsx(a,{scope:"col",children:"Customer"})]})}),e.jsx(R,{children:q.map((s,r)=>e.jsxs(u,{children:[e.jsx(o,{children:i+r+1}),e.jsx(o,{children:s.name?s.name:""}),e.jsx(o,{children:s.data}),e.jsx(o,{children:s.type}),e.jsx(o,{children:s.address}),e.jsx(o,{children:s.items===null?e.jsx(m,{icon:w,size:"xl"}):e.jsx(z,{children:e.jsx(m,{icon:w,size:"xl",onClick:()=>le(s.items)})})}),e.jsx(o,{children:s.customer===null?e.jsx(m,{icon:A,size:"xl"}):e.jsx(z,{children:e.jsx(m,{icon:A,size:"xl",onClick:()=>oe(s.customer)})})})]},r))})]}),e.jsxs(xe,{"aria-label":"Page navigation example",children:[e.jsx(S,{disabled:i<=0,onClick:se,children:"Previous"}),ae(),e.jsx(S,{disabled:W===!0,onClick:ee,children:"Next"})]}),e.jsxs(H,{visible:D,scrollable:!0,size:"xl",onClose:()=>I(!1),children:[e.jsx(V,{closeButton:!0,children:e.jsx(G,{children:"Customer Order List Information"})}),e.jsx(O,{style:{overflowY:"auto",maxHeight:"70vh",display:"flex",justifyContent:"center"},children:C?e.jsx(T,{}):e.jsxs(B,{children:[e.jsx(F,{children:e.jsxs(u,{children:[e.jsx(a,{scope:"col",children:"#"}),e.jsx(a,{scope:"col",children:"Photo"}),e.jsx(a,{scope:"col",children:"Name"}),e.jsx(a,{scope:"col",children:"Price"}),e.jsx(a,{scope:"col",children:"Saving"}),e.jsx(a,{scope:"col",children:"Qty"}),e.jsx(a,{scope:"col",children:"Measure"}),e.jsx(a,{scope:"col",children:"Market"})]})}),e.jsx(R,{children:J.map((s,r)=>{var t,x,b;return e.jsxs(u,{children:[e.jsx(o,{children:r+1}),e.jsx(a,{children:e.jsx(me,{style:{width:50,height:50,borderRadius:10},src:"https://api.zeuler.com/image/"+s.photo})}),e.jsx(o,{children:s.name}),e.jsx(o,{children:s.price}),e.jsx(o,{children:s.saving?s.saving.toFixed(2):null}),e.jsx(o,{children:s.qty}),e.jsx(o,{children:s.um}),e.jsxs(o,{children:[(x=(t=s.market)==null?void 0:t.chain)==null?void 0:x.name," - ",(b=s.market)==null?void 0:b.address]})]},r)})})]})}),e.jsx(Y,{})]}),e.jsxs(H,{visible:_,scrollable:!0,size:"lg",onClose:()=>M(!1),children:[e.jsx(V,{closeButton:!0,children:e.jsx(G,{children:"Customer Information"})}),e.jsx(O,{style:{overflowY:"auto",maxHeight:"70vh",display:"flex",justifyContent:"center"},children:C?e.jsx(T,{}):e.jsx("div",{children:e.jsxs(ue,{className:"mb-3",children:[e.jsx(v,{htmlFor:"staticEmail",className:"col-sm-2 col-form-label",children:"Name"}),e.jsx(L,{sm:10,children:e.jsx(N,{type:"text",defaultValue:f.name,readOnly:!0,plainText:!0})}),e.jsx(v,{htmlFor:"staticEmail",className:"col-sm-2 col-form-label",children:"Email"}),e.jsx(L,{sm:10,children:e.jsx(N,{type:"text",defaultValue:f.email,readOnly:!0,plainText:!0})}),e.jsx(v,{htmlFor:"staticEmail",className:"col-sm-2 col-form-label",children:"Contact"}),e.jsx(L,{sm:10,children:e.jsx(N,{type:"text",defaultValue:f.contact,readOnly:!0,plainText:!0})})]})})}),e.jsx(Y,{})]})]})};export{ke as default};
