import{r as s,x as Te,l as ze,z as c,j as e,L as de,i as Ve,m as Le}from"./index-Dru6cJd9.js";import{a as C}from"./axios-B4uVmeYG.js";/* empty css               */import{b as $e,a as p}from"./CContainer-kO2Y6oaX.js";import{C as Re}from"./CNavbar-DRD4R7UG.js";import{C as h}from"./CFormInput-B0afyM5h.js";import{C as E,a as w,b as N,c as m,e as Fe}from"./DefaultLayout-vUwkg6tp.js";import{C as He,a as _e,b as ue,c as o,d as Ue,e as n}from"./CTable-DhhKy43I.js";import{c as Ye}from"./cil-pencil-m516yCOw.js";import{C as he,a as pe,b as me,c as xe}from"./CModalTitle-DqTBV8Od.js";import{C as Ce}from"./CModalFooter-CrSS0NQ5.js";import{C as u}from"./CCol-CgJ3Fg_f.js";import{C as qe}from"./CFormSelect-Xslpmxb2.js";import"./CFormLabel-Bk9i1EOs.js";const na=()=>{const[M,j]=s.useState(!1),[{user:k,token:r},i]=Te(),[v,b]=s.useState([]),[je,I]=s.useState(!1),[P,B]=s.useState(""),[G,T]=s.useState(""),[z,V]=s.useState(""),[g,ge]=s.useState(""),[S,L]=s.useState(!1),[$,R]=s.useState("");ze();const[fe,ye]=s.useState(!1),[ke,F]=s.useState("All Cities"),[ve,H]=s.useState("All Market Groups"),[be,_]=s.useState("All Chains"),[Se,De]=s.useState([]),[Ae,Ee]=s.useState([]),[U,f]=s.useState(!1),[d,we]=s.useState([]),[Y,q]=s.useState(),[J,K]=s.useState(),[Q,W]=s.useState(),[X,Z]=s.useState(),[O,ee]=s.useState(),[D,ae]=s.useState(),[te,se]=s.useState(),[le,re]=s.useState();s.useEffect(()=>{Ne(),Me()},[]);const Ne=()=>{r&&C.get("http://15.160.211.157/market/groups/dropdown/fetch",{headers:{Authorization:`Bearer ${r}`}}).then(a=>{a.status===200?De(a.data):a.status===500&&i({type:c,payload:{status:!0,title:"Market Group Loading error",message:a.data.message}})}).catch(a=>{console.error("Error: ",a)})},Me=()=>{r&&C.get("http://15.160.211.157/assistant/market/chains/all",{headers:{Authorization:`Bearer ${r}`}}).then(a=>{a.status===200?(Ee(a.data),ye(!1)):a.status===500&&i({type:c,payload:{status:!0,title:"Chain Loading error",message:a.data.message}})}).catch(a=>{console.error("Error: ",a)})};s.useEffect(()=>{Ie()},[P,G,z,g,fe]);const Ie=()=>{if(k&&r){I(!0);let a=`http://15.160.211.157/assistant/riders/:skip?city=${P}&group=${G}&chain=${z}`;g&&(a+=`&code=${g}`),C.get(a,{headers:{Authorization:`Bearer ${r}`}}).then(t=>{t.status===200?(b(t.data),I(!1)):t.status===500&&i({type:c,payload:{status:!0,title:"Error",message:t.data.message,color:"warning"}})}).catch(t=>{console.error("Error:",t)})}},A=a=>{a==="all"?(B(""),F("All Cities")):(B(a),F(a))},oe=(a,t)=>{a==="all"?(T(""),H("All Market Groups")):(T(a),H(t))},ne=(a,t)=>{a==="all"?(V(""),_("All Chains")):(V(a),_(t))},ie=(a,t)=>{j(!M),L(t),R(a)},Pe=()=>{const a={status:S};console.log(S),console.log($,a),k&&r&&C.patch("http://15.160.211.157/assistant/rider/status/"+$,a,{headers:{Authorization:`Bearer ${r}`}}).then(t=>{if(t.status===200){console.log("updated",t.data),j(!1),L(""),R("");const l=t.data,x=v.map(y=>y.id===l.id?l:y);b([...x])}else t.status===203?i({type:c,payload:{status:!0,title:"Driver status update error",message:t.data.message}}):t.status===204?i({type:c,payload:{status:!0,title:"Driver status update error",message:t.data.message}}):t.status===500&&i({type:c,payload:{status:!0,title:"Driver status update error",message:t.data.message}})}).catch(t=>{console.error(t)})},Be=a=>{f(!U),we(a),q(a.name),K(a.surname),W(a.email),Z(a.contact),ee(a.iban),ae(a.city),re(a.address),se(a.vat)},Ge=()=>{if(Y&&J&&Q&&X&&O&&D&&te&&le){const a={name:Y,surname:J,email:Q,contact:X,iban:O,city:D,vat:te,address:le},t=d.id;r&&k&&r&&C.patch("http://15.160.211.157/assistant/rider/update/"+t,a,{headers:{Authorization:`Bearer ${r}`}}).then(l=>{if(l.status===200){f(!1);const x=l.data,y=v.map(ce=>ce.id===x.id?x:ce);b([...y])}else l.status===203?i({type:c,payload:{status:!0,title:"Picker update error",message:l.data.message,color:"warning"}}):l.status===204?(console.log(l.message),i({type:c,payload:{status:!0,title:"Picker update error",message:"Email Already include",color:"warning"}})):l.status===500&&i({type:c,payload:{status:!0,title:"Picker update error",message:l.data.message,color:"warning"}})}).catch(l=>{console.error("Error:",l)})}else i({type:c,payload:{status:!0,title:"Error!",message:"Picker update error, Please Check the input fields",color:"warning"}})};return e.jsxs($e,{children:[e.jsxs(Re,{className:"bg-body-tertiary picker-navbar",children:[e.jsx(h,{type:"text",placeholder:"Search by Driver ID",className:"picker-input",value:g,onChange:a=>ge(a.target.value)}),e.jsx(de,{to:"/picker/addpicker",className:"picker-link",children:e.jsx(p,{type:"submit",color:"success",variant:"outline",className:"picker-button",children:"Add Picker"})}),e.jsxs(E,{className:"picker-dropdown",style:{backgroundColor:"#ff4d4d"},children:[e.jsx(w,{children:ke}),e.jsxs(N,{children:[e.jsx(m,{onClick:()=>A("all"),children:"All"}),e.jsx(m,{onClick:()=>A("Milan"),children:"Milan"}),e.jsx(m,{onClick:()=>A("Napoli"),children:"Napoli"})]})]}),e.jsxs(E,{className:"picker-dropdown",style:{backgroundColor:"#ff4d4d"},children:[e.jsx(w,{children:be}),e.jsxs(N,{children:[e.jsx(m,{onClick:()=>ne("all"),children:"All"}),Ae.map((a,t)=>e.jsx(m,{onClick:()=>ne(a.id,a.name),children:a.name},t))]})]}),e.jsxs(E,{className:"picker-dropdown",style:{backgroundColor:"#ff4d4d"},children:[e.jsx(w,{children:ve}),e.jsxs(N,{children:[e.jsx(m,{onClick:()=>oe("all"),children:"All"}),Se.map((a,t)=>e.jsx(m,{onClick:()=>oe(a._id,a.name),children:a.name},t))]})]})]}),je?e.jsx(Ve,{}):e.jsxs(He,{children:[e.jsx(_e,{children:e.jsxs(ue,{children:[e.jsx(o,{scope:"col",children:"Id"}),e.jsx(o,{scope:"col",children:"First Name"}),e.jsx(o,{scope:"col",children:"Last Name"}),e.jsx(o,{scope:"col",children:"Email"}),e.jsx(o,{scope:"col",children:"Phone"}),e.jsx(o,{scope:"col",children:"Country"}),e.jsx(o,{scope:"col",children:"Employee ID"}),e.jsx(o,{scope:"col",children:"Language"}),e.jsx(o,{scope:"col",children:"Group"}),e.jsx(o,{scope:"col",children:"Edit"}),e.jsx(o,{scope:"col",children:"Status"})]})}),e.jsx(Ue,{children:v.map((a,t)=>e.jsxs(ue,{children:[e.jsx(n,{children:a.code}),e.jsx(n,{children:a.name}),e.jsx(n,{children:a.surname}),e.jsx(n,{children:a.email}),e.jsx(n,{children:a.contact}),e.jsx(n,{children:a.country==="it"||a.country==="Italy"?"Italy":a.country}),e.jsx(n,{children:a.employeeId?a.employeeId:e.jsx(Fe,{color:"warning",children:"Not Provide"})}),e.jsx(n,{children:a.language==="en"?"English":a.language==="it"?"Italy":a.language==="es"?"Spanish":a.language}),e.jsx(n,{children:a.groups.map((l,x)=>e.jsx("div",{children:l.name},x))}),e.jsx(n,{children:e.jsx(de,{children:e.jsx(Le,{icon:Ye,size:"xl",onClick:()=>Be(a)})})}),e.jsx(n,{children:a.activate?e.jsx(p,{size:"sm",onClick:()=>ie(a.id,!1),style:{backgroundColor:"#ff4d4d",width:90},children:"Deactivate"}):e.jsx(p,{size:"sm",onClick:()=>ie(a.id,!0),style:{backgroundColor:"#ff4d4d",width:90},children:"Activate"})})]},t))})]}),e.jsxs(he,{alignment:"center",visible:M,scrollable:!0,size:"sm",onClose:()=>j(!1),children:[e.jsx(pe,{closeButton:!0,children:e.jsx(me,{children:"Confirmation"})}),e.jsxs(xe,{children:[e.jsxs("a",{children:["Are you sure you want to ",S?"activate":"deactivate"," this user?"]}),e.jsx("br",{}),e.jsx(p,{onClick:()=>Pe(),style:{display:"flex",justifyContent:"center"},color:"primary",children:"Yes"})]}),e.jsx(Ce,{children:e.jsx(p,{color:"secondary",onClick:()=>j(!1),children:"Close"})})]}),e.jsxs(he,{visible:U,scrollable:!0,size:"lg",onClose:()=>f(!1),children:[e.jsx(pe,{closeButton:!0,children:e.jsx(me,{children:"Edit Driver Information"})}),e.jsx(xe,{children:e.jsxs("div",{className:"row g-3",children:[e.jsx(u,{md:6,children:e.jsx(h,{id:"name",label:"Firt Name",defaultValue:d.name,onChange:a=>q(a.target.value)})}),e.jsx(u,{md:6,children:e.jsx(h,{id:"surname",label:"LastName",defaultValue:d.surname,onChange:a=>K(a.target.value)})}),e.jsx(u,{md:6,children:e.jsx(h,{id:"address",label:"Address",defaultValue:d.address,onChange:a=>re(a.target.value)})}),e.jsx(u,{md:6,children:e.jsx(h,{id:"email",label:"Email",defaultValue:d.email,onChange:a=>W(a.target.value)})}),e.jsx(u,{md:6,children:e.jsx(h,{id:"phone",label:"Contact Number",defaultValue:d.contact,onChange:a=>Z(a.target.value)})}),e.jsx(u,{md:6,children:e.jsx(h,{id:"iban",label:"IBAN",defaultValue:d.iban,onChange:a=>ee(a.target.value)})}),e.jsx(u,{md:6,children:e.jsx(h,{id:"vat",label:"Vat",defaultValue:d.vat,onChange:a=>se(a.target.value)})}),e.jsx(u,{md:6,children:e.jsxs(qe,{id:"inputState",label:"City",value:D,onChange:a=>ae(a.target.value),children:[e.jsx("option",{children:d.city}),e.jsx("option",{children:"Milano"}),e.jsx("option",{children:"Napoli"})]})}),e.jsx(u,{xs:12,children:e.jsx(p,{color:"warning",type:"submit",style:{marginBottom:"3%",width:"200px"},onClick:()=>Ge(),children:"Update Rider"})})]})}),e.jsx(Ce,{children:e.jsx(p,{color:"secondary",onClick:()=>f(!1),children:"Close"})})]})]})};export{na as default};
