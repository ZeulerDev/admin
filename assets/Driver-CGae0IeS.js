import{r as s,y as Pe,l as Ve,A as o,j as e,L as ue,i as ze,m as Re}from"./index-NZtDbKA_.js";import{a as g}from"./axios-Cm0UX6qg.js";/* empty css               */import{B as f}from"./config-HOLfLxHr.js";import{b as $e,a as x}from"./CContainer-CR1x02kr.js";import{d as he,C as E,a as L,b as N,c as p}from"./DefaultLayout-Cbr2wWEM.js";import{C as Fe}from"./CNavbar-D11C0qJ8.js";import{C as h}from"./CFormInput-CKDZMbYy.js";import{C as He,a as _e,b as pe,c as n,d as Ue,e as d}from"./CTable-BwvoBTuh.js";import{c as Ye}from"./cil-pencil-m516yCOw.js";import{C as me,a as xe,b as ge,c as fe}from"./CModalTitle-D-YYns3Q.js";import{C as u}from"./CCol-CV-FhH_q.js";import{C as qe}from"./CFormSelect-oTdIrhRw.js";import"./CFormLabel-C36k72cX.js";const ia=()=>{const[B,C]=s.useState(!1),[{user:v,token:i},r]=Pe(),[b,k]=s.useState([]),[Ce,I]=s.useState(!1),[M,G]=s.useState(""),[T,P]=s.useState(""),[V,z]=s.useState(""),[j,je]=s.useState(""),[S,R]=s.useState(!1),[$,F]=s.useState("");Ve();const[ye,ve]=s.useState(!1),[be,H]=s.useState("All Cities"),[ke,_]=s.useState("All Market Groups"),[Se,U]=s.useState("All Chains"),[De,we]=s.useState([]),[Ae,Ee]=s.useState([]),[Y,D]=s.useState(!1),[c,Le]=s.useState([]),[q,J]=s.useState(),[K,Q]=s.useState(),[W,X]=s.useState(),[Z,O]=s.useState(),[ee,ae]=s.useState(),[w,te]=s.useState(),[se,le]=s.useState(),[re,oe]=s.useState();s.useEffect(()=>{Ne(),Be()},[]);const Ne=()=>{i&&g.get(f+"market/groups/dropdown/fetch",{headers:{Authorization:`Bearer ${i}`}}).then(a=>{a.status===200?we(a.data):a.status===500&&r({type:o,payload:{status:!0,title:"Market Group Loading error",message:a.data.message}})}).catch(a=>{console.error("Error: ",a)})},Be=()=>{i&&g.get(f+"assistant/market/chains/all",{headers:{Authorization:`Bearer ${i}`}}).then(a=>{a.status===200?(Ee(a.data),ve(!1)):a.status===500&&r({type:o,payload:{status:!0,title:"Chain Loading error",message:a.data.message}})}).catch(a=>{console.error("Error: ",a)})};s.useEffect(()=>{Ie()},[M,T,V,j,ye]);const Ie=()=>{if(v&&i){I(!0);let a=f+`assistant/riders/:skip?city=${M}&group=${T}&chain=${V}`;j&&(a+=`&code=${j}`),g.get(a,{headers:{Authorization:`Bearer ${i}`}}).then(t=>{t.status===200?(k(t.data),I(!1)):t.status===500&&r({type:o,payload:{status:!0,title:"Error",message:t.data.message,color:"warning"}})}).catch(t=>{console.error("Error:",t)})}},A=a=>{a==="all"?(G(""),H("All Cities")):(G(a),H(a))},ie=(a,t)=>{a==="all"?(P(""),_("All Market Groups")):(P(a),_(t))},ne=(a,t)=>{a==="all"?(z(""),U("All Chains")):(z(a),U(t))},de=(a,t)=>{C(!B),R(t),F(a)},Me=()=>{const a={status:S};console.log(S),console.log($,a),v&&i&&g.patch(f+"assistant/rider/status/"+$,a,{headers:{Authorization:`Bearer ${i}`}}).then(t=>{if(t.status===200){console.log("updated",t.data),C(!1),R(""),F("");const l=t.data,m=b.map(y=>y.id===l.id?l:y);k([...m]),r({type:o,payload:{status:!0,title:"Driver status update",message:"Driver status updated successfully",color:"success"}})}else t.status===203?r({type:o,payload:{status:!0,title:"Driver status update error",message:t.data.message}}):t.status===204?r({type:o,payload:{status:!0,title:"Driver status update error",message:t.data.message}}):t.status===500&&r({type:o,payload:{status:!0,title:"Driver status update error",message:t.data.message}})}).catch(t=>{console.error(t)})},Ge=a=>{D(!Y),Le(a),J(a.name),Q(a.surname),X(a.email),O(a.contact),ae(a.iban),te(a.city),oe(a.address),le(a.vat)},Te=()=>{if(q&&K&&W&&Z&&ee&&w&&se&&re){const a={name:q,surname:K,email:W,contact:Z,iban:ee,city:w,vat:se,address:re},t=c.id;i&&v&&i&&g.patch(f+"assistant/rider/update/"+t,a,{headers:{Authorization:`Bearer ${i}`}}).then(l=>{if(l.status===200){D(!1);const m=l.data,y=b.map(ce=>ce.id===m.id?m:ce);k([...y]),r({type:o,payload:{status:!0,title:"Driver update",message:"Driver updated successfully",color:"success"}})}else l.status===203?r({type:o,payload:{status:!0,title:"Driver update error",message:l.data.message,color:"warning"}}):l.status===204?(console.log(l.message),r({type:o,payload:{status:!0,title:"Driver update error",message:"Email Already include",color:"warning"}})):l.status===500&&r({type:o,payload:{status:!0,title:"Driver update error",message:l.data.message,color:"warning"}})}).catch(l=>{console.error("Error:",l)})}else r({type:o,payload:{status:!0,title:"Error!",message:"Picker update error, Please Check the input fields",color:"warning"}})};return e.jsxs($e,{children:[e.jsx(ue,{to:"/driver/adddriver",className:"picker-link",children:e.jsx(x,{style:{marginLeft:"0%",width:"17%",backgroundColor:"#ff4d4d",color:"white"},children:"Add Driver"})}),e.jsx(he,{style:{marginLeft:"20%"},color:"secondary",children:"Filter by"}),e.jsxs(E,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d",color:"white"},children:[e.jsx(L,{style:{color:"white"},children:be}),e.jsxs(N,{children:[e.jsx(p,{onClick:()=>A("all"),children:"All"}),e.jsx(p,{onClick:()=>A("Milan"),children:"Milan"}),e.jsx(p,{onClick:()=>A("Napoli"),children:"Napoli"})]})]}),e.jsxs(E,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d",color:"white"},children:[e.jsx(L,{style:{color:"white"},children:Se}),e.jsxs(N,{children:[e.jsx(p,{onClick:()=>ne("all"),children:"All"}),Ae.map((a,t)=>e.jsx(p,{onClick:()=>ne(a.id,a.name),children:a.name},t))]})]}),e.jsxs(E,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d",color:"white"},children:[e.jsx(L,{style:{color:"white"},children:ke}),e.jsxs(N,{children:[e.jsx(p,{onClick:()=>ie("all"),children:"All"}),De.map((a,t)=>e.jsx(p,{onClick:()=>ie(a._id,a.name),children:a.name},t))]})]}),e.jsx(Fe,{className:"bg-body-tertiary",children:e.jsx(h,{type:"text",placeholder:"Search by Driver ID",style:{width:450,marginLeft:"0%"},value:j,onChange:a=>je(a.target.value)})}),Ce?e.jsx(ze,{}):e.jsxs(He,{children:[e.jsx(_e,{children:e.jsxs(pe,{children:[e.jsx(n,{scope:"col",children:"Id"}),e.jsx(n,{scope:"col",children:"First Name"}),e.jsx(n,{scope:"col",children:"Last Name"}),e.jsx(n,{scope:"col",children:"Email"}),e.jsx(n,{scope:"col",children:"Phone"}),e.jsx(n,{scope:"col",children:"Country"}),e.jsx(n,{scope:"col",children:"Employee ID"}),e.jsx(n,{scope:"col",children:"Language"}),e.jsx(n,{scope:"col",children:"Group"}),e.jsx(n,{scope:"col",children:"Edit"}),e.jsx(n,{scope:"col",children:"Edit Status"})]})}),e.jsx(Ue,{children:b.map((a,t)=>e.jsxs(pe,{children:[e.jsx(d,{children:a.code}),e.jsx(d,{children:a.name}),e.jsx(d,{children:a.surname}),e.jsx(d,{children:a.email}),e.jsx(d,{children:a.contact}),e.jsx(d,{children:a.country==="it"||a.country==="Italy"?"Italy":a.country}),e.jsx(d,{children:a.employeeId?a.employeeId:e.jsx(he,{color:"warning",children:"Not Provide"})}),e.jsx(d,{children:a.language==="en"?"English":a.language==="it"?"Italy":a.language==="es"?"Spanish":a.language}),e.jsx(d,{children:a.groups.map((l,m)=>e.jsx("div",{children:l.name},m))}),e.jsx(d,{children:e.jsx(ue,{children:e.jsx(Re,{icon:Ye,size:"xl",onClick:()=>Ge(a)})})}),e.jsx(d,{children:a.activate?e.jsx(x,{size:"sm",onClick:()=>de(a.id,!1),style:{backgroundColor:"#ff4d4d",width:90,color:"white"},children:"Deactivate"}):e.jsx(x,{size:"sm",onClick:()=>de(a.id,!0),style:{backgroundColor:"#ff4d4d",width:90,color:"white"},children:"Activate"})})]},t))})]}),e.jsxs(me,{alignment:"center",visible:B,scrollable:!0,size:"sm",onClose:()=>C(!1),children:[e.jsx(xe,{closeButton:!1,children:e.jsx(ge,{children:"Confirmation"})}),e.jsxs(fe,{children:[e.jsxs("a",{children:["Are you sure you want to ",S?"activate":"deactivate"," this driver?"]}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{style:{display:"flex",justifyContent:"center"},children:[e.jsx(x,{onClick:()=>Me(),style:{backgroundColor:"#ff4d4d",color:"white",marginRight:"10px"},children:"Yes"}),e.jsx(x,{onClick:()=>C(!1),style:{backgroundColor:"#ff4d4d",color:"white",marginLeft:"10px"},children:"No"})]})]})]}),e.jsxs(me,{visible:Y,scrollable:!0,size:"lg",onClose:()=>D(!1),children:[e.jsx(xe,{closeButton:!0,children:e.jsx(ge,{children:"Edit Driver Information"})}),e.jsx(fe,{children:e.jsxs("div",{className:"row g-3",children:[e.jsx(u,{md:6,children:e.jsx(h,{id:"name",label:"Firt Name",defaultValue:c.name,onChange:a=>J(a.target.value)})}),e.jsx(u,{md:6,children:e.jsx(h,{id:"surname",label:"LastName",defaultValue:c.surname,onChange:a=>Q(a.target.value)})}),e.jsx(u,{md:6,children:e.jsx(h,{id:"address",label:"Address",defaultValue:c.address,onChange:a=>oe(a.target.value)})}),e.jsx(u,{md:6,children:e.jsx(h,{id:"email",label:"Email",defaultValue:c.email,onChange:a=>X(a.target.value)})}),e.jsx(u,{md:6,children:e.jsx(h,{id:"phone",label:"Contact Number",defaultValue:c.contact,onChange:a=>O(a.target.value)})}),e.jsx(u,{md:6,children:e.jsx(h,{id:"iban",label:"IBAN",defaultValue:c.iban,onChange:a=>ae(a.target.value)})}),e.jsx(u,{md:6,children:e.jsx(h,{id:"vat",label:"Vat",defaultValue:c.vat,onChange:a=>le(a.target.value)})}),e.jsx(u,{md:6,children:e.jsxs(qe,{id:"inputState",label:"City",value:w,onChange:a=>te(a.target.value),children:[e.jsx("option",{children:c.city}),e.jsx("option",{children:"Milano"}),e.jsx("option",{children:"Napoli"})]})}),e.jsx(u,{xs:12,children:e.jsx(x,{style:{marginBottom:"3%",width:"200px",backgroundColor:"#ff4d4d",color:"white"},onClick:()=>Te(),children:"Update Rider"})})]})})]})]})};export{ia as default};
