import{r,y as de,l as ue,A as n,j as e,i as Q,L as S,m as E}from"./index-D7hMCpfZ.js";import{a as w}from"./axios-Cm0UX6qg.js";import{B as p}from"./config-HOLfLxHr.js";import{b as he,a as j}from"./CContainer-CtIWBirN.js";import{C as me}from"./CNavbar-CF5s_Yu1.js";import{C as u}from"./CFormInput-C_rKCNW0.js";import{C as U,a as Z,b as C,c as t,d as _,e as o}from"./CTable-DPgvjQZA.js";import{C as xe}from"./CCardImage-CJaveh01.js";import{c as pe}from"./cil-pencil-m516yCOw.js";import{c as je}from"./cil-info-CmGCY32x.js";import{C as Ce,a as Y}from"./CPaginationItem-CiG5vpd2.js";import{C as q,a as J,b as K,c as W}from"./CModalTitle-CcgDWxHa.js";import{C as X}from"./CModalFooter-DyfW6scl.js";import{C as h}from"./CCol-DHGwoefR.js";import"./CFormLabel-COYWKIaa.js";import"./DefaultLayout-jgAbWox0.js";var ge=["512 512","<rect width='288' height='32' x='112' y='152' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='288' height='32' x='112' y='240' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='152' height='32' x='112' y='328' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M480,48H32V464H480ZM448,432H64V80H448Z' class='ci-primary'/>"];const He=()=>{const[N,g]=r.useState(!1),[{user:f,token:c},i]=de();ue();const[P,I]=r.useState([]),[O,ee]=r.useState([]),[k,m]=r.useState(!1),[y,B]=r.useState(0),[T,x]=r.useState(!1),[d,se]=r.useState([]),[A,z]=r.useState(),[D,H]=r.useState(),[L,V]=r.useState(),[M,R]=r.useState(),[b,ae]=r.useState(""),[te,F]=r.useState(!0);r.useEffect(()=>{f&&c&&v(0)},[f,c,b]);const v=(s,l)=>{m(!0),w.get(p+"assistant/customers/"+s+"?email="+b,{headers:{Authorization:`Bearer ${c}`}}).then(a=>{console.log(a.status),a.status===200?(I(a.data),m(!1),console.log(p),a.data.length<50?(F(!0),console.log("ok")):a.data.length>49&&F(!1)):a.status===500&&i({type:n,payload:{status:!0,title:"Customers loading error",message:a.data.message}})}).catch(a=>{console.error("Error:",a)})},re=()=>{const s=y+50;B(s),v(s)},oe=()=>{const s=y-50;console.log(s),B(s),v(s)},le=s=>{g(!N),c&&(m(!0),w.get(p+"assistant/addresses/customer/"+s,{headers:{Authorization:`Bearer ${c}`}}).then(l=>{l.status===200?(ee(l.data),m(!1)):l.status===500&&i({type:n,payload:{status:!0,title:"Customers address error",message:l.data.message}})}).catch(l=>{console.error("Customers address:",l)}))},ce=s=>{console.log(s),x(!T),se(s),z(s.name),H(s.surname),V(s.email),R(s.contact)},ie=()=>{if(A&&D&&L&&M){const s={name:A,surname:D,email:L,contact:M},l=d.id;c&&f&&c&&w.patch(p+"assistant/customers/update/"+l,s,{headers:{Authorization:`Bearer ${c}`}}).then(a=>{if(a.status===200){x(!1);const $=a.data,ne=P.map(G=>G.id===$.id?$:G);I([...ne])}else a.status===203?i({type:n,payload:{status:!0,title:"Customer update error",message:a.data.message,color:"warning"}}):a.status===204?i({type:n,payload:{status:!0,title:"Customer update error",message:a.data.message,color:"warning"}}):a.status===500&&i({type:n,payload:{status:!0,title:"Customer update error",message:a.data.message,color:"warning"}})}).catch(a=>{console.error("Error:",a)})}else i({type:n,payload:{status:!0,title:"Error!",message:"Customer update error, Please Check the input fields",color:"warning"}})};return e.jsxs(he,{children:[e.jsx(me,{className:"bg-body-tertiary",children:e.jsx(u,{type:"text",placeholder:"Search by customer email",style:{width:450,marginLeft:"2%"},value:b,onChange:s=>ae(s.target.value)})}),k?e.jsx(Q,{}):e.jsxs(U,{children:[e.jsx(Z,{children:e.jsxs(C,{children:[e.jsx(t,{scope:"col",children:"#"}),e.jsx(t,{scope:"col",children:"Name"}),e.jsx(t,{scope:"col",children:"Surname"}),e.jsx(t,{scope:"col",children:"email"}),e.jsx(t,{scope:"col",children:"Contact"}),e.jsx(t,{scope:"col",children:"Country"}),e.jsx(t,{scope:"col",children:"Language"}),e.jsx(t,{scope:"col",children:"Edit"}),e.jsx(t,{scope:"col",children:"Address"}),e.jsx(t,{scope:"col",children:"Grocery"})]})}),e.jsx(_,{children:P.map(s=>e.jsxs(C,{children:[e.jsx(t,{scope:"row",children:e.jsx(xe,{style:{width:50,height:50,borderRadius:10},src:"https://api.zeuler.com/image/"+s.photo})}),e.jsx(o,{children:s.name}),e.jsx(o,{children:s.surname}),e.jsx(o,{children:s.email}),e.jsx(o,{children:s.contact}),e.jsx(o,{children:s.country==="it"||s.country==="Italy"?"Italy":s.country}),e.jsx(o,{children:s.language==="en"?"English":s.language==="it"?"Italy":s.language}),e.jsx(o,{children:e.jsx(S,{children:e.jsx(E,{icon:pe,size:"xl",onClick:()=>ce(s)})})}),e.jsx(o,{children:e.jsx(S,{children:e.jsx(E,{icon:je,size:"xl",onClick:()=>le(s.id)})})}),e.jsx(o,{children:e.jsx(S,{to:`/customers/orders/${s.id}`,children:e.jsx(E,{icon:ge,size:"xl"})})})]},s.id))})]}),e.jsxs(Ce,{"aria-label":"Page navigation example",children:[e.jsx(Y,{disabled:y<=0,onClick:oe,children:"Previous"}),e.jsx(Y,{disabled:te===!0,onClick:re,children:"Next"})]}),e.jsxs(q,{visible:N,scrollable:!0,size:"xl",onClose:()=>g(!1),children:[e.jsx(J,{closeButton:!0,children:e.jsx(K,{children:"Order Grocery List"})}),e.jsx(W,{style:{overflowY:"auto",maxHeight:"70vh",display:"flex",justifyContent:"center"},children:k?e.jsx(Q,{}):e.jsxs(U,{children:[e.jsx(Z,{children:e.jsxs(C,{children:[e.jsx(t,{scope:"col",children:"#"}),e.jsx(t,{scope:"col",children:"Name"}),e.jsx(t,{scope:"col",children:"Intercom"}),e.jsx(t,{scope:"col",children:"Flat"}),e.jsx(t,{scope:"col",children:"Street"}),e.jsx(t,{scope:"col",children:"House Number"})]})}),e.jsx(_,{children:O.map((s,l)=>e.jsxs(C,{children:[e.jsx(t,{scope:"row"}),e.jsx(o,{children:s.name}),e.jsx(o,{children:s.intercom}),e.jsx(o,{children:s.flat}),e.jsx(o,{children:s.street}),e.jsx(o,{children:s.houseNumber})]},l))})]})}),e.jsxs(X,{children:[e.jsx(j,{color:"secondary",onClick:()=>g(!1),children:"Close"}),e.jsx(j,{color:"primary",children:"Save changes"})]})]}),e.jsxs(q,{visible:T,scrollable:!0,size:"lg",onClose:()=>x(!1),children:[e.jsx(J,{closeButton:!0,children:e.jsx(K,{children:"Edit Customer Information"})}),e.jsx(W,{children:e.jsxs("div",{className:"row g-3",children:[e.jsx(h,{md:6,children:e.jsx(u,{id:"name",label:"Firt Name",defaultValue:d.name,onChange:s=>z(s.target.value)})}),e.jsx(h,{md:6,children:e.jsx(u,{id:"surname",label:"LastName",defaultValue:d.surname,onChange:s=>H(s.target.value)})}),e.jsx(h,{md:6,children:e.jsx(u,{id:"email",label:"Email",defaultValue:d.email,onChange:s=>V(s.target.value)})}),e.jsx(h,{md:6,children:e.jsx(u,{id:"phone",label:"Contact Number",defaultValue:d.contact,onChange:s=>R(s.target.value)})}),e.jsx(h,{xs:12,children:e.jsx(j,{color:"warning",type:"submit",style:{marginBottom:"3%",width:"200px"},onClick:()=>ie(),children:"Update Customer"})})]})}),e.jsx(X,{children:e.jsx(j,{color:"secondary",onClick:()=>x(!1),children:"Close"})})]})]})};export{He as default};
