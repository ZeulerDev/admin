import{y as ps,r as a,A as i,j as e,h as we,L as Ae,m as Pe}from"./index-1nLR5RGy.js";import{a as x}from"./axios-Cm0UX6qg.js";/* empty css               */import{B as j}from"./config-HOLfLxHr.js";import{b as gs,a as p}from"./CContainer-DfgIIkA9.js";import{C as w,a as A,b as P,c as D,d as n}from"./DefaultLayout-PY4GQLlg.js";import{C as De}from"./CNavbar-Cn5Tba6R.js";import{D as xs}from"./index-BZ4A1KDT.js";import{C as k}from"./CFormInput-B-dT1a4O.js";import{C as Be,a as Ee,b as B,c as l,d as Ge,e as r}from"./CTable-BbDDKHT4.js";import{c as js}from"./cil-pencil-m516yCOw.js";import{c as fs}from"./cil-info-CmGCY32x.js";import{C as ms,a as ze}from"./CPaginationItem-p0LfWE13.js";import{C as E,a as G,b as z,c as T}from"./CModalTitle-H_mL68lj.js";import{C as V}from"./CModalFooter-BePzWYJy.js";import{C as ys}from"./CRow-BwFoSywG.js";import{C as _}from"./CFormLabel-DeTrB1R-.js";import{C as U}from"./CCol-DwaevwPk.js";import{f as Te}from"./index-PqYCJD3r.js";import"./inheritsLoose-BR9xv5Kf.js";import"./typeof-QjJsDpFa.js";const $s=()=>{var Ce,ke,be;const[{user:f,token:d},c]=ps(),[m,b]=a.useState([]),[Me,M]=a.useState(!1),[L,Le]=a.useState(""),[y,Q]=a.useState(0),[Y,v]=a.useState(!1),[ve,Ie]=a.useState(""),[W,q]=a.useState(""),[I,J]=a.useState(""),[Ne,Fe]=a.useState([]),[Re,He]=a.useState([]),[K,X]=a.useState(""),[Z,ee]=a.useState(""),[se,te]=a.useState(""),[ae,oe]=a.useState(""),[$e,le]=a.useState("All Cities"),[Oe,re]=a.useState("All Status"),[Ve,ne]=a.useState("All Market Groups"),[_e,ce]=a.useState("All Chains"),[Ue,Qe]=a.useState([]),[Ye,ie]=a.useState(!1),[N,F]=a.useState(!1),[C,We]=a.useState([]),[de,R]=a.useState(!1),[qe,Je]=a.useState(""),[ue,Ke]=a.useState(""),[Xe,Ze]=a.useState(""),[he,S]=a.useState(!1),[pe,ge]=a.useState([]),[es,xe]=a.useState(!0);a.useEffect(()=>{const s=setTimeout(()=>{c({type:i,payload:{status:!0,title:"Data Loading",message:"Data loading error: Timeout exceeded",color:"warning"}}),M(!1)},2e4);return f&&d&&H(0,s),()=>{clearTimeout(s)}},[f,d,L,Z,pe]);const H=(s,t)=>{M(!0),x.get(j+"assistant/grocery/group/"+s+"?rider="+L+"&status="+Z+"&date="+pe,{headers:{Authorization:`Bearer ${d}`}}).then(o=>{console.log("data"),o.status===200?(b(o.data),console.log("dataaaaaaa"),M(!1),clearTimeout(t),o.data.length<50?(xe(!0),console.log("ok")):o.data.length>49&&xe(!1)):o.status===204?c({type:i,payload:{status:!0,title:"Grocery groups loading error",message:o.data.message}}):o.status===500&&c({type:i,payload:{status:!0,title:"Grocery groups error",message:o.data.message}})}).catch(o=>{console.error("Error:",o)})},ss=()=>{console.log(y);const s=y+50;console.log(s),Q(s),H(s,!0)},ts=()=>{const s=y-50;console.log(s),Q(s),H(s,!1)},as=(s,t=null)=>{v(!Y),Ie(s),t!==null?q(t):console.log("Bonus number not provided")},os=()=>{const s={bonus:W};console.log(s),f&&d&&x.put(j+"assistant/grocery/group/bonus/"+ve,s,{headers:{Authorization:`Bearer ${d}`}}).then(t=>{if(t.status===200){console.log("updated"),v(!1);const o=t.data,h=m.find(u=>u.id===o._id);h&&(h.bonus=o.bonus),b([...m])}else t.status===203?(console.log("203"),c({type:i,payload:{status:!0,title:"Bonus Update error",message:t.data.message}})):t.status===204?(console.log("204"),c({type:i,payload:{status:!0,title:"Bonus Update error",message:t.data.message}})):t.status===500&&c({type:i,payload:{status:!0,title:"Bonus Update error",message:t.data.message}})}).catch(t=>{console.error(t)})};a.useEffect(()=>{ls(),rs()},[]);const ls=()=>{d&&x.get(j+"market/groups/dropdown/fetch",{headers:{Authorization:`Bearer ${d}`}}).then(s=>{s.status===200?Fe(s.data):s.status===500&&c({type:i,payload:{status:!0,title:"Market Group Loading error",message:s.data.message}})}).catch(s=>{console.error("Error: ",s)})},rs=()=>{d&&x.get(j+"assistant/market/chains/all",{headers:{Authorization:`Bearer ${d}`}}).then(s=>{s.status===200?He(s.data):s.status===500&&c({type:i,payload:{status:!0,title:"Chain Loading error",message:s.data.message}})}).catch(s=>{console.error("Error: ",s)})},$=s=>{s==="all"?(X(""),le("All Cities")):(X(s),le(s))},g=s=>{s==="all"?(ee(""),re("All Status")):(ee(s),re(s))},je=(s,t)=>{s==="all"?(te(""),ne("All Market Groups")):(te(s),ne(t))},fe=(s,t)=>{s==="all"?(oe(""),ce("All Chains")):(oe(s),ce(t))};a.useEffect(()=>{ns()},[K,se,ae,alert]);const ns=()=>{f&&d&&(ie(!0),x.get(j+`assistant/shoppers/:skip?city=${K}&group=${se}&chain=${ae}`,{headers:{Authorization:`Bearer ${d}`}}).then(s=>{s.status===200?(Qe(s.data),ie(!1)):s.status===500&&c({type:i,payload:{status:!0,title:"Error",message:s.data.message,color:"warning"}})}).catch(s=>{console.error("Error:",s)}))},cs=(s,t,o)=>{F(!N),console.log("Grocery ID",s),We(o),J(t)},me=(s,t,o)=>{R(!de),console.log("picker id",s),console.log("Grocery id",o),J(t),Ke(o),Je(s)},ye=(s,t,o)=>{console.log("bid",s,"PID",t,o);const h={pickerId:t,status:o};console.log(h),f&&d&&x.put(j+"assistant/grocery/group/picker/"+s,h,{headers:{Authorization:`Bearer ${d}`}}).then(u=>{if(u.status===200){console.log("updated",u.data),N&&F(!1),R(!1);const O=u.data,hs=m.map(Se=>Se.id===O._id?(console.log("matched"),O):Se);console.log("update obj",O),b([...hs]),c({type:i,payload:{status:!0,title:"Picker Assign ",message:"Successfully picker assigned to the grocery group",color:"success"}})}else u.status===203?(console.log("203"),c({type:i,payload:{status:!0,title:"Picker Assign error",message:u.data.message}})):u.status===204?(console.log("204"),c({type:i,payload:{status:!0,title:"Picker Assign error",message:u.data.message}})):u.status===500&&c({type:i,payload:{status:!0,title:"Picker Assign error",message:u.data.message}})}).catch(u=>{console.error(u)})},is=s=>{S(!he),Ze(s)},ds=s=>{console.log("status",s),f&&d&&x.put(j+"assistant/grocery/group/status/"+s,{},{headers:{Authorization:`Bearer ${d}`}}).then(t=>{if(t.status===200){console.log("updated",t.data),S(!1);const o=t.data,h=m.find(u=>u.id===o._id);h&&(console.log("done",h),h.status=o.status),b([...m])}else t.status===203?(console.log("203"),c({type:i,payload:{status:!0,title:"Status update error",message:t.data.message}})):t.status===204?(console.log("204"),c({type:i,payload:{status:!0,title:"Status update error",message:t.data.message}})):t.status===500&&c({type:i,payload:{status:!0,title:"Status update error",message:t.data.message}})}).catch(t=>{console.error(t)})},us=s=>{if(s){const t=Te(s[0],"MM/dd/yyyy HH:mm"),o=Te(s[1],"MM/dd/yyyy HH:mm");ge([t,o])}else ge([])};return e.jsxs(gs,{children:[e.jsx(w,{style:{marginLeft:"76%"},color:"secondary",children:"Filter by"}),e.jsxs(A,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[e.jsx(P,{style:{color:"white"},children:Oe}),e.jsxs(D,{children:[e.jsx(n,{onClick:()=>g("all"),children:"All Status"}),e.jsx(n,{onClick:()=>g("created"),children:"Created"}),e.jsx(n,{onClick:()=>g("ready"),children:"Ready"}),e.jsx(n,{onClick:()=>g("finalized"),children:"Finalized"}),e.jsx(n,{onClick:()=>g("freeze"),children:"Freeze"}),e.jsx(n,{onClick:()=>g("forced"),children:"Forced"}),e.jsx(n,{onClick:()=>g("open"),children:"Open"}),e.jsx(n,{onClick:()=>g("completed"),children:"Completed"}),e.jsx(n,{onClick:()=>g("waiting"),children:"Waiting"}),e.jsx(n,{onClick:()=>g("paid "),children:"Paid "})]})]}),e.jsxs(De,{style:{marginTop:"1%"},className:"bg-body-tertiary",children:[e.jsx(xs,{style:{marginLeft:1},format:"MM/dd/yyyy HH:mm",onChange:us}),e.jsx(k,{type:"text",placeholder:"Search By Rider No",style:{width:300,marginLeft:"5%"},value:L,onChange:s=>Le(s.target.value)})]}),Me?e.jsx(we,{}):e.jsxs(Be,{children:[e.jsx(Ee,{children:e.jsxs(B,{children:[e.jsx(l,{scope:"col",children:"#"}),e.jsx(l,{scope:"col",children:"No"}),e.jsx(l,{scope:"col",children:"Rider Assign No"}),e.jsx(l,{scope:"col",children:"Rider Status"}),e.jsx(l,{scope:"col",children:"Duration"}),e.jsx(l,{scope:"col",children:"Status"}),e.jsx(l,{scope:"col",children:"Date"}),e.jsx(l,{scope:"col",children:"Bonus"}),e.jsx(l,{scope:"col",children:"Amount"}),e.jsx(l,{scope:"col",children:"Hour"}),e.jsx(l,{scope:"col",children:"Rank"}),e.jsx(l,{scope:"col",children:"Start"}),e.jsx(l,{scope:"col",children:"End"}),e.jsx(l,{scope:"col",children:"Picker"}),e.jsx(l,{scope:"col",children:"Order"}),e.jsx(l,{scope:"col",children:"Order Details"})]})}),e.jsx(Ge,{children:m.map((s,t)=>e.jsxs(B,{children:[e.jsx(r,{children:y+t+1}),e.jsx(r,{children:s.no}),e.jsx(r,{children:s.ridersAssigningNo}),e.jsx(r,{children:e.jsx(w,{style:{width:80},color:"info",children:s.ridersAssigningStatus})}),e.jsxs(r,{children:[s.duration," min"]}),e.jsx(r,{children:e.jsx(w,{style:{width:80},color:"warning",children:s.status})}),e.jsx(r,{children:s.date}),e.jsxs(r,{children:[s.bonus!=null?s.bonus.toFixed(2):0," ",e.jsx(Ae,{to:"",children:e.jsx(Pe,{icon:js,size:"sm",onClick:()=>as(s.id,s.bonus)})})," "]}),e.jsx(r,{children:s.amount}),e.jsx(r,{children:s.hour}),e.jsx(r,{children:s.rank+1}),e.jsx(r,{children:s.start}),e.jsx(r,{children:s.end}),e.jsx(r,{children:s.shopper?e.jsx(p,{onClick:()=>cs(s.id,s.status,s),size:"sm",style:{width:80,backgroundColor:"#ff4d4d",color:"white"},children:"View"}):e.jsx(p,{onClick:()=>me(s.accepted,s.status,s.id),size:"sm",style:{width:80,backgroundColor:"#ff4d4d",color:"white"},children:"Add"})}),e.jsx(r,{children:s.status==="complete"?e.jsx(p,{size:"sm",disabled:!0,style:{width:80,backgroundColor:"#ff4d4d",color:"white"},children:"Cancel"}):s.status==="canceled"?e.jsx(p,{size:"sm",disabled:!0,style:{width:80,backgroundColor:"#ff4d4d",color:"white"},children:"Cancel"}):e.jsx(p,{onClick:()=>is(s.id),size:"sm",style:{width:80,backgroundColor:"#ff4d4d",color:"white"},children:"Cancel"})}),e.jsx(r,{children:e.jsx(Ae,{to:`/order/grocerygroup/orders/${s.id}`,children:e.jsx(Pe,{icon:fs,size:"xl"})})})]},t))})]}),e.jsxs(ms,{"aria-label":"Page navigation example",children:[e.jsx(ze,{disabled:y<=50,onClick:ts,children:"Previous"}),e.jsx(ze,{disabled:es===!0,onClick:ss,children:"Next"})]}),e.jsxs(E,{alignment:"center",visible:Y,scrollable:!0,size:"sm",onClose:()=>v(!1),children:[e.jsx(G,{closeButton:!0,children:e.jsx(z,{children:"Confirmation"})}),e.jsxs(T,{children:[e.jsx("a",{children:"Enter Bonus Amount"}),e.jsx("br",{}),e.jsx(k,{type:"text",placeholder:"Bonus",value:W,onChange:s=>q(s.target.value)})]}),e.jsx(V,{children:e.jsx(p,{style:{backgroundColor:"#ff4d4d",color:"white"},onClick:()=>os(),children:"Save changes"})})]}),e.jsxs(E,{alignment:"center",visible:N,scrollable:!0,size:"lg",onClose:()=>F(!1),children:[e.jsx(G,{closeButton:!0,children:e.jsx(z,{children:"Picker Information"})}),e.jsx(T,{style:{overflowY:"auto",maxHeight:"70vh",display:"flex",justifyContent:"center"},children:e.jsx("div",{children:e.jsxs(ys,{className:"mb-3",children:[e.jsx(_,{htmlFor:"staticEmail",className:"col-sm-2 col-form-label",children:"Name"}),e.jsx(U,{sm:10,children:e.jsx(k,{type:"text",defaultValue:(Ce=C.shopper)==null?void 0:Ce.name,readOnly:!0,plainText:!0})}),e.jsx(_,{htmlFor:"staticEmail",className:"col-sm-2 col-form-label",children:"Email"}),e.jsx(U,{sm:10,children:e.jsx(k,{type:"text",defaultValue:(ke=C.shopper)==null?void 0:ke.email,readOnly:!0,plainText:!0})}),e.jsx(_,{htmlFor:"staticEmail",className:"col-sm-2 col-form-label",children:"Contact"}),e.jsx(U,{sm:10,children:e.jsx(k,{type:"text",defaultValue:(be=C.shopper)==null?void 0:be.contact,readOnly:!0,plainText:!0})})]})})}),e.jsx(V,{children:e.jsx(p,{style:{backgroundColor:"#ff4d4d",color:"white"},onClick:()=>{var s;return me((s=C.shopper)==null?void 0:s.id,I,C.id)},children:"Change"})})]}),e.jsxs(E,{alignment:"center",visible:de,scrollable:!0,size:"xl",onClose:()=>R(!1),children:[e.jsx(G,{closeButton:!0,children:e.jsx(z,{children:"Picker Assing to the Grocery Batch"})}),e.jsxs(T,{children:[e.jsx(w,{style:{marginLeft:"37%"},color:"secondary",children:"Filter by"}),e.jsxs(A,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[e.jsx(P,{style:{color:"white"},children:$e}),e.jsxs(D,{children:[e.jsx(n,{onClick:()=>$("all"),children:"All"}),e.jsx(n,{onClick:()=>$("Milan"),children:"Milan"}),e.jsx(n,{onClick:()=>$("Napoli"),children:"Napoli"})]})]}),e.jsxs(A,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[e.jsx(P,{style:{color:"white"},children:_e}),e.jsxs(D,{children:[e.jsx(n,{onClick:()=>fe("all"),children:"All"}),Re.map((s,t)=>e.jsx(n,{onClick:()=>fe(s.id,s.name),children:s.name},t))]})]}),e.jsxs(A,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[e.jsx(P,{style:{color:"white"},children:Ve}),e.jsxs(D,{children:[e.jsx(n,{onClick:()=>je("all"),children:"All"}),Ne.map((s,t)=>e.jsx(n,{onClick:()=>je(s._id,s.name),children:s.name},t))]})]}),e.jsx(De,{style:{marginTop:"1%"},className:"bg-body-tertiary"}),Ye?e.jsx(we,{}):e.jsxs(Be,{children:[e.jsx(Ee,{children:e.jsxs(B,{children:[e.jsx(l,{scope:"col",children:"#"}),e.jsx(l,{scope:"col",children:"First Name"}),e.jsx(l,{scope:"col",children:"Last Name"}),e.jsx(l,{scope:"col",children:"Email"}),e.jsx(l,{scope:"col",children:"Phone"}),e.jsx(l,{scope:"col",children:"Country"}),e.jsx(l,{scope:"col",children:"City"}),e.jsx(l,{scope:"col",children:"Language"}),e.jsx(l,{scope:"col",children:"Market"}),e.jsx(l,{scope:"col",children:"Action"})]})}),e.jsx(Ge,{children:Ue.map((s,t)=>{var o,h;return e.jsxs(B,{children:[e.jsx(r,{children:t+1}),e.jsx(r,{children:s.name}),e.jsx(r,{children:s.surname}),e.jsx(r,{children:s.email}),e.jsx(r,{children:s.contact}),e.jsx(r,{children:s.country==="it"||s.country==="Italy"?"Italy":s.country}),e.jsx(r,{children:s.city}),e.jsx(r,{children:s.language==="en"?"English":s.language==="it"?"Italy":s.language==="es"?"Spanish":s.language}),e.jsxs(r,{children:[(h=(o=s.market)==null?void 0:o.chain)==null?void 0:h.name," - ",s.market.address]}),e.jsx(r,{children:s.id===qe?e.jsx(p,{size:"sm",onClick:()=>ye(ue,s.id,I),style:{backgroundColor:"#ff4d4d",width:90,color:"white"},children:"Assigned"}):e.jsx(p,{size:"sm",onClick:()=>ye(ue,s.id,I),style:{backgroundColor:"#ff4d4d",width:90,color:"white"},children:"Add"})})]},t)})})]})]}),e.jsx(V,{})]}),e.jsxs(E,{alignment:"center",visible:he,scrollable:!0,size:"sm",onClose:()=>S(!1),children:[e.jsx(G,{closeButton:!0,children:e.jsx(z,{children:"Confirmation"})}),e.jsxs(T,{children:[e.jsx("a",{children:"Are you sure you want to cancel this grocery group order?"}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{style:{display:"flex",justifyContent:"center"},children:[e.jsx(p,{onClick:()=>ds(Xe),style:{backgroundColor:"#ff4d4d",color:"white",marginRight:"10px"},children:"Yes"}),e.jsx(p,{onClick:()=>S(!1),style:{backgroundColor:"#ff4d4d",color:"white",marginLeft:"10px"},children:"No"})]})]})]})]})};export{$s as default};
