import{y as ce,r as a,A as l,j as e,h as ue,m as de}from"./index-BPO4cydh.js";import{a as R}from"./axios-Cm0UX6qg.js";import{B as v}from"./config-HOLfLxHr.js";import{b as ge,a as y}from"./CContainer-CzrymXOH.js";import{C as he}from"./CNavbar-BFoBctN0.js";import{C as T}from"./CFormInput-LNlkVcKE.js";import{C as me,a as ye,b as z,c as w,d as Ce,e as D}from"./CTable-C0lRWiFj.js";import{c as fe}from"./cil-pencil-m516yCOw.js";import{C as pe,a as E}from"./CPaginationItem-68gnEGM1.js";import{C as $,a as L,b as Q,c as H}from"./CModalTitle-D7OB1RAV.js";import{C as _}from"./CModalFooter-MHlU5bj7.js";import"./CFormLabel-CaOASrRa.js";import"./DefaultLayout-BjLm7xgN.js";const Be=()=>{const[{user:N,token:c},r]=ce();a.useState(!1),a.useState(!1);const[F,C]=a.useState(0),[f,xe]=a.useState(0),[V,A]=a.useState(!0);a.useState([]),a.useState("All Chains"),a.useState("All market"),a.useState(""),a.useState(""),a.useState([]);const[i,U]=a.useState(""),[q,I]=a.useState(i);a.useState([]);const[G,J]=a.useState(0),[h,p]=a.useState(1),[x,be]=a.useState(),[K,O]=a.useState([]),[W,b]=a.useState(!1),[X,d]=a.useState(!1),[Y,S]=a.useState(!1),[m,j]=a.useState(""),[P,M]=a.useState(""),[k,B]=a.useState("");a.useEffect(()=>{const t=setTimeout(()=>{r({type:l,payload:{status:!0,title:"Data Loading",message:"Data loading error: Timeout exceeded",color:"warning"}}),b(!1)},2e4);return N&&c&&g(0,t),()=>{clearTimeout(t)}},[N,c,q]),a.useEffect(()=>{const t=setTimeout(()=>{(i.length>=3||i.length===0)&&I(i)},500);return()=>{clearTimeout(t)}},[i]);const g=(t,o)=>{console.log("search",i),b(!0),R.get(v+`product/category/main/${t}?name=${i}`,{headers:{Authorization:`Bearer ${c}`}}).then(s=>{s.status===200?(O(s.data.list),J(s.data.count),console.log(s.data.list.length),b(!1),clearTimeout(o),s.data.list.length<50?(A(!0),console.log("ok")):s.data.list.length>49&&A(!1),console.log(s.data.list.length)):s.status===500&&r({type:l,payload:{status:!0,title:"Category loading error",message:s.data.message}})}).catch(s=>{console.error("Error:",s)})},Z=()=>{p(h+1);const t=f+50;C(t),g(t,x)},ee=()=>{p(h-1);const t=f-50;console.log(t),C(t),g(t,x)},te=t=>{p(t);const o=(t-1)*50;C(o),g(o,x)},ae=()=>{const t=Math.ceil(G/50),o=[];for(let n=1;n<=t;n++)o.push(n);const s=Math.max(h-2,1),u=Math.min(s+4,t);return o.slice(s-1,u).map(n=>e.jsx(E,{active:h===n,onClick:()=>te(n),children:n},n))},se=()=>{d(!0)},oe=t=>{S(!0),B(t)},re=()=>{m?(console.log(m),ie(m),d(!1)):r({type:l,payload:{status:!0,title:"Check the fields",message:"Please check the fields",color:"warning"}})},le=()=>{k?(console.log(P,k),ne(P,k),d(!1)):r({type:l,payload:{status:!0,title:"Check the fields",message:"Please check the fields",color:"warning"}})},ie=t=>{if(t){const o={name:t};c&&R.post(v+"product/category/main/add",o,{headers:{Authorization:`Bearer ${c}`}}).then(s=>{s.status===200?(r({type:l,payload:{status:!0,title:"Category Registration",message:"Category Registration Success",color:"success"}}),d(!1),j(""),g(0)):s.status===400?r({type:l,payload:{status:!0,title:"Category Registration error",message:"Category Registration error",color:"warning"}}):s.status===500&&r({type:l,payload:{status:!0,title:"Picker Registration error",message:"Picker Registration error 500",color:"warning"}})}).catch(s=>{console.error("Error:",s)})}else r({type:l,payload:{status:!0,title:"Error!",message:"Picker Registration error, Please Check the input fields",color:"warning"}})},ne=(t,o)=>{if(t){const s={name:t,categoryId:o};c&&R.post(v+"product/category/sub/add",s,{headers:{Authorization:`Bearer ${c}`}}).then(u=>{u.status===200?(r({type:l,payload:{status:!0,title:"SubCategory Registration",message:"SubCategory Registration Success",color:"success"}}),S(!1),B(""),M("")):u.status===400?r({type:l,payload:{status:!0,title:"SubCategory Registration error",message:"SubCategory Registration error",color:"warning"}}):u.status===500&&r({type:l,payload:{status:!0,title:"SubCategory Registration error",message:"SubCategory Registration error 500",color:"warning"}})}).catch(u=>{console.error("Error:",u)})}else r({type:l,payload:{status:!0,title:"Error!",message:"Category Registration error, Please Check the input fields",color:"warning"}})};return e.jsxs(ge,{children:[e.jsx(y,{onClick:()=>{se()},style:{backgroundColor:"#ff4d4d",width:"17%",color:"white"},children:"Add Main Category"}),e.jsx(he,{style:{marginTop:"1%"},className:"bg-body-tertiary",children:e.jsx(T,{type:"text",placeholder:"Search here",style:{width:450,marginRight:"30%"},value:i,onChange:t=>U(t.target.value)})}),W?e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(ue,{style:{marginTop:"15%"}})}):e.jsxs(me,{children:[e.jsx(ye,{children:e.jsxs(z,{children:[e.jsx(w,{scope:"col",children:"#"}),e.jsx(w,{scope:"col",children:"Name"}),e.jsx(w,{scope:"col",children:"Add Subcategory"})]})}),e.jsx(Ce,{children:K.map((t,o)=>e.jsxs(z,{children:[e.jsx(D,{children:F+o+1}),e.jsx(D,{children:t.name}),e.jsx(D,{children:e.jsx(y,{size:"sm",style:{backgroundColor:"#ff4d4d"},variant:"outline",onClick:()=>{oe(t._id)},children:e.jsx(de,{icon:fe,size:"lg",style:{color:"white"}})})})]},o))})]}),e.jsxs(pe,{"aria-label":"Page navigation example",children:[e.jsx(E,{disabled:f<=0,onClick:ee,children:"Previous"}),ae(),e.jsx(E,{disabled:V===!0,onClick:Z,children:"Next"})]}),e.jsxs($,{alignment:"center",visible:X,scrollable:!0,size:"sm",onClose:()=>{d(!1),j("")},children:[e.jsx(L,{closeButton:!0,children:e.jsx(Q,{children:"Category Registration"})}),e.jsx(H,{children:e.jsx(T,{type:"text",placeholder:"Enter Category Name",value:m,onChange:t=>j(t.target.value)})}),e.jsx(_,{children:e.jsx(y,{style:{backgroundColor:"#ff4d4d",color:"white"},onClick:()=>{re()},children:"Save"})})]}),e.jsxs($,{alignment:"center",visible:Y,scrollable:!0,size:"sm",onClose:()=>{S(!1),M("")},children:[e.jsx(L,{closeButton:!0,children:e.jsx(Q,{children:"Subcategory Registration"})}),e.jsx(H,{children:e.jsx(T,{type:"text",placeholder:"Enter Subcategory Name",value:P,onChange:t=>M(t.target.value)})}),e.jsx(_,{children:e.jsx(y,{style:{backgroundColor:"#ff4d4d",color:"white"},onClick:()=>{le()},children:"Save"})})]})]})};export{Be as default};
