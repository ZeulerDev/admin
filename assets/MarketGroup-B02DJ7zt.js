import{y as re,r as o,A as l,j as e,L as h,h as le,m as z}from"./index-DCIC8fO6.js";import{a as k}from"./axios-Cm0UX6qg.js";import{B as b}from"./config-HOLfLxHr.js";import{b as ie,a as i}from"./CContainer-Dhr2RTMc.js";import{C as ne,a as ce,b as de,c as ue,d as w}from"./DefaultLayout-C0sUmu94.js";import{C as me}from"./CNavbar-R1oxGH4k.js";import{C as pe,a as ge,b as I,c,d as he,e as d}from"./CTable-Bvq_3Do7.js";import{c as fe}from"./cil-pencil-m516yCOw.js";import{c as xe}from"./cil-trash-CBbKHhHb.js";import{C as Ce,a as R}from"./CPaginationItem-Dt9jjho8.js";import{C as $,a as _,b as F,c as H}from"./CModalTitle-CmK17VBN.js";import{C as je}from"./CFormInput-S43P1cjW.js";import{C as ye}from"./CModalFooter-DFO6hTF8.js";import"./CFormLabel-BFz3Pslt.js";const Be=()=>{const[{user:f,token:n},r]=re(),[M,D]=o.useState(""),[U,S]=o.useState("All Cities"),[x,T]=o.useState([]),[u,N]=o.useState(0),[V,P]=o.useState(!0),[Y,C]=o.useState(!1),[G,m]=o.useState(!1),[q,J]=o.useState(""),[K,j]=o.useState(!1),[O,v]=o.useState(""),[p,A]=o.useState(""),[Q,L]=o.useState(""),y=t=>{t==="all"?(D(""),S("All Cities")):(D(t),S(t))};o.useEffect(()=>{const t=setTimeout(()=>{r({type:l,payload:{status:!0,title:"Data Loading",message:"Data loading error: Timeout exceeded",color:"warning"}}),C(!1)},2e4);return f&&n&&g(0,t),()=>{clearTimeout(t)}},[f,M]);const g=(t,a)=>{C(!0),k.get(b+`market/groups/fetch/${t}?city=${M}`,{headers:{Authorization:`Bearer ${n}`}}).then(s=>{console.log(s.status),s.status===200?(T(s.data),C(!1),clearTimeout(a),s.data.length<20?(P(!0),console.log("ok")):s.data.length>19&&P(!1)):s.status===500&&r({type:l,payload:{status:!0,title:"Makrket Group loading error",message:s.data.message}})}).catch(s=>{console.error("Error:",s)})},W=()=>{const t=u+20;N(t),g(t,!0)},X=()=>{const t=u-20;console.log(t),N(t),g(t,!1)},Z=t=>{m(!G),J(t)},ee=t=>{console.log(t),k.delete(b+"marketgroup/"+t,{headers:{Authorization:`Bearer ${n}`}}).then(a=>{a.status===200?(r({type:l,payload:{status:!0,title:"Market Group Delete",message:"Market Group Delete Success",color:"success"}}),m(!1),g(0,!0),console.log("Remove Market Group")):a.status===203?r({type:l,payload:{status:!0,title:"Market Group Delete",message:a.data.message,color:"warning"}}):a.status===404?r({type:l,payload:{status:!0,title:"Market Group Delete",message:a.data.message,color:"warning"}}):a.status===500&&r({type:l,payload:{status:!0,title:"Market Group Delete",message:a.data.message,color:"warning"}})}).catch(a=>{console.error("Error:",a)})},te=(t,a)=>{j(!0),v(t),L(a),console.log(a)},ae=()=>{console.log("name",p),p==""?r({type:l,payload:{status:!0,title:"Alert",message:"Please Enter Name",color:"danger"}}):se(O)},se=t=>{if(t){let a={name:p};console.log(a,t),f&&n&&k.put(b+"marketgroup/update/"+t,a,{headers:{Authorization:`Bearer ${n}`}}).then(s=>{if(s.status===200){const E=s.data,B=x.find(oe=>oe.id===E.id);B&&(B.name=E.name),T([...x]),r({type:l,payload:{status:!0,title:"Market Group Update",message:"Market group name updated successfully",color:"success"}}),v(""),A(""),j(!1),L("")}else s.status===204?r({type:l,payload:{status:!0,title:"Pick up area update  error",message:s.data.message,color:"danger"}}):s.status===500&&r({type:l,payload:{status:!0,title:"Pick up area update  error",message:s.data.message,color:"danger"}})}).catch(s=>{console.error("Error:",s)})}else alert("Please Check the Fields!")};return e.jsxs(ie,{children:[e.jsx(h,{to:"/marketgroups/marketmap",children:e.jsx(i,{style:{marginLeft:"0%",width:"17%",backgroundColor:"#ff4d4d",color:"white"},children:"Add Market"})}),e.jsx(h,{to:"/marketgroups/createmarketgroup",children:e.jsx(i,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d",color:"white"},children:"Create Market Group"})}),e.jsx(ne,{style:{marginLeft:"39%"},color:"secondary",children:"Filter by"}),e.jsxs(ce,{style:{marginLeft:"2%",width:"17%",marginRight:"5px",backgroundColor:"#ff4d4d"},children:[e.jsx(de,{style:{color:"white"},children:U}),e.jsxs(ue,{children:[e.jsx(w,{onClick:()=>y("all"),children:"All"}),e.jsx(w,{onClick:()=>y("Milano"),children:"Milano"}),e.jsx(w,{onClick:()=>y("Napoli"),children:"Napoli"})]})]}),e.jsx(me,{style:{marginTop:"1%"},className:"bg-body-tertiary"}),Y?e.jsx(le,{}):e.jsxs(pe,{children:[e.jsx(ge,{children:e.jsxs(I,{children:[e.jsx(c,{scope:"col",children:"#"}),e.jsx(c,{scope:"col",children:"Name"}),e.jsx(c,{scope:"col",children:"City"}),e.jsx(c,{scope:"col",children:"Location"}),e.jsx(c,{scope:"col",children:"Action"})]})}),e.jsx(he,{children:x.map((t,a)=>e.jsxs(I,{children:[e.jsx(d,{children:u+a+1}),e.jsxs(d,{children:[e.jsx("span",{children:t.name}),e.jsx(h,{to:"",children:e.jsx(z,{style:{marginLeft:20,float:"right"},icon:fe,size:"sm",onClick:()=>te(t._id,t.name)})})]}),e.jsx(d,{children:t.city}),e.jsx(d,{children:e.jsx(h,{to:`/marketgroups/marketdistance/${t._id}`,children:e.jsx(i,{size:"sm",style:{backgroundColor:"#ff4d4d",marginLeft:"5px",color:"white"},children:"view"})})}),e.jsx(d,{children:e.jsx(i,{size:"sm",style:{backgroundColor:"#ff4d4d"},variant:"outline",onClick:()=>Z(t._id),children:e.jsx(z,{icon:xe,size:"lg",style:{color:"white"}})})})]},a))})]}),e.jsxs(Ce,{"aria-label":"Page navigation example",children:[e.jsx(R,{disabled:u<=0,onClick:X,children:"Previous"}),e.jsx(R,{disabled:V===!0,onClick:W,children:"Next"})]}),e.jsxs($,{alignment:"center",visible:K,scrollable:!0,size:"sm",onClose:()=>j(!1),children:[e.jsx(_,{closeButton:!0,children:e.jsx(F,{children:"Change Name"})}),e.jsxs(H,{children:[e.jsx("a",{children:"Enter New Name"}),e.jsx("br",{}),e.jsx(je,{type:"text",placeholder:Q,value:p,onChange:t=>A(t.target.value)})]}),e.jsx(ye,{children:e.jsx(i,{style:{backgroundColor:"#ff4d4d",color:"white"},onClick:()=>ae(),children:"Save changes"})})]}),e.jsxs($,{alignment:"center",visible:G,scrollable:!0,size:"sm",onClose:()=>m(!1),children:[e.jsx(_,{closeButton:!1,children:e.jsx(F,{children:"Confirmation"})}),e.jsxs(H,{children:[e.jsx("a",{children:"Are you sure you want to delete this market group?"}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{style:{display:"flex",justifyContent:"center"},children:[e.jsx(i,{onClick:()=>ee(q),style:{backgroundColor:"#ff4d4d",color:"white",marginRight:"10px"},children:"Yes"}),e.jsx(i,{onClick:()=>m(!1),style:{backgroundColor:"#ff4d4d",color:"white",marginLeft:"10px"},children:"No"})]})]})]})]})};export{Be as default};
