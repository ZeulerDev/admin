import{r,x as z,z as c,j as e,h as M}from"./index-eVF03vmO.js";import{a as T}from"./axios-B4uVmeYG.js";import{B as A}from"./config-HOLfLxHr.js";import{b as D,a as f}from"./CContainer-C1oeA7kP.js";import{C as N}from"./CNavbar-BdfoZl9G.js";import{C as V}from"./CFormInput-C8oOCsJg.js";import{C as L,a as R,b as E,c as t,d as H,e as o}from"./CTable-vBbhEe3m.js";import{d as i}from"./DefaultLayout-C3vwYFSh.js";import{C as F,a as Q,b as U,c as Y}from"./CModalTitle-aa6PqSjO.js";import{C as _}from"./CModalFooter-CnphZc4h.js";import"./CFormLabel-DRQeNtLX.js";const ae=()=>{const[g,p]=r.useState(!1),[{user:m,token:h},l]=z(),[x,C]=r.useState([]),[w,y]=r.useState(!1),[I,S]=r.useState(""),[b,v]=r.useState(""),[j,B]=r.useState("");r.useEffect(()=>{m&&h&&(y(!0),T.get(A+"assistant/vat/shoppers/0?search="+j,{headers:{Authorization:`Bearer ${h}`}}).then(s=>{s.status===200?(C(s.data),y(!1),console.log("done")):s.status===204?l({type:c,payload:{status:!0,title:"Error",message:s.data.message,color:"warning"}}):s.status===500&&l({type:c,payload:{status:!0,title:"Error",message:s.data.message,color:"warning"}})}).catch(s=>{console.error("Error:",s)}))},[j]);const k=(s,a=null)=>{p(!g),S(s),a!==null?v(a):console.log("VAT PID not provided"),console.log(s)},P=()=>{const s={vat:b};m&&h&&T.patch(A+"assistant/shopper/vat/"+I,s,{headers:{Authorization:`Bearer ${h}`}}).then(a=>{if(a.status===200){console.log("updated"),p(!1);const n=a.data,d=x.find(u=>u.id===n.id);d&&(d.vat=n.vat),C([...x]),l({type:c,payload:{status:!0,title:"Picker VAT Id ",message:"VAT Id updated successfully"}})}else a.status===203?(console.log("203"),l({type:c,payload:{status:!0,title:"Picker VAT Id update error",message:a.data.message}})):a.status===204?(console.log("204"),l({type:c,payload:{status:!0,title:"Picker VAT Id update error",message:a.data.message}})):a.status===500&&l({type:c,payload:{status:!0,title:"Picker VAT Id update error",message:a.data.message}})}).catch(a=>{console.error(a)})};return e.jsxs(D,{children:[e.jsx(N,{className:"bg-body-tertiary",children:e.jsx(V,{type:"text",placeholder:"Search",style:{width:450,marginLeft:"0%"},value:j,onChange:s=>B(s.target.value)})}),w?e.jsx(M,{}):e.jsxs(L,{children:[e.jsx(R,{children:e.jsxs(E,{children:[e.jsx(t,{scope:"col",children:"#"}),e.jsx(t,{scope:"col",children:"Name"}),e.jsx(t,{scope:"col",children:"City"}),e.jsx(t,{scope:"col",children:"Vat"}),e.jsx(t,{scope:"col",children:"Activate"}),e.jsx(t,{scope:"col",children:"Disabled"}),e.jsx(t,{scope:"col",children:"market"}),e.jsx(t,{scope:"col",children:"Action"})]})}),e.jsx(H,{children:x.map((s,a)=>{var n,d,u;return e.jsxs(E,{children:[e.jsx(o,{children:a+1}),e.jsx(o,{children:s.name}),e.jsx(o,{children:s.city}),e.jsx(o,{children:s.vat?s.vat:e.jsx(i,{color:"warning",children:"Empty"})}),e.jsx(o,{children:s.activate?e.jsx(i,{color:"success",children:"Yes"}):e.jsx(i,{color:"warning",children:"No"})}),e.jsx(o,{children:s.disabled?e.jsx(i,{color:"success",children:"No"}):e.jsx(i,{color:"warning",children:"Yes"})}),e.jsxs(o,{children:[(d=(n=s.market)==null?void 0:n.chain)==null?void 0:d.name," - ",(u=s.market)==null?void 0:u.address]}),e.jsx(o,{children:s.vat===""?e.jsx(f,{size:"sm",style:{backgroundColor:"#ff4d4d",width:70,color:"white"},onClick:()=>k(s.id,s.vat),children:"Insert "}):e.jsx(f,{size:"sm",style:{backgroundColor:"#ff4d4d",width:70,color:"white"},onClick:()=>k(s.id,s.vat),children:"Edit "})})]},a)})})]}),e.jsxs(F,{alignment:"center",visible:g,scrollable:!0,size:"sm",onClose:()=>p(!1),children:[e.jsx(Q,{closeButton:!0,children:e.jsx(U,{children:"Confirmation"})}),e.jsxs(Y,{children:[e.jsx("a",{children:"Enter Picker's VAT id here"}),e.jsx("br",{}),e.jsx(V,{type:"text",placeholder:"Vat id",value:b,onChange:s=>v(s.target.value)})]}),e.jsx(_,{children:e.jsx(f,{style:{backgroundColor:"#ff4d4d",color:"white"},onClick:()=>P(),children:"Save changes"})})]})]})};export{ae as default};
