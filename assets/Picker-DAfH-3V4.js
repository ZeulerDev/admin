import{r as a,x as Ze,z as o,j as e,L as be,h as Oe,m as Pe}from"./index-DN-qvEvp.js";import{a as f}from"./axios-B4uVmeYG.js";/* empty css               */import{B as x}from"./config-HOLfLxHr.js";import{b as es,a as h}from"./CContainer-CE2leGJY.js";import{C as ss,a as I,b as V,d as G,e as y}from"./DefaultLayout-DIk-F9gb.js";import{C as ts}from"./CNavbar-BwzS-p4g.js";import{C as p}from"./CFormInput-C5VMyRoB.js";import{C as as,a as rs,b as $,c,d as ls,e as n}from"./CTable-ga_G5UAI.js";import{c as os}from"./cil-pencil-m516yCOw.js";import{c as is}from"./cil-trash-CBbKHhHb.js";import{C as S,a as v,b as A,c as E}from"./CModalTitle-BCVX7zp0.js";import{C as d}from"./CCol-zmKUvkDb.js";import{C as ns}from"./CModalFooter-YX-dALfA.js";import{C as cs}from"./CFormSelect-Bn3xJ5k-.js";import"./CFormLabel-Cf3WryxB.js";const vs=()=>{const[R,k]=a.useState(!1),[F,w]=a.useState(!1),[{user:b,token:i},l]=Ze(),[D,U]=a.useState([]),[Se,T]=a.useState(!1),[H,_]=a.useState(""),[Q,Y]=a.useState(""),[q,J]=a.useState(""),[m,g]=a.useState(""),[ve,K]=a.useState(m),[W,X]=a.useState(!1),[Z,O]=a.useState(""),[Ae,ee]=a.useState(!1),[Ee,se]=a.useState("All Cities"),[De,te]=a.useState("All Market Groups"),[Te,ae]=a.useState("All Chains"),[Be,Le]=a.useState([]),[Me,Ne]=a.useState([]),[re,j]=a.useState(!1),[u,ze]=a.useState([]),[le,oe]=a.useState(),[ie,ne]=a.useState(),[ce,de]=a.useState(),[ue,he]=a.useState(),[pe,me]=a.useState(),[B,ge]=a.useState(),[Ie,fe]=a.useState(),[xe,ye]=a.useState(),[Ve,Ge]=a.useState(),[P,$e]=a.useState(""),[L,Re]=a.useState(""),[Fe,M]=a.useState(!1);a.useEffect(()=>{Ue(),He()},[]);const Ue=()=>{i&&f.get(x+"market/groups/dropdown/fetch",{headers:{Authorization:`Bearer ${i}`}}).then(s=>{s.status===200?Le(s.data):s.status===500&&l({type:o,payload:{status:!0,title:"Market Group Loading error",message:s.data.message}})}).catch(s=>{console.error("Error: ",s)})},He=()=>{i&&f.get(x+"assistant/market/chains/all",{headers:{Authorization:`Bearer ${i}`}}).then(s=>{s.status===200?Ne(s.data):s.status===500&&l({type:o,payload:{status:!0,title:"Chain Loading error",message:s.data.message}})}).catch(s=>{console.error("Error: ",s)})};a.useEffect(()=>{const s=setTimeout(()=>{l({type:o,payload:{status:!0,title:"Data Loading",message:"Data loading error: Timeout exceeded",color:"warning"}}),T(!1)},2e4);return N(s),()=>{clearTimeout(s)}},[H,Q,q,ve,Ae]),a.useEffect(()=>{const s=setTimeout(()=>{(m.length>=3||m.length===0)&&K(m)},500);return()=>{clearTimeout(s)}},[m]);const N=s=>{if(b&&i){T(!0);let t=x+`assistant/shoppers/0?city=${H}&group=${Q}&chain=${q}&code=${m}`;f.get(t,{headers:{Authorization:`Bearer ${i}`}}).then(r=>{r.status===200?(U(r.data),T(!1),ee(!1),clearTimeout(s)):r.status===500&&l({type:o,payload:{status:!0,title:"Error",message:r.data.message,color:"warning"}})}).catch(r=>{console.error("Error:",r)})}},z=s=>{s==="all"?(_(""),se("All Cities"),g("")):(_(s),se(s),g(""))},je=(s,t)=>{s==="all"?(Y(""),te("All Market Groups"),g("")):(Y(s),te(t),g(""))},Ce=(s,t)=>{s==="all"?(J(""),ae("All Chains"),g("")):(J(s),ae(t),g(""))},ke=(s,t)=>{k(!R),X(t),O(s)},_e=()=>{j(!1),M(!0)},Qe=()=>{const s={status:W};console.log(Z,s),b&&i&&f.patch(x+"assistant/shopper/status/"+Z,s,{headers:{Authorization:`Bearer ${i}`}}).then(t=>{t.status===200?(console.log("updated"),k(!1),X(""),O(""),ee(!0),l({type:o,payload:{status:!0,title:"Picker status update",message:"Picker status updated successfully",color:"success"}})):t.status===203?l({type:o,payload:{status:!0,title:"Picker status update error",message:t.data.message}}):t.status===204?l({type:o,payload:{status:!0,title:"Picker status update error",message:t.data.message}}):t.status===500&&l({type:o,payload:{status:!0,title:"Picker status update error",message:t.data.message}})}).catch(t=>{console.error(t)})},Ye=s=>{console.log(s),j(!re),ze(s),oe(s.name),ne(s.surname),de(s.email),he(s.contact),me(s.iban),ge(s.city),ye(s.address),fe(s.vat)},qe=()=>{if(le&&ie&&ce&&ue&&pe&&B&&xe){const s={name:le,surname:ie,email:ce,contact:ue,iban:pe,city:B,vat:Ie,address:xe},t=u.id;i&&b&&i&&f.patch(x+"assistant/shopper/update/"+t,s,{headers:{Authorization:`Bearer ${i}`}}).then(r=>{if(r.status===200){console.log(r.data),j(!1);const C=r.data,Xe=D.map(we=>we.id===C.id?(console.log("update obj"),C):we);U([...Xe]),N(),l({type:o,payload:{status:!0,title:"Picker update",message:"Picker updated successfully",color:"success"}})}else r.status===203?l({type:o,payload:{status:!0,title:"Picker update error",message:"Email already exists",color:"warning"}}):r.status===204?l({type:o,payload:{status:!0,title:"Picker update error",message:r.data.message,color:"warning"}}):r.status===404?l({type:o,payload:{status:!0,title:"Picker update error",message:"Missing required fields",color:"warning"}}):r.status===500&&l({type:o,payload:{status:!0,title:"Picker update error",message:r.data.message,color:"warning"}})}).catch(r=>{console.error("Error:",r)})}else l({type:o,payload:{status:!0,title:"Error!",message:"Picker update error, Please Check the input fields",color:"warning"}})},Je=s=>{w(!F),Ge(s)},Ke=s=>{f.delete(x+"assistant/shopper/delete/"+s,{headers:{Authorization:`Bearer ${i}`}}).then(t=>{t.status===200?(l({type:o,payload:{status:!0,title:"Picker Delete",message:"Picker deleted successfully",color:"success"}}),w(!1),N()):t.status===404?l({type:o,payload:{status:!0,title:"Picker remove error",message:t.data.message}}):t.status===500&&l({type:o,payload:{status:!0,title:"Picker remove error",message:t.data.message}})}).catch(t=>{console.error("Error:",t)})},We=s=>{if(P===""||L==="")l({type:o,payload:{status:!0,title:"Password update error",message:"Check the input fields",color:"warning"}});else if(P===L){const t={passcode:P};console.log(t,s),b&&i&&f.patch(x+"assistant/shopper/update/"+s,t,{headers:{Authorization:`Bearer ${i}`}}).then(r=>{r.status===200?(M(!1),l({type:o,payload:{status:!0,title:"Password update",message:"Password updated successfully",color:"success"}}),j(!0)):r.status===204?l({type:o,payload:{status:!0,title:"Password update error",message:r.data.message}}):r.status===404?l({type:o,payload:{status:!0,title:"Password update error",message:r.data.message}}):r.status===500&&l({type:o,payload:{status:!0,title:"Password update error",message:r.data.message}})}).catch(r=>{console.error(r)})}else l(P!==L?{type:o,payload:{status:!0,title:"Password update error",message:"Password does not match",color:"warning"}}:{type:o,payload:{status:!0,title:"Password update error",message:"Password update error or check the input fields",color:"warning"}})};return e.jsxs(es,{children:[e.jsx(be,{to:"/picker/addpicker",className:"picker-link",children:e.jsx(h,{style:{marginLeft:"0%",width:"17%",backgroundColor:"#ff4d4d",color:"white"},children:"Add Picker"})}),e.jsx(ss,{style:{marginLeft:"20%"},color:"secondary",children:"Filter by"}),e.jsxs(I,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d",color:"white"},children:[e.jsx(V,{style:{color:"white"},children:Ee}),e.jsxs(G,{children:[e.jsx(y,{onClick:()=>z("all"),children:"All"}),e.jsx(y,{onClick:()=>z("Milan"),children:"Milan"}),e.jsx(y,{onClick:()=>z("Napoli"),children:"Napoli"})]})]}),e.jsxs(I,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d",color:"white"},children:[e.jsx(V,{style:{color:"white"},children:Te}),e.jsxs(G,{children:[e.jsx(y,{onClick:()=>Ce("all"),children:"All"}),Me.map((s,t)=>e.jsx(y,{onClick:()=>Ce(s.id,s.name),children:s.name},t))]})]}),e.jsxs(I,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d",color:"white"},children:[e.jsx(V,{style:{color:"white"},children:De}),e.jsxs(G,{children:[e.jsx(y,{onClick:()=>je("all"),children:"All"}),Be.map((s,t)=>e.jsx(y,{onClick:()=>je(s._id,s.name),children:s.name},t))]})]}),e.jsx(ts,{style:{marginTop:"1%"},className:"bg-body-tertiary",children:e.jsx(p,{type:"text",placeholder:"Search by Picker by picker Id, name, surname, email and contact",className:"picker-input",value:m,style:{width:480,marginLeft:"0%"},onChange:s=>g(s.target.value)})}),Se?e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(Oe,{style:{marginTop:"15%"}})}):e.jsxs(as,{children:[e.jsx(rs,{children:e.jsxs($,{children:[e.jsx(c,{scope:"col",children:"#"}),e.jsx(c,{scope:"col",children:"Id"}),e.jsx(c,{scope:"col",children:"First Name"}),e.jsx(c,{scope:"col",children:"Last Name"}),e.jsx(c,{scope:"col",children:"Email"}),e.jsx(c,{scope:"col",children:"Phone"}),e.jsx(c,{scope:"col",children:"Country"}),e.jsx(c,{scope:"col",children:"City"}),e.jsx(c,{scope:"col",children:"Language"}),e.jsx(c,{scope:"col",children:"Market"}),e.jsx(c,{scope:"col",children:"Edit"}),e.jsx(c,{scope:"col",children:"Edit Status"}),e.jsx(c,{scope:"col",children:"Action"})]})}),e.jsx(ls,{children:D.length===0?e.jsx($,{children:e.jsx(n,{colSpan:"13",style:{textAlign:"center",backgroundColor:"white"},children:e.jsx("h6",{style:{marginTop:"1%"},children:"No Data"})})}):D.map((s,t)=>{var r,C;return e.jsxs($,{children:[e.jsx(n,{children:t+1}),e.jsx(n,{children:s.code}),e.jsx(n,{children:s.name}),e.jsx(n,{children:s.surname}),e.jsx(n,{children:s.email}),e.jsx(n,{children:s.contact}),e.jsx(n,{children:s.country==="it"||s.country==="Italy"?"Italy":s.country}),e.jsx(n,{children:s.city}),e.jsx(n,{children:s.language==="en"?"English":s.language==="it"?"Italy":s.language==="es"?"Spanish":s.language}),e.jsxs(n,{children:[(C=(r=s.market)==null?void 0:r.chain)==null?void 0:C.name," - ",s.market.address]}),e.jsx(n,{children:e.jsx(be,{children:e.jsx(Pe,{icon:os,size:"xl",onClick:()=>Ye(s)})})}),e.jsx(n,{children:s.activate?e.jsx(h,{size:"sm",onClick:()=>ke(s.id,!1),style:{backgroundColor:"#ff4d4d",width:90,color:"white"},children:"Deactivate"}):e.jsx(h,{size:"sm",onClick:()=>ke(s.id,!0),style:{backgroundColor:"#ff4d4d",width:90,color:"white"},children:"Activate"})}),e.jsx(n,{children:e.jsx(h,{size:"sm",style:{backgroundColor:"#ff4d4d"},variant:"outline",onClick:()=>Je(s.id),children:e.jsx(Pe,{icon:is,size:"lg",style:{color:"white"}})})})]},t)})})]}),e.jsxs(S,{alignment:"center",visible:Fe,scrollable:!0,size:"sm",onClose:()=>M(!1),children:[e.jsx(v,{closeButton:!0,children:e.jsx(A,{children:"Update Password"})}),e.jsxs(E,{children:[e.jsx(d,{md:12,children:e.jsx(p,{id:"password",label:"Enter New Password",type:"password",onChange:s=>$e(s.target.value)})}),e.jsx("br",{}),e.jsx(d,{md:12,children:e.jsx(p,{id:"repassword",label:"Re Enter Password",type:"password",onChange:s=>Re(s.target.value)})})]}),e.jsx(ns,{children:e.jsx(h,{type:"submit",style:{marginBottom:"3%",backgroundColor:"#ff4d4d",color:"white"},onClick:()=>{We(u.id)},children:"Update"})})]}),e.jsxs(S,{alignment:"center",visible:F,scrollable:!0,size:"sm",onClose:()=>w(!1),children:[e.jsx(v,{closeButton:!1,children:e.jsx(A,{children:"Confirmation"})}),e.jsxs(E,{children:[e.jsx("a",{children:"Are you sure you want to delete this picker?"}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{style:{display:"flex",justifyContent:"center"},children:[e.jsx(h,{onClick:()=>Ke(Ve),style:{backgroundColor:"#ff4d4d",color:"white",marginRight:"10px"},children:"Yes"}),e.jsx(h,{onClick:()=>w(!1),style:{backgroundColor:"#ff4d4d",color:"white",marginLeft:"10px"},children:"No"})]})]})]}),e.jsxs(S,{alignment:"center",visible:R,scrollable:!0,size:"sm",onClose:()=>k(!1),children:[e.jsx(v,{closeButton:!1,children:e.jsx(A,{children:"Confirmation"})}),e.jsxs(E,{children:[e.jsxs("a",{children:["Are you sure you want to ",W?"activate":"deactivate"," this picker?"]}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{style:{display:"flex",justifyContent:"center"},children:[e.jsx(h,{onClick:()=>Qe(),style:{backgroundColor:"#ff4d4d",color:"white",marginRight:"10px"},children:"Yes"}),e.jsx(h,{onClick:()=>k(!1),style:{backgroundColor:"#ff4d4d",color:"white",marginLeft:"10px"},children:"No"})]})]})]}),e.jsxs(S,{visible:re,scrollable:!0,size:"lg",onClose:()=>j(!1),children:[e.jsx(v,{closeButton:!0,children:e.jsx(A,{children:"Edit Picker Information"})}),e.jsx(E,{children:e.jsxs("div",{className:"row g-3",children:[e.jsx(d,{md:6,children:e.jsx(p,{id:"name",label:"Firt Name",defaultValue:u.name,onChange:s=>oe(s.target.value)})}),e.jsx(d,{md:6,children:e.jsx(p,{id:"surname",label:"LastName",defaultValue:u.surname,onChange:s=>ne(s.target.value)})}),e.jsx(d,{md:6,children:e.jsx(p,{id:"address",label:"Address",defaultValue:u.address,onChange:s=>ye(s.target.value)})}),e.jsx(d,{md:6,children:e.jsx(p,{id:"email",label:"Email",defaultValue:u.email,onChange:s=>de(s.target.value)})}),e.jsx(d,{md:6,children:e.jsx(p,{id:"phone",label:"Contact Number",defaultValue:u.contact,onChange:s=>he(s.target.value)})}),e.jsx(d,{md:6,children:e.jsx(p,{id:"iban",label:"IBAN",defaultValue:u.iban,onChange:s=>me(s.target.value)})}),e.jsx(d,{md:6,children:e.jsx(p,{id:"vat",label:"Vat",defaultValue:u.vat,onChange:s=>fe(s.target.value)})}),e.jsx(d,{md:6,children:e.jsxs(cs,{id:"inputState",label:"City",value:B,onChange:s=>ge(s.target.value),children:[e.jsx("option",{children:u.city}),e.jsx("option",{children:"Milano"}),e.jsx("option",{children:"Napoli"})]})}),e.jsx(d,{xs:6,children:e.jsx(h,{type:"submit",style:{marginBottom:"3%",width:"200px",backgroundColor:"#ff4d4d",color:"white"},onClick:()=>qe(),children:"Update Picker"})}),e.jsx(d,{xs:6,children:e.jsx("span",{style:{fontSize:15,color:"red",cursor:"pointer",marginLeft:"64%",marginTop:"10%"},onClick:()=>_e(),children:"Change Password"})})]})})]})]})};export{vs as default};
