import{r as o,x as W,z as h,j as e,h as _}from"./index-BismIp9s.js";import{a as E}from"./axios-B4uVmeYG.js";/* empty css               */import{B}from"./config-HOLfLxHr.js";import{b as U,a as d}from"./CContainer-BEr4FbZI.js";import{d as R,C as Y,a as q,b as G,c as i}from"./DefaultLayout-CH4w68Bh.js";import{C as J}from"./CNavbar-yECAKyfe.js";import{C as K}from"./CFormInput-BKuvivfL.js";import{C as X,a as Z,b as z,c as l,d as ss,e as n}from"./CTable-BeI7nJZA.js";import{C as es,a as as,b as ts,c as os}from"./CModalTitle-hhCfvApu.js";import"./CFormLabel-s32zAUud.js";const js=()=>{const[j,L]=o.useState(!1),[N,p]=o.useState(!1),[{user:C,token:x},u]=W(),[I,b]=o.useState(!1),[w,S]=o.useState([]),[ls,M]=o.useState([]),[m,T]=o.useState("All"),[k,P]=o.useState(""),[f,$]=o.useState(""),[D,y]=o.useState(""),[v,F]=o.useState(""),[ns,H]=o.useState(!1);o.useEffect(()=>{C&&x&&O()},[k,f]);const O=()=>{b(!0),E.get(B+`assistant/drivers/payouts/0?status=${k}&no=${f}`,{headers:{Authorization:`Bearer ${x}`}}).then(s=>{s.status===200?(S(s.data),b(!1),H(!1)):s.status===204?u({type:h,payload:{status:!0,title:"Error",message:s.data.message,color:"warning"}}):s.status===500&&u({type:h,payload:{status:!0,title:"Error",message:s.data.message,color:"warning"}})}).catch(s=>{console.log("Error",s)})},V=(s,a)=>{L(!j),M({type:s,item:a}),console.log("Toggle",s,a)},g=(s,a)=>{p(!j),F(s),console.log("VIew",s,a),a==="waiting"||a==="sent"?y("ready"):a==="ready"&&y("done")},Q=()=>{console.log("Confirmation",D,v);const s={status:D};C&&x&&E.patch(B+"assistant/payout/change/"+v,s,{headers:{Authorization:`Bearer ${x}`}}).then(a=>{if(a.status===200){console.log("updated"),p(!1);const t=a.data,r=w.map(A=>A.id===t.id?t:A);S([...r])}else a.status===203?u({type:h,payload:{status:!0,title:"Driver Payout status error",message:a.data.message}}):a.status===204?(console.log("204"),u({type:h,payload:{status:!0,title:"Driver Payout status error",message:a.data.message}})):a.status===500&&u({type:h,payload:{status:!0,title:"Driver Payout status update error",message:a.data.message}})}).catch(a=>{console.error(a)})},c=s=>{s==="all"?(P(""),T("All")):(console.log(s),P(s),T(s))};return e.jsxs(U,{children:[e.jsx(R,{style:{marginLeft:"75%"},color:"secondary",children:"Filter by"}),e.jsxs(Y,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[e.jsx(q,{style:{color:"white"},children:m}),e.jsxs(G,{children:[e.jsx(i,{onClick:()=>c("all"),children:"All"}),e.jsx(i,{onClick:()=>c("pending"),children:"Pending"}),e.jsx(i,{onClick:()=>c("sent"),children:"Sent"}),e.jsx(i,{onClick:()=>c("ready"),children:"Ready"}),e.jsx(i,{onClick:()=>c("waiting"),children:"Waiting"}),e.jsx(i,{onClick:()=>c("done"),children:"Done"})]})]}),e.jsx(J,{style:{marginTop:"1%"},className:"bg-body-tertiary",children:e.jsx(K,{type:"text",placeholder:"Search by No",style:{width:450,marginLeft:"0%"},value:f,onChange:s=>$(s.target.value)})}),I?e.jsx(_,{}):e.jsxs(X,{children:[e.jsx(Z,{children:e.jsxs(z,{children:[e.jsx(l,{scope:"col",children:"#"}),e.jsx(l,{scope:"col",children:"No"}),e.jsx(l,{scope:"col",children:"Name"}),e.jsx(l,{scope:"col",children:"Status"}),e.jsx(l,{scope:"col",children:"Date"}),e.jsx(l,{scope:"col",children:"Total"}),e.jsx(l,{scope:"col",children:"Tax"}),e.jsx(l,{scope:"col",children:"Tips"}),e.jsx(l,{scope:"col",children:"Payable"}),e.jsx(l,{scope:"col",children:"Action"}),e.jsx(l,{scope:"col",children:"PDF"})]})}),e.jsx(ss,{children:w.map((s,a)=>{let t="info",r="";return(s==null?void 0:s.status)==="pending"?(r="Pending",t="info"):(s==null?void 0:s.status)==="done"?(r="Paid",t="primary"):(s==null?void 0:s.status)==="sent"?(r="Sent",t="success"):(s==null?void 0:s.status)==="waiting"?(r="Waiting",t="warning"):(s==null?void 0:s.status)==="ready"&&(r="Ready",t="danger"),e.jsxs(z,{children:[e.jsx(n,{children:a+1}),e.jsx(n,{children:s.no}),e.jsx(n,{children:s.name}),e.jsx(n,{children:e.jsx(R,{style:{width:60},color:t,children:r})}),e.jsx(n,{children:s.date}),e.jsx(n,{children:s.total}),e.jsx(n,{children:s.tax}),e.jsx(n,{children:s.tips}),e.jsx(n,{children:s.payable}),e.jsxs(n,{children:[(s==null?void 0:s.status)==="waiting"&&e.jsx(d,{onClick:()=>g(s.id,s.status),size:"sm",color:t,style:{width:90},children:"Received"}),(s==null?void 0:s.status)==="sent"&&e.jsx(d,{size:"sm",onClick:()=>g(s.id,s.status),color:t,style:{width:90},children:"Received"}),(s==null?void 0:s.status)==="ready"&&e.jsx(d,{size:"sm",onClick:()=>g(s.id,s.status),color:t,style:{width:90},children:"To Pay"})]}),e.jsxs(n,{children:[e.jsx(d,{size:"sm",style:{backgroundColor:"#ff4d4d",width:80,color:"white"},onClick:()=>V(s.type,s),children:"View"})," "]})]},a)})})]}),e.jsxs(es,{alignment:"center",visible:N,scrollable:!0,size:"sm",onClose:()=>p(!1),children:[e.jsx(as,{closeButton:!1,children:e.jsx(ts,{children:"Confirmation"})}),e.jsxs(os,{children:[e.jsx("a",{children:"Are you sure you want to pay out status ?"}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{style:{display:"flex",justifyContent:"center"},children:[e.jsx(d,{onClick:()=>Q(),style:{backgroundColor:"#ff4d4d",color:"white",marginRight:"10px"},children:"Yes"}),e.jsx(d,{onClick:()=>p(!1),style:{backgroundColor:"#ff4d4d",color:"white",marginLeft:"10px"},children:"No"})]})]})]})]})};export{js as default};
