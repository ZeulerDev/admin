import{y as Ee,r as o,A as r,j as a,h as Te,L as ve,m as Le}from"./index-BYmq4vc5.js";import{a as g}from"./axios-Cm0UX6qg.js";import{B as N}from"./config-HOLfLxHr.js";import{b as Re,a as J}from"./CContainer-CHPGgvmL.js";import{C as K,a as B,b as w,c as U,d as u}from"./DefaultLayout-D2DuRGJD.js";import{C as $e}from"./CNavbar-C8iiLf1a.js";import{C as W}from"./CFormInput-Dz42N3RN.js";import{C as ze,a as Fe,b as X,c as n,d as He,e as h}from"./CTable--SWjA8cW.js";import{C as Y}from"./CCardImage-C9Pj1z_J.js";import{c as Ve}from"./cil-pencil-m516yCOw.js";import{C as _e,a as E}from"./CPaginationItem-Cz9liH1m.js";import{C as Z,a as ee,b as ae,c as te}from"./CModalTitle-Cg7yZsHL.js";import{C as se}from"./CModalFooter-DeikAXwR.js";import"./CFormLabel-DYgf8peY.js";const ra=()=>{const[{user:m,token:c},l]=Ee(),[oe,T]=o.useState(!1),[le,re]=o.useState([]),[x,j]=o.useState(0),[ce,C]=o.useState(!0),[ne,de]=o.useState([]),[ie,y]=o.useState("All Chains"),[ue,v]=o.useState("All market"),[Qe,k]=o.useState(""),[L,R]=o.useState(""),[he,pe]=o.useState([]),[P,ge]=o.useState(""),[me,b]=o.useState(!1),[xe,$]=o.useState(""),[S,z]=o.useState(""),[Ce,F]=o.useState(""),[fe,je]=o.useState(0),[f,I]=o.useState(1),[H,D]=o.useState("NAME"),[V,M]=o.useState(!1),[ye,_]=o.useState("");o.useEffect(()=>{m&&c&&p(0)},[m,c,L,P]),o.useEffect(()=>{c&&g.get("http://localhost:8003/assistant/market/chains/all",{headers:{Authorization:`Bearer ${c}`}}).then(e=>{e.status===200?de(e.data):e.status===500&&l({type:r,payload:{status:!0,title:"Chain Loading error",message:e.data.message}})}).catch(e=>{console.error("Error: ",e)})},[]);const ke=e=>{g.get(`http://localhost:8003/assistant/market/locations?brand=${e}`,{headers:{Authorization:`Bearer ${c}`}}).then(t=>{t.status===200?(pe(t.data.data),t.data.data.length<20?(C(!0),console.log("ok")):t.data.data.length>19&&C(!1)):t.status===500&&l({type:r,payload:{status:!0,title:"Market Loading error",message:t.data.message}})}).catch(t=>{console.error("Error: ",t)})},p=(e,t)=>{T(!0),g.get(N+`product/all/${e}?marketId=${L}&name=${P}&type=${H}`,{headers:{Authorization:`Bearer ${c}`}}).then(s=>{s.status===200?(re(s.data.list),je(s.data.count),T(!1),s.data.list.length<20?(C(!0),console.log("ok")):s.data.list.length>19&&C(!1)):s.status===203?l({type:r,payload:{status:!0,title:"product loading error error",message:s.data.message}}):s.status===204?l({type:r,payload:{status:!0,title:"No Products",message:"No products found in this market address",color:"info"}}):s.status===500&&l({type:r,payload:{status:!0,title:"product loading error error",message:s.data.message}})}).catch(s=>{console.error("Error:",s)})},Q=(e,t)=>{e==="all"?(k(""),y("All Chains")):(k(e),ke(e),y(t))},O=(e,t)=>{e==="all"?(R(""),v("All Markets"),k(""),y("All Chains")):(R(e),v(t))},Pe=()=>{I(f+1);const e=x+50;j(e),p(e)},be=()=>{I(f-1);const e=x-50;console.log(e),j(e),p(e)},Se=(e,t)=>{b(!0),$(e),F(t)},Ie=()=>{console.log("called"),S==""?l({type:r,payload:{status:!0,title:"Alert",message:"Please enter the price",color:"warning"}}):Ae(xe)},De=e=>{I(e);const t=(e-1)*50;j(t),p(t)},Me=()=>{const e=Math.ceil(fe/50),t=[];for(let i=1;i<=e;i++)t.push(i);const s=Math.max(f-2,1),d=Math.min(s+4,e);return t.slice(s-1,d).map(i=>a.jsx(E,{active:f===i,onClick:()=>De(i),children:i},i))},Ae=e=>{if(e){let t={price:S+" â‚¬"};m&&c&&g.put(N+"product/update/price/"+e,t,{headers:{Authorization:`Bearer ${c}`}}).then(s=>{s.status===200?(l({type:r,payload:{status:!0,title:"Product Details Update",message:"Product price update Success",color:"success"}}),$(""),z(""),p(0),b(!1),F("")):s.status===204?l({type:r,payload:{status:!0,title:"Product Details Update error",message:s.data.message,color:"danger"}}):s.status===500&&l({type:r,payload:{status:!0,title:"Product Details Update error",message:s.data.message,color:"danger"}})}).catch(s=>{console.error("Error:",s)})}else alert("Please Check the Fields!")},Ne=e=>{M(!V),_(e)},[Be,A]=o.useState(null),[q,G]=o.useState(null),we=e=>{console.log(e),G(URL.createObjectURL(e)),A(e)},Ue=async(e,t)=>{if(console.log(e,t),m&&c){const s=new FormData;s.append("image",t),s.append("id",e),g.post(N+"test/product/image/update",s,{headers:{Authorization:`Bearer ${c}`}}).then(d=>{d.status===200?(M(!1),_(""),A(null),console.log("response",d.data),l({type:r,payload:{status:!0,title:"Image upload ",message:"Image upload success",color:"success"}}),p(0)):d.status===500&&l({type:r,payload:{status:!0,title:"Image upload error",message:d.data.message,color:"danger"}})}).catch(d=>{console.error("Error:",d)})}};return a.jsxs(Re,{children:[a.jsx(K,{style:{marginLeft:"57%"},color:"secondary",children:"Filter by"}),a.jsxs(B,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[a.jsx(w,{children:ie}),a.jsxs(U,{children:[a.jsx(u,{onClick:()=>Q("all"),children:"All"}),ne.map((e,t)=>a.jsx(u,{onClick:()=>Q(e.id,e.name),children:e.name},t))]})]}),a.jsxs(B,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[a.jsx(w,{children:ue}),a.jsxs(U,{children:[a.jsx(u,{onClick:()=>O("all"),children:"Select the Chain"}),he.map((e,t)=>a.jsx(u,{onClick:()=>O(e._id,e.address),children:e.address},t))]})]}),a.jsxs($e,{style:{marginTop:"1%"},className:"bg-body-tertiary",children:[a.jsx(K,{style:{marginLeft:"0.2%"},color:"secondary",children:"Select the seatch type"}),a.jsxs(B,{style:{marginRight:"0%",width:"17%",backgroundColor:"#ff4d4d"},children:[a.jsxs(w,{children:[H," "]}),a.jsxs(U,{children:[a.jsx(u,{onClick:()=>D("NAME"),children:"By Name"}),a.jsx(u,{onClick:()=>D("ID"),children:"By Product Id"}),a.jsx(u,{onClick:()=>D("BRAND"),children:"By BRAND NAME"})]})]}),a.jsx(W,{type:"text",placeholder:"Search here",style:{width:450,marginRight:"30%"},value:P,onChange:e=>ge(e.target.value)})]}),oe?a.jsx(Te,{}):a.jsxs(ze,{children:[a.jsx(Fe,{children:a.jsxs(X,{children:[a.jsx(n,{scope:"col",children:"#"}),a.jsx(n,{scope:"col",children:"Product Id"}),a.jsx(n,{scope:"col",children:"Photo"}),a.jsx(n,{scope:"col",children:"Name"}),a.jsx(n,{scope:"col",children:"Price"}),a.jsx(n,{scope:"col",children:"Brand"}),a.jsx(n,{scope:"col",children:"Chain"}),a.jsx(n,{scope:"col",children:"Market Address"})]})}),a.jsx(He,{children:le.map((e,t)=>a.jsxs(X,{children:[a.jsx(h,{children:x+t+1}),a.jsx(h,{children:e.pid}),a.jsx(n,{onClick:()=>{Ne(e.productId)},children:a.jsx(Y,{style:{width:"50px",height:"50px"},src:"https://api.zeuler.com/image/"+e.image})}),a.jsx(h,{children:e.name}),a.jsxs(h,{children:[e.price,a.jsx(ve,{to:"",children:a.jsx(Le,{icon:Ve,size:"sm",onClick:()=>Se(e.productId,e.price)})})]}),a.jsx(h,{children:e.brand}),a.jsx(h,{children:e.chainName}),a.jsx(h,{children:e.marketAddress})]},t))})]}),a.jsxs(_e,{"aria-label":"Page navigation example",children:[a.jsx(E,{disabled:x<=0,onClick:be,children:"Previous"}),Me(),a.jsx(E,{disabled:ce===!0,onClick:Pe,children:"Next"})]}),a.jsxs(Z,{alignment:"center",visible:me,scrollable:!0,size:"sm",onClose:()=>b(!1),children:[a.jsx(ee,{closeButton:!0,children:a.jsx(ae,{children:"Change Price"})}),a.jsxs(te,{children:[a.jsx("a",{children:"Enter New Name"}),a.jsx("br",{}),a.jsx(W,{type:"text",placeholder:Ce,value:S,onChange:e=>z(e.target.value)})]}),a.jsx(se,{children:a.jsx(J,{style:{backgroundColor:"#ff4d4d",color:"white"},onClick:()=>Ie(),children:"Save changes"})})]}),a.jsxs(Z,{alignment:"center",visible:V,scrollable:!0,size:"lg",onClose:()=>{M(!1),A(null),G(null)},children:[a.jsx(ee,{closeButton:!0,children:a.jsx(ae,{children:"Image Uploader"})}),a.jsxs(te,{children:[q&&a.jsx(Y,{style:{width:"100px",height:"100px"},src:q,alt:"Uploaded Image"}),a.jsx("input",{style:{marginLeft:"5%"},type:"file",accept:".jpg, .jpeg, .png",onChange:e=>we(e.target.files[0])})]}),a.jsx(se,{children:a.jsx(J,{style:{backgroundColor:"#ff4d4d",color:"white"},onClick:()=>{Ue(ye,Be)},children:"Upload Image"})})]})]})};export{ra as default};
