import{r as o,y as is,A as d,j as e,h as ds}from"./index-C7xebdlB.js";import{a as M}from"./axios-Cm0UX6qg.js";import{P as V,F as us,O as hs}from"./OccasionalEmployeePDF-CldplX-P.js";import{B as O}from"./config-HOLfLxHr.js";import{b as ps,a as h}from"./CContainer-DmyDJSbi.js";import{C as $,a as xs,b as gs,c as ys,d as p}from"./DefaultLayout-jQufvVlr.js";import{C as fs}from"./CNavbar-DAGRjB36.js";import{C as js}from"./CFormInput-BJT20qYv.js";import{C as Cs,a as Ps,b as H,c as l,d as bs,e as n}from"./CTable-bhvJ0O4o.js";import{C as ws,a as v}from"./CPaginationItem-BwX0sL4W.js";import{C as _,a as Q,b as W,c as Y}from"./CModalTitle-DqlcJFLS.js";import"./inheritsLoose-BR9xv5Kf.js";import"./typeof-QjJsDpFa.js";import"./index-8f2u4578.js";import"./CFormLabel-Dfa51LwS.js";const Ms=()=>{const[j,R]=o.useState(!1),[U,x]=o.useState(!1),[{user:q,token:C},i]=is(),[G,P]=o.useState(!1),[A,B]=o.useState([]),[g,J]=o.useState([]),[K,E]=o.useState("All"),[I,N]=o.useState(""),[b,X]=o.useState(""),[F,w]=o.useState(""),[L,Z]=o.useState(""),[ss,es]=o.useState(0),[y,m]=o.useState(1),[k,S]=o.useState(0),[ts,z]=o.useState(!0);o.useEffect(()=>{const s=setTimeout(()=>{i({type:d,payload:{status:!0,title:"Data Loading",message:"Data loading error: Timeout exceeded",color:"warning"}}),P(!1)},2e4);return f(0,s),()=>{clearTimeout(s)}},[I,b]);const f=(s,t)=>{P(!0),M.get(O+`assistant/pickers/payouts/${s}?status=${I}&no=${b}`,{headers:{Authorization:`Bearer ${C}`}}).then(a=>{a.status===200?(B(a.data.data),es(a.data.count),P(!1),clearTimeout(t),a.data.list.length<50?(z(!0),console.log("ok")):a.data.list.length>49&&z(!1)):a.status===204?i({type:d,payload:{status:!0,title:"Error",message:a.data.message,color:"warning"}}):a.status===500&&(console.log("error","500"),i({type:d,payload:{status:!0,title:"Error",message:a.data.message,color:"warning"}}))}).catch(a=>{console.log("Error",a)})},as=()=>{m(y+1);const s=k+50;S(s),f(s,!0)},os=()=>{m(y-1);const s=k-50;console.log(s),S(s),f(s,!1)},ls=(s,t)=>{R(!j),J({type:s,item:t}),console.log("Toggle",s,t)},T=(s,t)=>{x(!j),Z(s),console.log("VIew",s,t),t==="waiting"||t==="sent"?w("ready"):t==="ready"&&w("done")},ns=()=>{console.log("Confirmation",F,L);const s={status:F};q&&C&&M.patch(O+"assistant/payout/change/"+L,s,{headers:{Authorization:`Bearer ${C}`}}).then(t=>{if(t.status===200){console.log("updated"),x(!1);const a=t.data,r=A.map(D=>D.id===a.id?a:D);B([...r]),i({type:d,payload:{status:!0,title:"Pricker Payout status",message:"Payout status updated successfully",color:"success"}})}else t.status===203?i({type:d,payload:{status:!0,title:"Pricker Payout status error",message:t.data.message}}):t.status===204?(console.log("204"),i({type:d,payload:{status:!0,title:"Pricker Payout status error",message:t.data.message}})):t.status===500&&i({type:d,payload:{status:!0,title:"Pricker Payout status update error",message:t.data.message}})}).catch(t=>{console.error(t)})},u=s=>{s==="all"?(N(""),E("All")):(console.log(s),N(s),E(s))},rs=s=>{m(s);const t=(s-1)*50;S(t),f(t,!0)},cs=()=>{const s=Math.ceil(ss/50),t=[];for(let c=1;c<=s;c++)t.push(c);const a=Math.max(y-2,1),r=Math.min(a+4,s);return t.slice(a-1,r).map(c=>e.jsx(v,{active:y===c,onClick:()=>rs(c),children:c},c))};return e.jsxs(ps,{children:[e.jsx($,{style:{marginLeft:"75%"},color:"secondary",children:"Filter by"}),e.jsxs(xs,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[e.jsx(gs,{style:{color:"white"},children:K}),e.jsxs(ys,{children:[e.jsx(p,{onClick:()=>u("all"),children:"All"}),e.jsx(p,{onClick:()=>u("pending"),children:"Pending"}),e.jsx(p,{onClick:()=>u("sent"),children:"Sent"}),e.jsx(p,{onClick:()=>u("ready"),children:"Ready"}),e.jsx(p,{onClick:()=>u("waiting"),children:"Waiting"}),e.jsx(p,{onClick:()=>u("done"),children:"Done"})]})]}),e.jsx(fs,{style:{marginTop:"1%"},className:"bg-body-tertiary",children:e.jsx(js,{type:"text",placeholder:"Search By No",style:{width:450,marginLeft:"0%"},value:b,onChange:s=>X(s.target.value)})}),G?e.jsx(ds,{}):e.jsxs(Cs,{children:[e.jsx(Ps,{children:e.jsxs(H,{children:[e.jsx(l,{scope:"col",children:"#"}),e.jsx(l,{scope:"col",children:"No"}),e.jsx(l,{scope:"col",children:"Name"}),e.jsx(l,{scope:"col",children:"Status"}),e.jsx(l,{scope:"col",children:"Date"}),e.jsx(l,{scope:"col",children:"Total"}),e.jsx(l,{scope:"col",children:"Tax"}),e.jsx(l,{scope:"col",children:"Tips"}),e.jsx(l,{scope:"col",children:"Payable"}),e.jsx(l,{scope:"col",children:"Action"}),e.jsx(l,{scope:"col",children:"PDF"})]})}),e.jsx(bs,{children:A.map((s,t)=>{let a="info",r="";return(s==null?void 0:s.status)==="pending"?(r="Pending",a="info"):(s==null?void 0:s.status)==="done"?(r="Paid",a="primary"):(s==null?void 0:s.status)==="sent"?(r="Sent",a="success"):(s==null?void 0:s.status)==="waiting"?(r="Waiting",a="warning"):(s==null?void 0:s.status)==="ready"&&(r="Ready",a="danger"),e.jsxs(H,{children:[e.jsx(n,{children:t+1}),e.jsx(n,{children:s.no}),e.jsx(n,{children:s.name}),e.jsx(n,{children:e.jsx($,{style:{width:60},color:a,children:r})}),e.jsx(n,{children:s.date}),e.jsx(n,{children:s.total}),e.jsx(n,{children:s.tax}),e.jsx(n,{children:s.tips}),e.jsx(n,{children:s.payable}),e.jsxs(n,{children:[(s==null?void 0:s.status)==="waiting"&&e.jsx(h,{onClick:()=>T(s.id,s.status),size:"sm",color:a,style:{width:90},children:"Received"}),(s==null?void 0:s.status)==="sent"&&e.jsx(h,{size:"sm",onClick:()=>T(s.id,s.status),color:a,style:{width:90},children:"Received"}),(s==null?void 0:s.status)==="ready"&&e.jsx(h,{size:"sm",onClick:()=>T(s.id,s.status),color:a,style:{width:90},children:"To Pay"})]}),e.jsxs(n,{children:[e.jsx(h,{size:"sm",style:{backgroundColor:"#ff4d4d",width:80,color:"white"},onClick:()=>ls(s.type,s),children:"View"})," "]})]},t)})})]}),e.jsxs(ws,{"aria-label":"Page navigation example",children:[e.jsx(v,{disabled:k<=0,onClick:os,children:"Previous"}),cs(),e.jsx(v,{disabled:ts===!0,onClick:as,children:"Next"})]}),e.jsxs(_,{visible:j,scrollable:!0,size:"xl",onClose:()=>R(!1),children:[e.jsx(Q,{closeButton:!0,children:e.jsx(W,{children:"Information"})}),e.jsx(Y,{style:{overflowY:"auto",maxHeight:"70vh",display:"flex",justifyContent:"center"},children:e.jsx(o.Suspense,{fallback:e.jsx("div",{children:"Loading PDF Viewer..."}),children:g.type==="flat_rate"?e.jsx(V,{style:{width:"100%",height:"100vh"},children:e.jsx(us,{data:g.item})}):g.type==="occasional"?e.jsx(V,{style:{width:"100%",height:"100vh"},children:e.jsx(hs,{data:g.item})}):null})})]}),e.jsxs(_,{alignment:"center",visible:U,scrollable:!0,size:"sm",onClose:()=>x(!1),children:[e.jsx(Q,{closeButton:!1,children:e.jsx(W,{children:"Confirmation"})}),e.jsxs(Y,{children:[e.jsx("a",{children:"Are you sure you want to pay out status ?"}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{style:{display:"flex",justifyContent:"center"},children:[e.jsx(h,{onClick:()=>ns(),style:{backgroundColor:"#ff4d4d",color:"white",marginRight:"10px"},children:"Yes"}),e.jsx(h,{onClick:()=>x(!1),style:{backgroundColor:"#ff4d4d",color:"white",marginLeft:"10px"},children:"No"})]})]})]})]})};export{Ms as default};
