import{r as o,_ as ie,u as ne,a as l,b as I,P as c,c as A,y as ce,l as de,A as d,j as e,L as ue,i as me,m as he}from"./index-fXJRM7NO.js";import{a as S}from"./axios-Cm0UX6qg.js";import{B as N}from"./config-HOLfLxHr.js";import{b as fe,a as $}from"./CContainer-BeSOUxxJ.js";import{d as pe,C as X,a as Z,b as _,c as F}from"./DefaultLayout-D63ojtA4.js";import{C as ke}from"./CNavbar-CRQwyplX.js";import{C as Ce,a as be,b as ee,c as f,d as ge,e as p}from"./CTable-IdQKwIrA.js";import{a as se,C as ae}from"./CFormLabel-BQW1rdN1.js";import{c as xe}from"./cil-trash-CBbKHhHb.js";import{C as ve,a as te}from"./CPaginationItem-CYLd6TtO.js";import{C as ye,a as je,b as Ee,c as Me}from"./CModalTitle-DJfoR2go.js";var v=o.forwardRef(function(s,u){var i=s.className,n=s.button,V=s.feedback,L=s.feedbackInvalid,U=s.feedbackValid,w=s.floatingLabel,T=s.tooltipFeedback,y=s.hitArea,h=s.id,k=s.indeterminate,P=s.inline,j=s.invalid,C=s.label,H=s.reverse,E=s.type,O=E===void 0?"checkbox":E,g=s.valid,R=ie(s,["className","button","feedback","feedbackInvalid","feedbackValid","floatingLabel","tooltipFeedback","hitArea","id","indeterminate","inline","invalid","label","reverse","type","valid"]),b=o.useRef(null),B=ne(u,b);o.useEffect(function(){b.current&&k&&(b.current.indeterminate=k)},[k,b.current]);var m=function(){return l.createElement("input",I({type:O,className:A(n?"btn-check":"form-check-input",{"is-invalid":j,"is-valid":g,"me-2":y}),id:h},R,{ref:B}))},M=function(){return l.createElement(se,{describedby:R["aria-describedby"],feedback:V,feedbackInvalid:L,feedbackValid:U,floatingLabel:w,invalid:j,tooltipFeedback:T,valid:g})},z=function(){var D;return l.createElement(ae,I({customClassName:A(n?A("btn",n.variant?"btn-".concat(n.variant,"-").concat(n.color):"btn-".concat(n.color),(D={},D["btn-".concat(n.size)]=n.size,D),"".concat(n.shape)):"form-check-label")},h&&{htmlFor:h}),C)},x=function(){return n?l.createElement(l.Fragment,null,l.createElement(m,null),C&&l.createElement(z,null),l.createElement(M,null)):C?y?l.createElement(l.Fragment,null,l.createElement(m,null),l.createElement(ae,I({customClassName:A("form-check-label stretched-link",i)},h&&{htmlFor:h}),C),l.createElement(M,null)):l.createElement("div",{className:A("form-check",{"form-check-inline":P,"form-check-reverse":H,"is-invalid":j,"is-valid":g},i)},l.createElement(m,null),l.createElement(z,null),l.createElement(M,null)):l.createElement(m,null)};return l.createElement(x,null)});v.propTypes=I({button:c.object,className:c.string,hitArea:c.oneOf(["full"]),id:c.string,indeterminate:c.bool,inline:c.bool,label:c.oneOfType([c.string,c.node]),reverse:c.bool,type:c.oneOf(["checkbox","radio"])},se.propTypes);v.displayName="CFormCheck";const ze=()=>{const[{user:s,token:u},i]=ce(),[n,V]=o.useState([]),[L,U]=o.useState([]),[w,T]=o.useState(""),[y,h]=o.useState(""),[k,P]=o.useState(0),[j,C]=o.useState("All Cities"),[H,E]=o.useState("All Chains");o.useState();const[O,g]=o.useState(!1),[R,b]=o.useState(!0);de();const[B,m]=o.useState(!1),[M,z]=o.useState("");o.useEffect(()=>{u&&S.get(N+"assistant/market/chains/all",{headers:{Authorization:`Bearer ${u}`}}).then(a=>{a.status===200?V(a.data):a.status===500&&i({type:d,payload:{status:!0,title:"Chain Loading error",message:a.data.message}})}).catch(a=>{console.error("Error: ",a)})},[]),o.useEffect(()=>{s&&u&&x(0)},[w,y,s]);const x=(a,t)=>{g(!0),S.get(N+`assistant/market/locations/${a}?brand=${w}&city=${y}`,{headers:{Authorization:`Bearer ${u}`}}).then(r=>{r.status===200?(U(r.data.data),g(!1),r.data.data.length<20?(b(!0),console.log("ok")):r.data.data.length>19&&b(!1)):r.status===500&&i({type:d,payload:{status:!0,title:"Market Loading error",message:r.data.message}})}).catch(r=>{console.error("Error: ",r)})},D=()=>{const a=k+20;P(a),x(a)},le=()=>{const a=k-20;console.log(a),P(a),x(a)},G=(a,t)=>{a==="all"?(T(""),E("All Chains")):(T(a),E(t))},q=a=>{a==="all"?(h(""),C("All Cities")):(h(a),C(a))},J=(a,t,r)=>{console.log(a),console.log(L),r==="delivery"?(Q({market:a,service:r}),console.log("add delivery")):r==="pickup"&&(Q({market:a,service:r}),console.log("add pickup"))},K=(a,t,r)=>{r==="delivery"?(W({market:a,service:r}),console.log("remove delivery")):r==="pickup"&&(W({market:a,service:r}),console.log("remove pickup"))},Q=a=>{S.post(N+"assistant/markets/add/services",a,{headers:{Authorization:`Bearer ${u}`}}).then(t=>{t.status===200?console.log("Updated add service"):t.status===203?i({type:d,payload:{status:!0,title:"Market Updated error",message:t.data.message}}):t.status===204?i({type:d,payload:{status:!0,title:"Market Updated error",message:t.data.message}}):t.status===500&&i({type:d,payload:{status:!0,title:"Market Updated error",message:t.data.message}})}).catch(t=>{console.error("Error:",t)})},W=a=>{S.post(N+"assistant/markets/remove/services",a,{headers:{Authorization:`Bearer ${u}`}}).then(t=>{t.status===200?console.log("Updated remove service"):t.status===203?i({type:d,payload:{status:!0,title:"Market remove error",message:t.data.message}}):t.status===204?i({type:d,payload:{status:!0,title:"Market remove error",message:t.data.message}}):t.status===500&&i({type:d,payload:{status:!0,title:"Market remove error",message:t.data.message}})}).catch(t=>{console.error("Error:",t)})},re=a=>{m(!B),z(a)},oe=a=>{console.log(a),S.delete(N+"market/"+a,{headers:{Authorization:`Bearer ${u}`}}).then(t=>{t.status===200?(i({type:d,payload:{status:!0,title:"Market Delete",message:"Market Remove Success",color:"success"}}),m(!1),x(0),console.log("Remove Market")):t.status===404?i({type:d,payload:{status:!0,title:"Market remove error",message:t.data.message}}):t.status===500&&i({type:d,payload:{status:!0,title:"Market remove error",message:t.data.message}})}).catch(t=>{console.error("Error:",t)})};return e.jsxs(fe,{children:[e.jsx(ue,{to:"/markets/addmarket",children:e.jsx($,{style:{marginLeft:"0%",width:"17%",backgroundColor:"#ff4d4d",color:"white"},children:"Add New Market"})}),e.jsx(pe,{style:{marginLeft:"39.5%"},color:"secondary",children:"Filter by"}),e.jsxs(X,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[e.jsx(Z,{style:{color:"white"},children:j}),e.jsxs(_,{children:[e.jsx(F,{onClick:()=>q("all"),children:"All"}),e.jsx(F,{onClick:()=>q("Milano"),children:"Milano"}),e.jsx(F,{onClick:()=>q("Napoli"),children:"Napoli"})]})]}),e.jsxs(X,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[e.jsx(Z,{style:{color:"white"},children:H}),e.jsxs(_,{children:[e.jsx(F,{onClick:()=>G("all"),children:"All"}),n.map((a,t)=>e.jsx(F,{onClick:()=>G(a.id,a.name),children:a.name},t))]})]}),e.jsx(ke,{style:{marginTop:"1%"},className:"bg-body-tertiary"}),O?e.jsx(me,{}):e.jsxs(Ce,{children:[e.jsx(be,{children:e.jsxs(ee,{children:[e.jsx(f,{scope:"col",children:"#"}),e.jsx(f,{scope:"col",children:"Name"}),e.jsx(f,{scope:"col",children:"Address"}),e.jsx(f,{scope:"col",children:"City"}),e.jsx(f,{scope:"col",children:"Delivery"}),e.jsx(f,{scope:"col",children:"Pickup"}),e.jsx(f,{scope:"col",children:"Scraped"}),e.jsx(f,{scope:"col",children:"Remove"})]})}),e.jsx(ge,{children:L.map((a,t)=>e.jsxs(ee,{children:[e.jsx(p,{children:t+1}),e.jsx(p,{children:a.chain.name}),e.jsx(p,{children:a.address}),e.jsx(p,{children:a.city}),e.jsx(p,{children:a.services.includes("delivery")?e.jsx(v,{id:"flexCheckChecked",label:"",defaultChecked:!0,onChange:()=>K(a._id,!0,"delivery")}):e.jsx(v,{id:"flexCheckChecked",label:"",onChange:()=>J(a._id,!0,"delivery")})}),e.jsx(p,{children:a.services.includes("pickup")?e.jsx(v,{id:"flexCheckChecked",label:"",defaultChecked:!0,onChange:()=>K(a._id,!0,"pickup")}):e.jsx(v,{id:"flexCheckChecked",label:"",onChange:()=>J(a._id,!0,"pickup")})}),e.jsx(p,{children:a.scraped}),e.jsx(p,{children:e.jsx($,{size:"sm",style:{backgroundColor:"#ff4d4d"},variant:"outline",onClick:()=>re(a._id),children:e.jsx(he,{icon:xe,size:"lg",style:{color:"white"}})})})]},t))})]}),e.jsxs(ve,{"aria-label":"Page navigation example",children:[e.jsx(te,{disabled:k<=0,onClick:le,children:"Previous"}),e.jsx(te,{disabled:R===!0,onClick:D,children:"Next"})]}),e.jsxs(ye,{alignment:"center",visible:B,scrollable:!0,size:"sm",onClose:()=>m(!1),children:[e.jsx(je,{closeButton:!1,children:e.jsx(Ee,{children:"Confirmation"})}),e.jsxs(Me,{children:[e.jsx("a",{children:"Are you sure you want to delete this market?"}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{style:{display:"flex",justifyContent:"center"},children:[e.jsx($,{onClick:()=>oe(M),style:{backgroundColor:"#ff4d4d",color:"white",marginRight:"10px"},children:"Yes"}),e.jsx($,{onClick:()=>m(!1),style:{backgroundColor:"#ff4d4d",color:"white",marginLeft:"10px"},children:"No"})]})]})]})]})};export{ze as default};
