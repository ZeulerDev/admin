import{r as l,y as M,A as c,j as e,h as z}from"./index-DAsP9voM.js";import{a as k}from"./axios-Cm0UX6qg.js";import{B as A}from"./config-HOLfLxHr.js";import{b as L,a as j}from"./CContainer-CNWVNE3j.js";import{C as N}from"./CNavbar-ll-tvqBp.js";import{C as V}from"./CFormInput-DnKel7m3.js";import{C as R,a as H,b as w,c as t,d as F,e as o}from"./CTable-DPdXPM9f.js";import{d as i}from"./DefaultLayout-C20riYYY.js";import{C as Q,a as U,b as Y,c as _}from"./CModalTitle-Dzz95ONy.js";import{C as $}from"./CModalFooter-CssSBCca.js";import"./CFormLabel-LzdqjwNr.js";const te=()=>{const[f,p]=l.useState(!1),[{user:C,token:h},r]=M(),[x,y]=l.useState([]),[E,g]=l.useState(!1),[I,S]=l.useState(""),[b,T]=l.useState(""),[m,B]=l.useState("");l.useEffect(()=>{let a=setTimeout(()=>{r({type:c,payload:{status:!0,title:"Data Loading",message:"Data loading error: Timeout exceeded",color:"warning"}}),g(!1)},2e4);return D(a),()=>{clearTimeout(a)}},[m]);const D=a=>{C&&h&&(g(!0),k.get(A+"assistant/vat/shoppers/0?search="+m,{headers:{Authorization:`Bearer ${h}`}}).then(s=>{s.status===200?(y(s.data),clearTimeout(a),g(!1),console.log("done")):s.status===204?r({type:c,payload:{status:!0,title:"Error",message:s.data.message,color:"warning"}}):s.status===500&&r({type:c,payload:{status:!0,title:"Error",message:s.data.message,color:"warning"}})}).catch(s=>{console.error("Error:",s)}))},v=(a,s=null)=>{p(!f),S(a),s!==null?T(s):console.log("VAT PID not provided"),console.log(a)},P=()=>{const a={vat:b};C&&h&&k.patch(A+"assistant/shopper/vat/"+I,a,{headers:{Authorization:`Bearer ${h}`}}).then(s=>{if(s.status===200){console.log("updated"),p(!1);const n=s.data,d=x.find(u=>u.id===n.id);d&&(d.vat=n.vat),y([...x]),r({type:c,payload:{status:!0,title:"Picker VAT Id ",message:"VAT Id updated successfully"}})}else s.status===203?(console.log("203"),r({type:c,payload:{status:!0,title:"Picker VAT Id update error",message:s.data.message}})):s.status===204?(console.log("204"),r({type:c,payload:{status:!0,title:"Picker VAT Id update error",message:s.data.message}})):s.status===500&&r({type:c,payload:{status:!0,title:"Picker VAT Id update error",message:s.data.message}})}).catch(s=>{console.error(s)})};return e.jsxs(L,{children:[e.jsx(N,{className:"bg-body-tertiary",children:e.jsx(V,{type:"text",placeholder:"Search",style:{width:450,marginLeft:"0%"},value:m,onChange:a=>B(a.target.value)})}),E?e.jsx(z,{}):e.jsxs(R,{children:[e.jsx(H,{children:e.jsxs(w,{children:[e.jsx(t,{scope:"col",children:"#"}),e.jsx(t,{scope:"col",children:"Name"}),e.jsx(t,{scope:"col",children:"City"}),e.jsx(t,{scope:"col",children:"Vat"}),e.jsx(t,{scope:"col",children:"Activate"}),e.jsx(t,{scope:"col",children:"Disabled"}),e.jsx(t,{scope:"col",children:"market"}),e.jsx(t,{scope:"col",children:"Action"})]})}),e.jsx(F,{children:x.map((a,s)=>{var n,d,u;return e.jsxs(w,{children:[e.jsx(o,{children:s+1}),e.jsx(o,{children:a.name}),e.jsx(o,{children:a.city}),e.jsx(o,{children:a.vat?a.vat:e.jsx(i,{color:"warning",children:"Empty"})}),e.jsx(o,{children:a.activate?e.jsx(i,{color:"success",children:"Yes"}):e.jsx(i,{color:"warning",children:"No"})}),e.jsx(o,{children:a.disabled?e.jsx(i,{color:"success",children:"No"}):e.jsx(i,{color:"warning",children:"Yes"})}),e.jsxs(o,{children:[(d=(n=a.market)==null?void 0:n.chain)==null?void 0:d.name," - ",(u=a.market)==null?void 0:u.address]}),e.jsx(o,{children:a.vat===""?e.jsx(j,{size:"sm",style:{backgroundColor:"#ff4d4d",width:70,color:"white"},onClick:()=>v(a.id,a.vat),children:"Insert "}):e.jsx(j,{size:"sm",style:{backgroundColor:"#ff4d4d",width:70,color:"white"},onClick:()=>v(a.id,a.vat),children:"Edit "})})]},s)})})]}),e.jsxs(Q,{alignment:"center",visible:f,scrollable:!0,size:"sm",onClose:()=>p(!1),children:[e.jsx(U,{closeButton:!0,children:e.jsx(Y,{children:"Confirmation"})}),e.jsxs(_,{children:[e.jsx("a",{children:"Enter Picker's VAT id here"}),e.jsx("br",{}),e.jsx(V,{type:"text",placeholder:"Vat id",value:b,onChange:a=>T(a.target.value)})]}),e.jsx($,{children:e.jsx(j,{style:{backgroundColor:"#ff4d4d",color:"white"},onClick:()=>P(),children:"Save changes"})})]})]})};export{te as default};
