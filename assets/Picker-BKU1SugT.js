import{r as s,y as Te,A as o,j as e,L as ue,i as Ge,m as Ve}from"./index-B2hfUMGE.js";import{a as f}from"./axios-Cm0UX6qg.js";/* empty css               */import{B as g}from"./config-HOLfLxHr.js";import{b as ze,a as m}from"./CContainer-BRHb_Bxm.js";import{d as $e,C as w,a as P,b as v,c as p}from"./DefaultLayout-D6wqnBGw.js";import{C as Fe}from"./CNavbar-CSeuDg2_.js";import{C as h}from"./CFormInput-CaOuQqbh.js";import{C as Re,a as He,b as he,c as n,d as _e,e as c}from"./CTable-C9G5NwRF.js";import{c as Ue}from"./cil-pencil-m516yCOw.js";import{C as pe,a as me,b as xe,c as fe}from"./CModalTitle-BzPVoAXi.js";import{C as u}from"./CCol-BWmj3ItI.js";import{C as Ye}from"./CFormSelect-Dd8qC-9m.js";import"./CFormLabel-Dgn9qH-2.js";const oa=()=>{const[A,C]=s.useState(!1),[{user:y,token:i},r]=Te(),[E,D]=s.useState([]),[ge,L]=s.useState(!1),[M,N]=s.useState(""),[B,I]=s.useState(""),[T,G]=s.useState(""),[j,Ce]=s.useState(""),[V,z]=s.useState(!1),[$,F]=s.useState(""),[je,R]=s.useState(!1),[ye,H]=s.useState("All Cities"),[ke,_]=s.useState("All Market Groups"),[be,U]=s.useState("All Chains"),[Se,we]=s.useState([]),[Pe,ve]=s.useState([]),[Y,k]=s.useState(!1),[d,Ae]=s.useState([]),[q,J]=s.useState(),[K,Q]=s.useState(),[W,X]=s.useState(),[Z,O]=s.useState(),[ee,ae]=s.useState(),[b,te]=s.useState(),[se,le]=s.useState(),[re,oe]=s.useState();s.useEffect(()=>{Ee(),De()},[]);const Ee=()=>{i&&f.get(g+"market/groups/dropdown/fetch",{headers:{Authorization:`Bearer ${i}`}}).then(a=>{a.status===200?we(a.data):a.status===500&&r({type:o,payload:{status:!0,title:"Market Group Loading error",message:a.data.message}})}).catch(a=>{console.error("Error: ",a)})},De=()=>{i&&f.get(g+"assistant/market/chains/all",{headers:{Authorization:`Bearer ${i}`}}).then(a=>{a.status===200?ve(a.data):a.status===500&&r({type:o,payload:{status:!0,title:"Chain Loading error",message:a.data.message}})}).catch(a=>{console.error("Error: ",a)})};s.useEffect(()=>{Le()},[M,B,T,j,je]);const Le=()=>{if(y&&i){L(!0);let a=g+`assistant/shoppers/:skip?city=${M}&group=${B}&chain=${T}`;j&&(a+=`&code=${j}`),f.get(a,{headers:{Authorization:`Bearer ${i}`}}).then(t=>{t.status===200?(D(t.data),L(!1),R(!1)):t.status===500&&r({type:o,payload:{status:!0,title:"Error",message:t.data.message,color:"warning"}})}).catch(t=>{console.error("Error:",t)})}},S=a=>{a==="all"?(N(""),H("All Cities")):(N(a),H(a))},ie=(a,t)=>{a==="all"?(I(""),_("All Market Groups")):(I(a),_(t))},ne=(a,t)=>{a==="all"?(G(""),U("All Chains")):(G(a),U(t))},ce=(a,t)=>{C(!A),z(t),F(a)},Me=()=>{const a={status:V};console.log($,a),y&&i&&f.patch(g+"assistant/shopper/status/"+$,a,{headers:{Authorization:`Bearer ${i}`}}).then(t=>{t.status===200?(console.log("updated"),C(!1),z(""),F(""),R(!0),r({type:o,payload:{status:!0,title:"Picker status update",message:"Picker status updated successfully",color:"success"}})):t.status===203?r({type:o,payload:{status:!0,title:"Picker status update error",message:t.data.message}}):t.status===204?r({type:o,payload:{status:!0,title:"Picker status update error",message:t.data.message}}):t.status===500&&r({type:o,payload:{status:!0,title:"Picker status update error",message:t.data.message}})}).catch(t=>{console.error(t)})},Ne=a=>{k(!Y),Ae(a),J(a.name),Q(a.surname),X(a.email),O(a.contact),ae(a.iban),te(a.city),oe(a.address),le(a.vat)},Be=()=>{if(q&&K&&W&&Z&&ee&&b&&se&&re){const a={name:q,surname:K,email:W,contact:Z,iban:ee,city:b,vat:se,address:re},t=d.id;i&&y&&i&&f.patch(g+"assistant/shopper/update/"+t,a,{headers:{Authorization:`Bearer ${i}`}}).then(l=>{if(l.status===200){console.log(l.data),k(!1);const x=l.data,Ie=E.map(de=>de.id===x.id?(console.log("update obj"),x):de);D([...Ie]),r({type:o,payload:{status:!0,title:"Picker update",message:"Picker updated successfully",color:"success"}})}else l.status===203?r({type:o,payload:{status:!0,title:"Picker update error",message:l.data.message,color:"warning"}}):l.status===204?r({type:o,payload:{status:!0,title:"Picker update error",message:l.data.message,color:"warning"}}):l.status===500&&r({type:o,payload:{status:!0,title:"Picker update error",message:l.data.message,color:"warning"}})}).catch(l=>{console.error("Error:",l)})}else r({type:o,payload:{status:!0,title:"Error!",message:"Picker update error, Please Check the input fields",color:"warning"}})};return e.jsxs(ze,{children:[e.jsx(ue,{to:"/picker/addpicker",className:"picker-link",children:e.jsx(m,{style:{marginLeft:"0%",width:"17%",backgroundColor:"#ff4d4d",color:"white"},children:"Add Picker"})}),e.jsx($e,{style:{marginLeft:"20%"},color:"secondary",children:"Filter by"}),e.jsxs(w,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d",color:"white"},children:[e.jsx(P,{style:{color:"white"},children:ye}),e.jsxs(v,{children:[e.jsx(p,{onClick:()=>S("all"),children:"All"}),e.jsx(p,{onClick:()=>S("Milan"),children:"Milan"}),e.jsx(p,{onClick:()=>S("Napoli"),children:"Napoli"})]})]}),e.jsxs(w,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d",color:"white"},children:[e.jsx(P,{style:{color:"white"},children:be}),e.jsxs(v,{children:[e.jsx(p,{onClick:()=>ne("all"),children:"All"}),Pe.map((a,t)=>e.jsx(p,{onClick:()=>ne(a.id,a.name),children:a.name},t))]})]}),e.jsxs(w,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d",color:"white"},children:[e.jsx(P,{style:{color:"white"},children:ke}),e.jsxs(v,{children:[e.jsx(p,{onClick:()=>ie("all"),children:"All"}),Se.map((a,t)=>e.jsx(p,{onClick:()=>ie(a._id,a.name),children:a.name},t))]})]}),e.jsx(Fe,{className:"bg-body-tertiary",children:e.jsx(h,{type:"text",placeholder:"Search by Picker ID",className:"picker-input",value:j,style:{width:450,marginLeft:"0%"},onChange:a=>Ce(a.target.value)})}),ge?e.jsx(Ge,{}):e.jsxs(Re,{children:[e.jsx(He,{children:e.jsxs(he,{children:[e.jsx(n,{scope:"col",children:"Id"}),e.jsx(n,{scope:"col",children:"First Name"}),e.jsx(n,{scope:"col",children:"Last Name"}),e.jsx(n,{scope:"col",children:"Email"}),e.jsx(n,{scope:"col",children:"Phone"}),e.jsx(n,{scope:"col",children:"Country"}),e.jsx(n,{scope:"col",children:"City"}),e.jsx(n,{scope:"col",children:"Language"}),e.jsx(n,{scope:"col",children:"Market"}),e.jsx(n,{scope:"col",children:"Edit"}),e.jsx(n,{scope:"col",children:"Edit Status"})]})}),e.jsx(_e,{children:E.map((a,t)=>{var l,x;return e.jsxs(he,{children:[e.jsx(c,{children:a.code}),e.jsx(c,{children:a.name}),e.jsx(c,{children:a.surname}),e.jsx(c,{children:a.email}),e.jsx(c,{children:a.contact}),e.jsx(c,{children:a.country==="it"||a.country==="Italy"?"Italy":a.country}),e.jsx(c,{children:a.city}),e.jsx(c,{children:a.language==="en"?"English":a.language==="it"?"Italy":a.language==="es"?"Spanish":a.language}),e.jsxs(c,{children:[(x=(l=a.market)==null?void 0:l.chain)==null?void 0:x.name," - ",a.market.address]}),e.jsx(c,{children:e.jsx(ue,{children:e.jsx(Ve,{icon:Ue,size:"xl",onClick:()=>Ne(a)})})}),e.jsx(c,{children:a.activate?e.jsx(m,{size:"sm",onClick:()=>ce(a.id,!1),style:{backgroundColor:"#ff4d4d",width:90,color:"white"},children:"Deactivate"}):e.jsx(m,{size:"sm",onClick:()=>ce(a.id,!0),style:{backgroundColor:"#ff4d4d",width:90,color:"white"},children:"Activate"})})]},t)})})]}),e.jsxs(pe,{alignment:"center",visible:A,scrollable:!0,size:"sm",onClose:()=>C(!1),children:[e.jsx(me,{closeButton:!1,children:e.jsx(xe,{children:"Confirmation"})}),e.jsxs(fe,{children:[e.jsxs("a",{children:["Are you sure you want to ",V?"activate":"deactivate"," this picker?"]}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{style:{display:"flex",justifyContent:"center"},children:[e.jsx(m,{onClick:()=>Me(),style:{backgroundColor:"#ff4d4d",color:"white",marginRight:"10px"},children:"Yes"}),e.jsx(m,{onClick:()=>C(!1),style:{backgroundColor:"#ff4d4d",color:"white",marginLeft:"10px"},children:"No"})]})]})]}),e.jsxs(pe,{visible:Y,scrollable:!0,size:"lg",onClose:()=>k(!1),children:[e.jsx(me,{closeButton:!0,children:e.jsx(xe,{children:"Edit Picker Information"})}),e.jsx(fe,{children:e.jsxs("div",{className:"row g-3",children:[e.jsx(u,{md:6,children:e.jsx(h,{id:"name",label:"Firt Name",defaultValue:d.name,onChange:a=>J(a.target.value)})}),e.jsx(u,{md:6,children:e.jsx(h,{id:"surname",label:"LastName",defaultValue:d.surname,onChange:a=>Q(a.target.value)})}),e.jsx(u,{md:6,children:e.jsx(h,{id:"address",label:"Address",defaultValue:d.address,onChange:a=>oe(a.target.value)})}),e.jsx(u,{md:6,children:e.jsx(h,{id:"email",label:"Email",defaultValue:d.email,onChange:a=>X(a.target.value)})}),e.jsx(u,{md:6,children:e.jsx(h,{id:"phone",label:"Contact Number",defaultValue:d.contact,onChange:a=>O(a.target.value)})}),e.jsx(u,{md:6,children:e.jsx(h,{id:"iban",label:"IBAN",defaultValue:d.iban,onChange:a=>ae(a.target.value)})}),e.jsx(u,{md:6,children:e.jsx(h,{id:"vat",label:"Vat",defaultValue:d.vat,onChange:a=>le(a.target.value)})}),e.jsx(u,{md:6,children:e.jsxs(Ye,{id:"inputState",label:"City",value:b,onChange:a=>te(a.target.value),children:[e.jsx("option",{children:d.city}),e.jsx("option",{children:"Milano"}),e.jsx("option",{children:"Napoli"})]})}),e.jsx(u,{xs:12,children:e.jsx(m,{type:"submit",style:{marginBottom:"3%",width:"200px",backgroundColor:"#ff4d4d",color:"white"},onClick:()=>Be(),children:"Update Picker"})})]})})]})]})};export{oa as default};
