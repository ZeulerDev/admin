import{r,y as ze,l as _e,A as d,j as e,h as ae}from"./index-Bsn8dk4K.js";import{a as M}from"./axios-Cm0UX6qg.js";import{B as b}from"./config-CAsDK75y.js";import{b as Qe,a as te}from"./CContainer-AV4JspaL.js";import{C as _}from"./CNavbar-5ERL6Uil.js";import{a as m,b as C,d as y,e as n,C as re}from"./DefaultLayout-FA2rmZWX.js";import{C as He}from"./CFormInput--iaGGot-.js";import{C as le,a as oe,b as G,c as o,d as ie,e as i}from"./CTable-CwbSrcrF.js";import{C as Ue}from"./CCardImage-QNsgrsKa.js";import{C as ne,a as A}from"./CPaginationItem-TLWytmzh.js";import"./CFormLabel-iOJk5yzm.js";const ts=()=>{const[t,$]=r.useState("all"),[{user:v,token:h},c]=ze(),[Q,p]=r.useState(!1),[Ae,Pe]=r.useState([]),[x,H]=r.useState(0),[U,g]=r.useState(!0),[ce,Se]=r.useState([]),[de,L]=r.useState("All Chains"),[q,P]=r.useState("All market"),[he,D]=r.useState(""),[ue,f]=r.useState(""),[pe,E]=r.useState([]),[j,k]=r.useState(""),[Ge,xe]=r.useState(j);r.useState(!1),r.useState(""),r.useState(""),r.useState("");const[ge,fe]=r.useState(0),[B,J]=r.useState(1),Le=_e(),[De,F]=r.useState(!1),[Ne,qe]=r.useState(""),[we,Te]=r.useState([]),[$e,je]=r.useState("All MarketGroups"),[K,O]=r.useState("All Markets in Group"),[ve,ke]=r.useState([]),[V,me]=r.useState(""),[Ce,ye]=r.useState("All Cities"),[Ee,Be]=r.useState([]);r.useEffect(()=>{De&&(t==="Market"?w(0):t==="Market Group"&&T(0))},[v,V,he]),r.useEffect(()=>{t==="Product"&&v&&h&&N(0)},[v,h,ue,Ge]),r.useEffect(()=>{if(t==="Product"){const s=setTimeout(()=>{(j.length>=3||j.length===0)&&xe(j)},500);return()=>{clearTimeout(s)}}},[j]);const I=s=>{D(""),L("All Chains"),f(""),P("All Markets"),s==="all"?($("All"),F(!1)):s==="Product"?(N(0),Me(),$(s),Re(),F(!0)):s==="Market"?(w(0),Me(),$(s),F(!0)):s==="Market Group"&&(T(0),$(s),F(!0))},N=(s,a)=>{p(!0),M.get(b+`product/all/${s}?marketId=${ue}&name=${j}`,{headers:{Authorization:`Bearer ${h}`}}).then(l=>{l.status===200?(Pe(l.data.list),fe(l.data.count),p(!1),l.data.list.length<20?(g(!0),console.log("ok")):l.data.list.length>19&&g(!1)):l.status===203?(p(!1),c({type:d,payload:{status:!0,title:"product loading error error",message:l.data.message}})):l.status===204?(p(!1),c({type:d,payload:{status:!0,title:"No Products",message:"No products found in this market address",color:"info"}})):l.status===500&&(p(!1),c({type:d,payload:{status:!0,title:"product loading error error",message:l.data.message}}))}).catch(l=>{p(!1),console.error("Error:",l)})},Me=()=>{h&&M.get(b+"assistant/market/chains/all",{headers:{Authorization:`Bearer ${h}`}}).then(s=>{s.status===200?Se(s.data):s.status===500&&c({type:d,payload:{status:!0,title:"Chain Loading error",message:s.data.message}})}).catch(s=>{console.error("Error: ",s)})},R=(s,a)=>{s==="all"?(D(""),L("All Chains"),f(""),P("All Markets"),k("")):(k(""),f(""),P("All Markets"),D(s),t==="Product"&&Fe(s),L(a))},Fe=s=>{M.get(b+`assistant/market/locations?brand=${s}`,{headers:{Authorization:`Bearer ${h}`}}).then(a=>{a.status===200?(E(a.data.data),a.data.data.length<20?(g(!0),console.log("ok")):a.data.data.length>19&&g(!1)):a.status===500&&c({type:d,payload:{status:!0,title:"Market Loading error",message:a.data.message}})}).catch(a=>{console.error("Error: ",a)})},W=(s,a)=>{s==="all"?(f(""),P("All Markets"),D(""),L("All Chains"),E([]),k("")):s==="group"?(f(a.marketId),O(`${a.chainName}- ${a.marketAddress}`),k("")):(f(s),P(a),k(""))},Ie=s=>{J(s);let a;t==="Product"?a=(s-1)*50:(t==="Market"||t==="Market Group")&&(a=(s-1)*20),H(a),t==="Product"?N(a):t==="Market"?w(a):t==="Market Group"&&T(a)},be=()=>{let s;t==="Product"?s=Math.ceil(ge/50):(t==="Market"||t==="Market Group")&&(s=Math.ceil(ge/20));const a=[];for(let u=1;u<=s;u++)a.push(u);const l=Math.max(B-2,1),z=Math.min(l+4,s);return a.slice(l-1,z).map(u=>e.jsx(A,{active:B===u,onClick:()=>Ie(u),children:u},u))},X=()=>{J(B+1);let s;t==="Product"?s=x+50:(t==="Market"||t==="Market Group")&&(s=x+20),H(s),t==="Product"?N(s):t==="Market"?w(s):t==="Market Group"&&T(s)},Y=()=>{J(B-1);let s;t==="Product"?s=x-50:(t==="Market"||t==="Market Group")&&(s=x-20),H(s),t==="Product"?N(s):t==="Market"?w(s):t==="Market Group"&&T(s)},Re=()=>{M.get(b+"market/group/all",{headers:{Authorization:`Bearer ${h}`}}).then(s=>{s.status===200?Te(s.data):s.status===500&&c({type:d,payload:{status:!0,title:"MarketGroup Loading error",message:s.data.message}})}).catch(s=>{console.error("Error: ",s),c({type:d,payload:{status:!0,title:"MarketGroup Loading error",message:res.data.message}})})},Z=(s,a)=>{s==="all"?(f(""),P("All Markets"),D(""),L("All Chains"),E([]),k(""),ke([]),je("All MarketGroups"),O("All Markets in Group")):(f(""),O("All Markets in Group"),k(""),je(a.name),ke(a.market))},S=s=>{s==="all"?(me(""),ye("All Cities")):(me(s),ye(s))},w=s=>{p(!0),M.get(b+`assistant/market/locations/${s}?brand=${he}&city=${V}`,{headers:{Authorization:`Bearer ${h}`}}).then(a=>{a.status===200?(E(a.data.data),fe(a.data.count),p(!1),a.data.data.length<20?(g(!0),console.log("ok")):a.data.data.length>19&&g(!1)):a.status===500&&c({type:d,payload:{status:!0,title:"Market Loading error",message:a.data.message}})}).catch(a=>{console.error("Error: ",a)})},T=s=>{p(!0),M.get(b+`market/groups/fetch/${s}?city=${V}`,{headers:{Authorization:`Bearer ${h}`}}).then(a=>{console.log(a.status),a.status===200?(Be(a.data),p(!1),a.data.length<20?(g(!0),console.log("ok")):a.data.length>19&&g(!1)):a.status===500&&c({type:d,payload:{status:!0,title:"Makrket Group loading error",message:a.data.message}})}).catch(a=>{console.error("Error:",a)})},ee=s=>{if(console.log(t,Ne),t&&s){const a={type:t,id:s};console.log(a),v&&h&&M.post(b+"deepLink/urls/create",a,{headers:{Authorization:`Bearer ${h}`}}).then(l=>{l.status===200?(c({type:d,payload:{status:!0,title:"Link Registration",message:"Link Registration Success",color:"success"}}),Le("/marketing/all")):l.status===400?c({type:d,payload:{status:!0,title:"Link Registration error",message:"Link Registration Failed",color:"info"}}):l.status===500&&c({type:d,payload:{status:!0,title:"Link Registration error",message:l.data.message}})}).catch(l=>{console.error("Error:",l)})}else alert("Please Check the Fields!")};return e.jsxs(Qe,{children:[e.jsx(_,{style:{marginTop:"1%"},className:"bg-body-tertiary",children:e.jsxs(m,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[e.jsx(C,{style:{color:"white"},children:t}),e.jsxs(y,{children:[e.jsx(n,{onClick:()=>I("all"),children:"All"}),e.jsx(n,{onClick:()=>I("Product"),children:"Product"}),e.jsx(n,{onClick:()=>I("Market"),children:"Market"}),e.jsx(n,{onClick:()=>I("Market Group"),children:"Market Group"})]})]})}),t==="all"&&e.jsx("h1",{}),t==="Product"&&e.jsxs(e.Fragment,{children:[e.jsx(re,{style:{marginLeft:"40%"},color:"secondary",children:"Filter by"}),e.jsxs(m,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[e.jsx(C,{children:$e}),e.jsxs(y,{children:[e.jsx(n,{onClick:()=>Z("all"),children:"All"}),we.map((s,a)=>e.jsx(n,{onClick:()=>{Z(s.id,s)},children:s.name},a))]})]}),e.jsxs(m,{style:{marginLeft:"2%",width:"21%",backgroundColor:"#ff4d4d"},children:[e.jsxs(C,{children:["   ",K.length>20?`${K.substring(0,20)}...`:K]}),e.jsxs(y,{children:[e.jsx(n,{onClick:()=>Z("all"),children:"All"}),ve.map((s,a)=>e.jsxs(n,{onClick:()=>{W("group",s)},children:[s.chainName," - ",s.marketAddress]},a))]})]}),e.jsxs(m,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[e.jsx(C,{children:de}),e.jsxs(y,{children:[e.jsx(n,{onClick:()=>R("all"),children:"All"}),ce.map((s,a)=>e.jsx(n,{onClick:()=>R(s.id,s.name),children:s.name},a))]})]}),e.jsxs(m,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[e.jsx(C,{children:q.length>15?`${q.substring(0,15)}...`:q}),e.jsxs(y,{children:[e.jsx(n,{onClick:()=>W("all"),children:"Select the Chain"}),pe.map((s,a)=>e.jsx(n,{onClick:()=>W(s._id,s.address),children:e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{children:s.address.substring(0,s.address.length/2)}),e.jsx("span",{children:s.address.substring(s.address.length/2)})]})},a))]})]}),e.jsx(_,{style:{marginTop:"1%"},className:"bg-body-tertiary",children:e.jsx(He,{type:"text",placeholder:"Search products by name, brand name and product id",style:{width:450,marginRight:"60%"},value:j,onChange:s=>k(s.target.value)})}),Q?e.jsx(ae,{}):e.jsxs(le,{children:[e.jsx(oe,{children:e.jsxs(G,{children:[e.jsx(o,{scope:"col",children:"#"}),e.jsx(o,{scope:"col",children:"Product Id"}),e.jsx(o,{scope:"col",children:"Photo"}),e.jsx(o,{scope:"col",children:"Name"}),e.jsx(o,{scope:"col",children:"Base Price"}),e.jsx(o,{scope:"col",children:"Tax"}),e.jsx(o,{scope:"col",children:"Markup Percentage "}),e.jsx(o,{scope:"col",children:"Markup"}),e.jsx(o,{scope:"col",children:"Total"}),e.jsx(o,{scope:"col",children:"Brand"}),e.jsx(o,{scope:"col",children:"Chain"}),e.jsx(o,{scope:"col",children:"Market Address"}),e.jsx(o,{scope:"col",children:"Add Link"})]})}),e.jsx(ie,{children:Ae.map((s,a)=>{var l,z,se,u;return e.jsxs(G,{children:[e.jsx(i,{children:x+a+1}),e.jsx(i,{children:s.pid}),e.jsx(o,{children:e.jsx(Ue,{style:{width:"50px",height:"50px"},src:"https://api.zeuler.com/image/"+s.image})}),e.jsx(i,{children:s.name}),e.jsx(i,{children:(((l=s.price)==null?void 0:l.basePrice)??0).toFixed(2)}),e.jsx(i,{children:(((z=s.price)==null?void 0:z.tax)??0).toFixed(2)}),e.jsxs(i,{children:[s.price.percentage,"%"]}),e.jsx(i,{children:(((se=s.price)==null?void 0:se.markup)??0).toFixed(2)}),e.jsx(i,{children:(((u=s.price)==null?void 0:u.total)??0).toFixed(2)}),e.jsx(i,{children:s.brand}),e.jsx(i,{children:s.chainName}),e.jsx(i,{children:s.marketAddress}),e.jsx(i,{children:e.jsx(te,{size:"sm",style:{backgroundColor:"#ff4d4d",marginLeft:"5px",color:"white"},variant:"outline",onClick:()=>{ee(s.productId)},children:"Add"})})]},a)})})]}),e.jsxs(ne,{"aria-label":"Page navigation example",children:[e.jsx(A,{disabled:x<=0,onClick:Y,children:"Previous"}),be(),e.jsx(A,{disabled:U===!0,onClick:X,children:"Next"})]})]}),t==="Market"&&e.jsxs(e.Fragment,{children:[e.jsx(re,{style:{marginLeft:"57%"},color:"secondary",children:"Filter by"}),e.jsxs(m,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[e.jsx(C,{style:{color:"white"},children:Ce}),e.jsxs(y,{children:[e.jsx(n,{onClick:()=>S("all"),children:"All"}),e.jsx(n,{onClick:()=>S("Milano"),children:"Milano"}),e.jsx(n,{onClick:()=>S("Napoli"),children:"Napoli"})]})]}),e.jsxs(m,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[e.jsx(C,{style:{color:"white"},children:de}),e.jsxs(y,{children:[e.jsx(n,{onClick:()=>R("all"),children:"All"}),ce.map((s,a)=>e.jsx(n,{onClick:()=>R(s.id,s.name),children:s.name},a))]})]}),e.jsx(_,{style:{marginTop:"1%"},className:"bg-body-tertiary"}),Q?e.jsx(ae,{}):e.jsxs(le,{children:[e.jsx(oe,{children:e.jsxs(G,{children:[e.jsx(o,{scope:"col",children:"#"}),e.jsx(o,{scope:"col",children:"Name"}),e.jsx(o,{scope:"col",children:"Address"}),e.jsx(o,{scope:"col",children:"City"}),e.jsx(o,{scope:"col",children:"Scraped"}),e.jsx(o,{scope:"col",children:"Add Link"})]})}),e.jsx(ie,{children:pe.map((s,a)=>{var l;return e.jsxs(G,{children:[e.jsx(i,{children:x+a+1}),e.jsx(i,{children:(l=s.chain)==null?void 0:l.name}),e.jsx(i,{children:s.address}),e.jsx(i,{children:s.city}),e.jsx(i,{children:s.scraped}),e.jsx(i,{children:e.jsx(te,{size:"sm",style:{backgroundColor:"#ff4d4d",marginLeft:"5px",color:"white"},variant:"outline",onClick:()=>{ee(s._id)},children:"Add"})})]},a)})})]}),e.jsxs(ne,{"aria-label":"Page navigation example",children:[e.jsx(A,{disabled:x<=0,onClick:Y,children:"Previous"}),be(),e.jsx(A,{disabled:U===!0,onClick:X,children:"Next"})]})]}),t==="Market Group"&&e.jsxs(e.Fragment,{children:[e.jsx(re,{style:{marginLeft:"75%",marginTop:"2%"},color:"secondary",children:"Filter by"}),e.jsxs(m,{style:{marginLeft:"2%",width:"17%",marginRight:"5px",backgroundColor:"#ff4d4d"},children:[e.jsx(C,{style:{color:"white"},children:Ce}),e.jsxs(y,{children:[e.jsx(n,{onClick:()=>S("all"),children:"All"}),e.jsx(n,{onClick:()=>S("Milano"),children:"Milano"}),e.jsx(n,{onClick:()=>S("Napoli"),children:"Napoli"})]})]}),e.jsx(_,{style:{marginTop:"1%"},className:"bg-body-tertiary"}),Q?e.jsx(ae,{}):e.jsxs(le,{children:[e.jsx(oe,{children:e.jsxs(G,{children:[e.jsx(o,{scope:"col",children:"#"}),e.jsx(o,{scope:"col",children:"Name"}),e.jsx(o,{scope:"col",children:"City"}),e.jsx(o,{scope:"col",children:"Add Link"})]})}),e.jsx(ie,{children:Ee.map((s,a)=>e.jsxs(G,{children:[e.jsx(i,{children:x+a+1}),e.jsx(i,{children:e.jsx("span",{children:s.name})}),e.jsx(i,{children:s.city}),e.jsx(i,{children:e.jsx(te,{onClick:()=>{ee(s._id)},size:"sm",style:{backgroundColor:"#ff4d4d",marginLeft:"5px",color:"white"},children:"Add"})})]},a))})]}),e.jsxs(ne,{"aria-label":"Page navigation example",children:[e.jsx(A,{disabled:x<=0,onClick:Y,children:"Previous"}),e.jsx(A,{disabled:U===!0,onClick:X,children:"Next"})]})]})]})};export{ts as default};
