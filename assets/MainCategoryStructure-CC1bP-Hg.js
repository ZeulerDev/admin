import{y as ne,r as l,A as r,j as e,h as ce,m as de}from"./index-UGMi1yYD.js";import{a as h}from"./axios-Cm0UX6qg.js";import{B as C}from"./config-HOLfLxHr.js";import{b as ue,a as d}from"./CContainer-DyKYeaQQ.js";import{C as ge}from"./CNavbar-CJm5RN47.js";import{C as he}from"./DefaultLayout-CzLgNllg.js";import{C as v,a as k,b as D,c as E}from"./CModalTitle-Cj2x-Lbp.js";import{C as $}from"./CFormInput-CxPGKAGO.js";import{C as R}from"./CModalFooter-iKJhetg6.js";import{C as Ce}from"./CRow-Ng7ko5ri.js";import{C as I}from"./CCol-BiiKwAZ6.js";import{C as fe}from"./CFormCheck-DWnq40RE.js";import{C as F,a as V,b as u,c as f,d as H,e as n}from"./CTable-Bh49LxGZ.js";import{c as me}from"./cil-view-module-CSS15w8m.js";import"./CFormLabel-CaVfy1Ba.js";const Ne=()=>{const[{user:A,token:i},s]=ne(),[U,B]=l.useState(!1),[_,T]=l.useState(!1),[ye,c]=l.useState(!1),[pe,z]=l.useState(!0),[O,p]=l.useState(!1),[xe,W]=l.useState("All Main Categories"),[x,j]=l.useState(""),[Y,q]=l.useState([]),[G,J]=l.useState(""),[K,b]=l.useState(!1),[m,w]=l.useState(""),[M,S]=l.useState(""),[L,Q]=l.useState([]),[y,X]=l.useState([]);l.useEffect(()=>{N(),le()},[]);const N=()=>{i&&h.get(C+"product/categories",{headers:{Authorization:`Bearer ${i}`}}).then(t=>{t.status===200?(console.log(t.data[1]),q(t.data)):t.status===500&&s({type:r,payload:{status:!0,title:"Main Category Loading error",message:"Main Category loading error"}})}).catch(t=>{console.error("Error: ",t)})},Z=(t,o,a)=>{a==="move2"&&(console.log("index",t,o,a),t==="all"||(console.log("index",t,o,a),j(t),W(o),J(t)))},ee=()=>{console.log("save",x),M&&x!==""?(p(!1),P({subName:M,index:x},"sub")):s({type:r,payload:{status:!0,title:"Check the fields",message:"Please check the fields",color:"warning"}})},te=(t,o)=>{c(!0),h.get(C+`product/category/${t}?ids=${o}`,{headers:{Authorization:`Bearer ${i}`}}).then(a=>{a.status===200?(setProductData(a.data.list),console.log(a.data.list.length),setResultCount(a.data.count),c(!1),a.data.list.length<50?(z(!0),console.log("ok")):a.data.list.length>50&&z(!1)):a.status===203?(c(!1),s({type:r,payload:{status:!0,title:"product loading error error",message:a.data.message}})):a.status===204?(c(!1),s({type:r,payload:{status:!0,title:"No Products",message:"No products found in this market address",color:"info"}})):a.status===500&&(c(!1),s({type:r,payload:{status:!0,title:"product loading error error",message:a.data.message}}))}).catch(a=>{c(!1),console.error("Error:",a)})},ae=()=>{b(!0)},oe=()=>{p(!0)},se=()=>{m?(console.log(m),P({name:m},"main"),b(!1)):s({type:r,payload:{status:!0,title:"Check the fields",message:"Please check the fields",color:"warning"}})},P=(t,o)=>{if(t&&o){let a;o==="main"?a={name:t.name}:o==="sub"&&(a={name:t.subName,index:t.index}),i&&h.post(C+"product/category/add",a,{headers:{Authorization:`Bearer ${i}`}}).then(g=>{g.status===200?(s({type:r,payload:{status:!0,title:"Category Registration",message:"Category Registration Success",color:"success"}}),w(""),S(""),j(""),N()):g.status===400?s({type:r,payload:{status:!0,title:"Category Registration error",message:"Category Registration error",color:"warning"}}):g.status===500&&s({type:r,payload:{status:!0,title:"Category Registration error",message:"Category Registration error 500",color:"warning"}})}).catch(g=>{console.error("Error:",g)})}else s({type:r,payload:{status:!0,title:"Error!",message:" error, Please Check the input fields",color:"warning"}})},re=()=>{A&&i&&h.get(C+"product/categories/download",{headers:{Authorization:`Bearer ${i}`},responseType:"blob"}).then(t=>{if(t.status===200){const o=window.URL.createObjectURL(new Blob([t.data])),a=document.createElement("a");a.href=o,a.setAttribute("download","category.json"),document.body.appendChild(a),a.click(),a.remove(),s({type:r,payload:{status:!0,title:"Download file ",message:"Download file success",color:"success"}}),te(0,!0)}else t.status===500&&s({type:r,payload:{status:!0,title:"Download file ",message:"Download file error",color:"danger"}})}).catch(t=>{console.error("Error:",t)})},le=()=>{A&&i?(B(!0),h.get(C+"product/list/categories",{headers:{Authorization:`Bearer ${i}`}}).then(t=>{t.status===200?(console.log(t.data),Q(t.data),B(!1)):t.status===204?s({type:r,payload:{status:!0,title:"Error!",message:" error",color:"warning"}}):t.status===500&&s({type:r,payload:{status:!0,title:"Error!",message:" error",color:"warning"}})}).catch(t=>{s({type:r,payload:{status:!0,title:"Error!",message:" error",color:"warning"}})})):s({type:r,payload:{status:!0,title:"Error!",message:" error",color:"warning"}})},ie=t=>{T(!0),X(t)};return e.jsxs(ue,{children:[e.jsxs(ge,{style:{justifyContent:"flex-start"},className:"bg-body-tertiary",children:[e.jsx(he,{style:{marginLeft:"0.2%"},color:"secondary",children:"Download Category file"}),e.jsx(d,{style:{backgroundColor:"#ff4d4d",color:"white",marginLeft:"0.5%"},onClick:()=>{re()},children:"Download File"}),e.jsx(d,{onClick:()=>{ae()},style:{backgroundColor:"#ff4d4d",width:"17%",color:"white",marginLeft:"41%"},children:"Add Main Category"}),e.jsx(d,{onClick:()=>{oe()},style:{backgroundColor:"#ff4d4d",width:"17%",color:"white",marginLeft:5},children:"Add Sub Category"})]}),e.jsxs(v,{alignment:"center",visible:K,scrollable:!0,size:"sm",onClose:()=>{b(!1),w("")},children:[e.jsx(k,{closeButton:!0,children:e.jsx(D,{children:"Category Registration"})}),e.jsx(E,{children:e.jsx($,{type:"text",placeholder:"Enter Category Name",value:m,onChange:t=>w(t.target.value)})}),e.jsx(R,{children:e.jsx(d,{style:{backgroundColor:"#ff4d4d",color:"white"},onClick:()=>{se()},children:"Save"})})]}),e.jsxs(v,{alignment:"center",visible:O,scrollable:!0,size:"lg",onClose:()=>{j(""),S(""),p(!1)},children:[e.jsx(k,{closeButton:!0,children:e.jsx(D,{children:"Add Sub Category"})}),e.jsx(E,{children:e.jsxs(Ce,{children:[e.jsxs(I,{md:6,children:[e.jsx("a",{style:{fontSize:17,fontWeight:"bold"},children:"Select the Main Category"}),e.jsx("br",{}),e.jsx("br",{}),Y.map((t,o)=>e.jsx(fe,{onChange:()=>Z(o,t,"move2"),type:"radio",name:"mainCategoryRadio",id:`flexRadioDefault${o}`,label:t,checked:G===o},o))]}),e.jsx(I,{md:6,children:e.jsx($,{type:"text",placeholder:"Enter Subcategory Name",value:M,onChange:t=>S(t.target.value)})})]})}),e.jsx(R,{children:e.jsx(d,{style:{backgroundColor:"#ff4d4d",color:"white"},onClick:()=>{ee()},children:"Save"})})]}),U?e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(ce,{style:{marginTop:"15%"}})}):e.jsxs(F,{children:[e.jsx(V,{children:e.jsxs(u,{children:[e.jsx(f,{scope:"col",children:"#"}),e.jsx(f,{scope:"col",children:"Main Category"}),e.jsx(f,{scope:"col",children:"View Sub Categories"})]})}),e.jsx(H,{children:L.length===0?e.jsx(u,{children:e.jsx(n,{colSpan:"3",style:{textAlign:"center",backgroundColor:"white"},children:e.jsx("h6",{style:{marginTop:"1%"},children:"No Data"})})}):L.map((t,o)=>e.jsxs(u,{children:[e.jsx(n,{children:o+1}),e.jsx(n,{children:t.mainCategory}),e.jsx(n,{children:e.jsx(d,{size:"sm",style:{backgroundColor:"#ff4d4d"},variant:"outline",onClick:()=>{ie(t.subCategories)},children:e.jsx(de,{icon:me,size:"lg",style:{color:"white"}})})})]},o))})]}),e.jsxs(v,{visible:_,scrollable:!0,size:"sm",onClose:()=>T(!1),children:[e.jsx(k,{closeButton:!0,children:e.jsx(D,{children:"SubCategories Information"})}),e.jsx(E,{style:{overflowY:"auto",maxHeight:"70vh",display:"flex",justifyContent:"center"},children:e.jsxs(F,{children:[e.jsx(V,{children:e.jsxs(u,{children:[e.jsx(f,{scope:"col",children:"#"}),e.jsx(f,{scope:"col",children:"SubCategory"})]})}),e.jsx(H,{children:y.length===0?e.jsx(u,{children:e.jsx(n,{colSpan:"2",style:{textAlign:"center",backgroundColor:"white"},children:e.jsx("h6",{style:{marginTop:"1%"},children:"No Data"})})}):y==null?void 0:y.map((t,o)=>e.jsxs(u,{children:[e.jsx(n,{children:o+1}),e.jsx(n,{children:t})]},o))})]})}),e.jsx(R,{})]})]})};export{Ne as default};
