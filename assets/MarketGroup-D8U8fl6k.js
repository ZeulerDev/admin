import{y as re,r as o,A as l,j as e,L as h,h as le,m as z}from"./index-2UiVSbIS.js";import{a as y}from"./axios-Cm0UX6qg.js";import{B as k}from"./config-HOLfLxHr.js";import{b as ie,a as i}from"./CContainer-QGXm_a0L.js";import{d as ne,C as ce,a as de,b as ue,c as b}from"./DefaultLayout-oQJ26O-o.js";import{C as pe}from"./CNavbar-BuZsxQYb.js";import{C as me,a as he,b as I,c,d as ge,e as d}from"./CTable-B41WUt8L.js";import{c as fe}from"./cil-pencil-m516yCOw.js";import{c as xe}from"./cil-trash-CBbKHhHb.js";import{C as Ce,a as R}from"./CPaginationItem-BvxTkyVW.js";import{C as $,a as _,b as F,c as H}from"./CModalTitle-DYpZU8Ub.js";import{C as je}from"./CFormInput-BbRIteMK.js";import{C as ye}from"./CModalFooter-w-vDWW5a.js";import"./CFormLabel-BOp-dnm4.js";const Be=()=>{const[{user:g,token:n},r]=re(),[M,w]=o.useState(""),[U,D]=o.useState("All Cities"),[f,N]=o.useState([]),[x,S]=o.useState(0),[V,P]=o.useState(!0),[Y,v]=o.useState(!1),[G,u]=o.useState(!1),[q,J]=o.useState(""),[K,C]=o.useState(!1),[O,A]=o.useState(""),[p,T]=o.useState(""),[Q,L]=o.useState(""),j=t=>{t==="all"?(w(""),D("All Cities")):(w(t),D(t))};o.useEffect(()=>{g&&n&&m(0)},[g,M]);const m=(t,s)=>{v(!0),y.get(k+`market/groups/fetch/${t}?city=${M}`,{headers:{Authorization:`Bearer ${n}`}}).then(a=>{console.log(a.status),a.status===200?(N(a.data),v(!1),a.data.length<20?(P(!0),console.log("ok")):a.data.length>19&&P(!1)):a.status===500&&r({type:l,payload:{status:!0,title:"Makrket Group loading error",message:a.data.message}})}).catch(a=>{console.error("Error:",a)})},W=()=>{const t=x+20;S(t),m(t)},X=()=>{const t=x-20;console.log(t),S(t),m(t)},Z=t=>{u(!G),J(t)},ee=t=>{console.log(t),y.delete(k+"marketgroup/"+t,{headers:{Authorization:`Bearer ${n}`}}).then(s=>{s.status===200?(r({type:l,payload:{status:!0,title:"Market Group Delete",message:"Market Group Delete Success",color:"success"}}),u(!1),m(0),console.log("Remove Market Group")):s.status===203?r({type:l,payload:{status:!0,title:"Market Group Delete",message:s.data.message,color:"warning"}}):s.status===404?r({type:l,payload:{status:!0,title:"Market Group Delete",message:s.data.message,color:"warning"}}):s.status===500&&r({type:l,payload:{status:!0,title:"Market Group Delete",message:s.data.message,color:"warning"}})}).catch(s=>{console.error("Error:",s)})},te=(t,s)=>{C(!0),A(t),L(s),console.log(s)},se=()=>{console.log("name",p),p==""?r({type:l,payload:{status:!0,title:"Alert",message:"Please Enter Name",color:"danger"}}):ae(O)},ae=t=>{if(t){let s={name:p};console.log(s,t),g&&n&&y.put(k+"marketgroup/update/"+t,s,{headers:{Authorization:`Bearer ${n}`}}).then(a=>{if(a.status===200){const E=a.data,B=f.find(oe=>oe.id===E.id);B&&(B.name=E.name),N([...f]),r({type:l,payload:{status:!0,title:"Market Group Update",message:"Market group name updated successfully",color:"success"}}),A(""),T(""),C(!1),L("")}else a.status===204?r({type:l,payload:{status:!0,title:"Pick up area update  error",message:a.data.message,color:"danger"}}):a.status===500&&r({type:l,payload:{status:!0,title:"Pick up area update  error",message:a.data.message,color:"danger"}})}).catch(a=>{console.error("Error:",a)})}else alert("Please Check the Fields!")};return e.jsxs(ie,{children:[e.jsx(h,{to:"/marketgroups/marketmap",children:e.jsx(i,{style:{marginLeft:"0%",width:"17%",backgroundColor:"#ff4d4d",color:"white"},children:"Add Market"})}),e.jsx(h,{to:"/marketgroups/createmarketgroup",children:e.jsx(i,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d",color:"white"},children:"Create Market Group"})}),e.jsx(ne,{style:{marginLeft:"39%"},color:"secondary",children:"Filter by"}),e.jsxs(ce,{style:{marginLeft:"2%",width:"17%",marginRight:"5px",backgroundColor:"#ff4d4d"},children:[e.jsx(de,{style:{color:"white"},children:U}),e.jsxs(ue,{children:[e.jsx(b,{onClick:()=>j("all"),children:"All"}),e.jsx(b,{onClick:()=>j("Milano"),children:"Milano"}),e.jsx(b,{onClick:()=>j("Napoli"),children:"Napoli"})]})]}),e.jsx(pe,{style:{marginTop:"1%"},className:"bg-body-tertiary"}),Y?e.jsx(le,{}):e.jsxs(me,{children:[e.jsx(he,{children:e.jsxs(I,{children:[e.jsx(c,{scope:"col",children:"#"}),e.jsx(c,{scope:"col",children:"Name"}),e.jsx(c,{scope:"col",children:"City"}),e.jsx(c,{scope:"col",children:"Location"}),e.jsx(c,{scope:"col",children:"Action"})]})}),e.jsx(ge,{children:f.map((t,s)=>e.jsxs(I,{children:[e.jsx(d,{children:s+1}),e.jsxs(d,{children:[e.jsx("span",{children:t.name}),e.jsx(h,{to:"",children:e.jsx(z,{style:{marginLeft:20,float:"right"},icon:fe,size:"sm",onClick:()=>te(t._id,t.name)})})]}),e.jsx(d,{children:t.city}),e.jsx(d,{children:e.jsx(h,{to:`/marketgroups/marketdistance/${t._id}`,children:e.jsx(i,{size:"sm",style:{backgroundColor:"#ff4d4d",marginLeft:"5px",color:"white"},children:"view"})})}),e.jsx(d,{children:e.jsx(i,{size:"sm",style:{backgroundColor:"#ff4d4d"},variant:"outline",onClick:()=>Z(t._id),children:e.jsx(z,{icon:xe,size:"lg",style:{color:"white"}})})})]},s))})]}),e.jsxs(Ce,{"aria-label":"Page navigation example",children:[e.jsx(R,{disabled:x<=0,onClick:X,children:"Previous"}),e.jsx(R,{disabled:V===!0,onClick:W,children:"Next"})]}),e.jsxs($,{alignment:"center",visible:K,scrollable:!0,size:"sm",onClose:()=>C(!1),children:[e.jsx(_,{closeButton:!0,children:e.jsx(F,{children:"Change Name"})}),e.jsxs(H,{children:[e.jsx("a",{children:"Enter New Name"}),e.jsx("br",{}),e.jsx(je,{type:"text",placeholder:Q,value:p,onChange:t=>T(t.target.value)})]}),e.jsx(ye,{children:e.jsx(i,{style:{backgroundColor:"#ff4d4d",color:"white"},onClick:()=>se(),children:"Save changes"})})]}),e.jsxs($,{alignment:"center",visible:G,scrollable:!0,size:"sm",onClose:()=>u(!1),children:[e.jsx(_,{closeButton:!1,children:e.jsx(F,{children:"Confirmation"})}),e.jsxs(H,{children:[e.jsx("a",{children:"Are you sure you want to delete this market group?"}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{style:{display:"flex",justifyContent:"center"},children:[e.jsx(i,{onClick:()=>ee(q),style:{backgroundColor:"#ff4d4d",color:"white",marginRight:"10px"},children:"Yes"}),e.jsx(i,{onClick:()=>u(!1),style:{backgroundColor:"#ff4d4d",color:"white",marginLeft:"10px"},children:"No"})]})]})]})]})};export{Be as default};
