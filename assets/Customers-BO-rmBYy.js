import{r,y as Te,l as De,A as d,j as e,h as ee,L as z,m as H}from"./index-Dbmmp1pN.js";import{a as V}from"./axios-Cm0UX6qg.js";import{B as v}from"./config-HOLfLxHr.js";import{b as Be,a as Le}from"./CContainer-CHnXGJZP.js";import{C as ze}from"./CNavbar-Bn5ATqBf.js";import{C as x}from"./CFormInput-DKq9UUOY.js";import{C as se,a as te,b as A,c as l,d as ae,e as n}from"./CTable-B02mgyZE.js";import{C as He}from"./CCardImage-DfVcvsuW.js";import{c as Ve}from"./cil-pencil-m516yCOw.js";import{c as Re}from"./cil-info-CmGCY32x.js";import{C as re,a as h}from"./CPaginationItem-Dt4yIReE.js";import{C as oe,a as le,b as ne,c as ce}from"./CModalTitle-C9pipbB8.js";import{C as $e}from"./CModalFooter-B35mEgao.js";import{C as g}from"./CCol-Bug9unDg.js";import"./CFormLabel-CxJVIGYW.js";import"./DefaultLayout-JZ1jsQfJ.js";var Fe=["512 512","<rect width='288' height='32' x='112' y='152' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='288' height='32' x='112' y='240' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='152' height='32' x='112' y='328' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M480,48H32V464H480ZM448,432H64V80H448Z' class='ci-primary'/>"];const rs=()=>{const[R,$]=r.useState(!1),[{user:N,token:c},i]=Te();De();const[F,_]=r.useState([]),[ie,de]=r.useState([]);r.useState(!1);const[ue,U]=r.useState(!1),[he,I]=r.useState(!1),[p,E]=r.useState(0),[Q,w]=r.useState(!1),[m,me]=r.useState([]),[Z,G]=r.useState(),[Y,q]=r.useState(),[J,K]=r.useState(),[W,X]=r.useState(),[M,xe]=r.useState(""),[ge,O]=r.useState(!0),[pe,je]=r.useState(0),[j,k]=r.useState(1),[C,f]=r.useState(0),[y,b]=r.useState(1),[Ce,fe]=r.useState(0),[ye,T]=r.useState(!0),[D,B]=r.useState("");r.useEffect(()=>{const s=setTimeout(()=>{i({type:d,payload:{status:!0,title:"Data Loading",message:"Data loading error: Timeout exceeded",color:"warning"}}),I(!1)},2e4);return N&&c&&P(0,s),()=>{clearTimeout(s)}},[N,c,M]);const P=(s,a)=>{I(!0),V.get(v+"assistant/customers/"+s+"?email="+M,{headers:{Authorization:`Bearer ${c}`}}).then(t=>{t.status===200?(_(t.data.list),je(t.data.count),I(!1),clearTimeout(a),console.log(v),t.data.list.length<50?(O(!0),console.log("ok")):t.data.list.length>49&&O(!1)):t.status===500&&i({type:d,payload:{status:!0,title:"Customers loading error",message:t.data.message}})}).catch(t=>{console.error("Error:",t)})},be=()=>{k(j+1);const s=p+50;E(s),P(s,!0)},Pe=()=>{k(j-1);const s=p-50;console.log(s),E(s),P(s,!1)},Se=()=>{b(y+1);const s=C+20;f(s),S(D,s)},ve=()=>{b(y-1);const s=C-20;console.log(s),f(s),S(D,s)},Ae=s=>{$(!R),B(s),S(s,0)},S=(s,a)=>{B(s),c&&(U(!0),V.get(v+`assistant/addresses/customer/${a}/`+s,{headers:{Authorization:`Bearer ${c}`}}).then(t=>{t.status===200?(console.log(t.data.count),de(t.data.list),fe(t.data.count),t.data.list.length<20?(T(!0),console.log("ok")):t.data.list.length>19&&T(!1),U(!1)):t.status===500&&i({type:d,payload:{status:!0,title:"Customers address error",message:t.data.message}})}).catch(t=>{console.error("Customers address:",t)}))},Ne=s=>{console.log(s),w(!Q),me(s),G(s.name),q(s.surname),K(s.email),X(s.contact)},Ie=()=>{if(Z&&Y&&J&&W){const s={name:Z,surname:Y,email:J,contact:W},a=m.id;c&&N&&c&&V.patch(v+"assistant/customers/update/"+a,s,{headers:{Authorization:`Bearer ${c}`}}).then(t=>{if(t.status===200){w(!1);const u=t.data,L=F.map(o=>o.id===u.id?u:o);_([...L])}else t.status===203?i({type:d,payload:{status:!0,title:"Customer update error",message:t.data.message,color:"warning"}}):t.status===204?i({type:d,payload:{status:!0,title:"Customer update error",message:t.data.message,color:"warning"}}):t.status===500&&i({type:d,payload:{status:!0,title:"Customer update error",message:t.data.message,color:"warning"}})}).catch(t=>{console.error("Error:",t)})}else i({type:d,payload:{status:!0,title:"Error!",message:"Customer update error, Please Check the input fields",color:"warning"}})},Ee=s=>{k(s);const a=(s-1)*50;E(a),P(a,!0)},we=()=>{const s=Math.ceil(pe/50),a=[];for(let o=1;o<=s;o++)a.push(o);const t=Math.max(j-2,1),u=Math.min(t+4,s);return a.slice(t-1,u).map(o=>e.jsx(h,{active:j===o,onClick:()=>Ee(o),children:o},o))},Me=s=>{b(s);const a=(s-1)*20;f(a),S(D,a)},ke=()=>{const s=Math.ceil(Ce/20),a=[];for(let o=1;o<=s;o++)a.push(o);const t=Math.max(y-2,1),u=Math.min(t+4,s);return a.slice(t-1,u).map(o=>e.jsx(h,{active:y===o,onClick:()=>Me(o),children:o},o))};return e.jsxs(Be,{children:[e.jsx(ze,{className:"bg-body-tertiary",children:e.jsx(x,{type:"text",placeholder:"Search by customer email",style:{width:450,marginLeft:"0%"},value:M,onChange:s=>xe(s.target.value)})}),he?e.jsx(ee,{}):e.jsxs(se,{children:[e.jsx(te,{children:e.jsxs(A,{children:[e.jsx(l,{scope:"col",children:"#"}),e.jsx(l,{scope:"col",children:"Photo"}),e.jsx(l,{scope:"col",children:"Name"}),e.jsx(l,{scope:"col",children:"Surname"}),e.jsx(l,{scope:"col",children:"email"}),e.jsx(l,{scope:"col",children:"Contact"}),e.jsx(l,{scope:"col",children:"Country"}),e.jsx(l,{scope:"col",children:"Language"}),e.jsx(l,{scope:"col",children:"Edit"}),e.jsx(l,{scope:"col",children:"Address"}),e.jsx(l,{scope:"col",children:"Grocery"})]})}),e.jsx(ae,{children:F.map((s,a)=>e.jsxs(A,{children:[e.jsx(n,{children:p+a+1}),e.jsx(l,{scope:"row",children:e.jsx(He,{style:{width:50,height:50,borderRadius:10},src:"https://api.zeuler.com/image/"+s.photo})}),e.jsx(n,{children:s.name}),e.jsx(n,{children:s.surname}),e.jsx(n,{children:s.email}),e.jsx(n,{children:s.contact}),e.jsx(n,{children:s.country==="it"||s.country==="Italy"?"Italy":s.country}),e.jsx(n,{children:s.language==="en"?"English":s.language==="it"?"Italy":s.language}),e.jsx(n,{children:e.jsx(z,{children:e.jsx(H,{icon:Ve,size:"xl",onClick:()=>Ne(s)})})}),e.jsx(n,{children:e.jsx(z,{children:e.jsx(H,{icon:Re,size:"xl",onClick:()=>Ae(s._id)})})}),e.jsx(n,{children:e.jsx(z,{to:`/customers/list/${s._id}`,children:e.jsx(H,{icon:Fe,size:"xl"})})})]},a))})]}),e.jsxs(re,{"aria-label":"Page navigation example",children:[e.jsx(h,{disabled:p<=0,onClick:Pe,children:"Previous"}),we(),e.jsx(h,{disabled:ge===!0,onClick:be,children:"Next"})]}),e.jsxs(oe,{visible:R,scrollable:!0,size:"xl",onClose:()=>{$(!1),f(0),b(1),T(!0),B("")},children:[e.jsx(le,{closeButton:!0,children:e.jsx(ne,{children:"Used Addresses"})}),e.jsx(ce,{style:{overflowY:"auto",maxHeight:"70vh",display:"flex",justifyContent:"center"},children:ue?e.jsx(ee,{}):e.jsxs(se,{children:[e.jsx(te,{children:e.jsxs(A,{children:[e.jsx(l,{scope:"col",children:"#"}),e.jsx(l,{scope:"col",children:"Name"}),e.jsx(l,{scope:"col",children:"Intercom"}),e.jsx(l,{scope:"col",children:"Flat"}),e.jsx(l,{scope:"col",children:"Street"}),e.jsx(l,{scope:"col",children:"House Number"})]})}),e.jsx(ae,{children:ie.map((s,a)=>e.jsxs(A,{children:[e.jsx(n,{children:C+a+1}),e.jsx(n,{children:s.name}),e.jsx(n,{children:s.intercom}),e.jsx(n,{children:s.flat}),e.jsx(n,{children:s.street}),e.jsx(n,{children:s.houseNumber})]},a))})]})}),e.jsx($e,{children:e.jsxs(re,{"aria-label":"Page navigation example",children:[e.jsx(h,{disabled:C<=0,onClick:ve,children:"Previous"}),ke(),e.jsx(h,{disabled:ye===!0,onClick:Se,children:"Next"})]})})]}),e.jsxs(oe,{visible:Q,scrollable:!0,size:"lg",onClose:()=>w(!1),children:[e.jsx(le,{closeButton:!0,children:e.jsx(ne,{children:"Edit Customer Information"})}),e.jsx(ce,{children:e.jsxs("div",{className:"row g-3",children:[e.jsx(g,{md:6,children:e.jsx(x,{id:"name",label:"Firt Name",defaultValue:m.name,onChange:s=>G(s.target.value)})}),e.jsx(g,{md:6,children:e.jsx(x,{id:"surname",label:"LastName",defaultValue:m.surname,onChange:s=>q(s.target.value)})}),e.jsx(g,{md:6,children:e.jsx(x,{id:"email",label:"Email",defaultValue:m.email,onChange:s=>K(s.target.value)})}),e.jsx(g,{md:6,children:e.jsx(x,{id:"phone",label:"Contact Number",defaultValue:m.contact,onChange:s=>X(s.target.value)})}),e.jsx(g,{xs:12,children:e.jsx(Le,{type:"submit",style:{marginBottom:"3%",width:"200px",backgroundColor:"#ff4d4d",color:"white"},onClick:()=>Ie(),children:"Update Customer"})})]})})]})]})};export{rs as default};
