import{r as l,x as we,z as d,j as e,L as I,h as Ae,m as P}from"./index-DaboRuf6.js";import{a as B}from"./axios-B4uVmeYG.js";import{B as D}from"./config-HOLfLxHr.js";import{b as Ne,a as ae}from"./CContainer-2x7Z1Exw.js";import{a as Ie,b as Be,d as ze,e as T}from"./DefaultLayout-C7qb2XTq.js";import{C as Fe}from"./CNavbar-C5whDHHf.js";import{C as j,a as p,b as c,c as a,d as g,e as r}from"./CTable-HWQYIuPu.js";import{c as Ee}from"./cil-clipboard-CrSEg4F6.js";import{c as z}from"./cil-info-CmGCY32x.js";import{C as Ge,a as F}from"./CPaginationItem-Cr8xW1LR.js";import{C as re,a as le,b as oe,c as ne}from"./CModalTitle-Dr1SToxo.js";import{C as Re}from"./CCardImage-DJBTq3mB.js";import{C as ce}from"./CModalFooter-C0lTLyiC.js";const es=()=>{var K,Q,W,X,ee,se,te;const[E,G]=l.useState(!1);l.useState(!1);const[{user:R,token:u},i]=we(),[L,$]=l.useState([]);l.useState([]);const[ie,x]=l.useState(!1),[$e,m]=l.useState(!1);l.useState(!1),l.useState([]);const[v,de]=l.useState([]),[f,w]=l.useState(0),[he,H]=l.useState(!0),[ue,xe]=l.useState(0),[k,A]=l.useState(1),[n,je]=l.useState([]),[U,pe]=l.useState([]),[V,ge]=l.useState([]),[me,C]=l.useState("All"),[_,y]=l.useState(""),[O,fe]=l.useState(!1),[ke,Y]=l.useState(!1),[J,Z]=l.useState([]),[Ce,q]=l.useState("");l.useEffect(()=>{const s=setTimeout(()=>{i({type:d,payload:{status:!0,title:"Data Loading",message:"Data loading error or  Timeout exceeded",color:"warning"}}),x(!1)},2e4);return R&&u&&M(0,s),()=>{clearTimeout(s)}},[R,u,_]);const M=(s,t)=>{x(!0),B.get(D+`deepLinkUrls/all/${s}?type=${_}`,{headers:{Authorization:`Bearer ${u}`}}).then(o=>{o.status===200?($(o.data.list),xe(o.data.count),x(!1),clearTimeout(t),o.data.length<50?H(!0):o.data.length>49&&H(!1)):o.status===204?x(!1):o.status===500&&(x(!1),i({type:d,payload:{status:!0,title:"links loading error",message:o.data.message}}))}).catch(o=>{console.error("Error:",o),x(!1),i({type:d,payload:{status:!0,title:"links loading error",message:res.data.message}})})},ye=s=>{const t=D+`deepLinkUrls/update/status/${s.id}`;console.log(t),fetch(t,{method:"POST",headers:{Authorization:`Bearer ${u}`,"Content-Type":"application/json"},body:JSON.stringify({status:!(s!=null&&s.status)})}).then(o=>{if(o.status===200){const N=L.map(S=>(S.id===s.id&&(S.status=!(s!=null&&s.status)),S));$(N)}else console.log(o.status),alert("Error while updating status")}).catch(o=>{alert(o.message)})},Me=()=>{A(k+1);const s=f+50;w(s),M(s,!0)},be=()=>{A(k-1);const s=f-50;console.log(s),w(s),M(s,!1)},Se=s=>{A(s);const t=(s-1)*50;w(t),M(t,!0)},Pe=()=>{const s=Math.ceil(ue/50),t=[];for(let h=1;h<=s;h++)t.push(h);const o=Math.max(k-2,1),N=Math.min(o+4,s);return t.slice(o-1,N).map(h=>e.jsx(F,{active:k===h,onClick:()=>Se(h),children:h},h))},De=s=>{if(G(!E),de(s),s.market!==null)console.log("market"),pe(s.market);else if(s.marketGroup!==null){console.log("marketGroup"),ge(s.marketGroup);const t=new URLSearchParams(s.url.split("?")[1]);t.has("index")&&(fe(!0),q(t.get("index")),console.log(t.get("index")))}else s.product!==null&&(console.log("product"),Te(s.product._id))},Te=s=>{m(!0),B.get(D+`product/view/${s}`,{headers:{Authorization:`Bearer ${u}`}}).then(t=>{t.status===200?(je(t.data.list),m(!1)):t.status===204?(m(!1),i({type:d,payload:{status:!0,title:"Product Loading error",message:t.data.message}})):t.status===500&&(m(!1),i({type:d,payload:{status:!0,title:"Product Loading error",message:t.data.message}}))}).catch(t=>{console.error("Error: ",t)})},b=s=>{s==="all"?(C("All"),y("")):s==="Product"?(C(s),y("Product")):s==="Market"?(C(s),y("Market")):s==="Market Group"&&(C(s),y("Market Group"))},Le=s=>{Y(!0),ve(s)},ve=s=>{B.get(D+`assistant/market/${s}`,{headers:{Authorization:`Bearer ${u}`}}).then(t=>{t.status===200?Z(t.data):t.status===204?i({type:d,payload:{status:!0,title:"Market Data loading error",message:t.data.message}}):t.status===500&&i({type:d,payload:{status:!0,title:"Market Data loading error",message:t.data.message}})}).catch(t=>{console.error("Error:",t),i({type:d,payload:{status:!0,title:"Market Data loading error",message:"Data loading error "}})})};return e.jsxs(Ne,{children:[e.jsx(I,{to:"/marketing/create/marketing/none",children:e.jsx(ae,{style:{marginLeft:"0%",width:"17%",backgroundColor:"#ff4d4d",color:"white"},children:"Create URL"})}),e.jsxs(Ie,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[e.jsx(Be,{style:{color:"white"},children:me}),e.jsxs(ze,{children:[e.jsx(T,{onClick:()=>{b("all")},children:"All"}),e.jsx(T,{onClick:()=>{b("Product")},children:"Product"}),e.jsx(T,{onClick:()=>{b("Market")},children:"Market"}),e.jsx(T,{onClick:()=>{b("Market Group")},children:"Market Group"})]})]}),e.jsx(Fe,{style:{marginTop:"1%"},className:"bg-body-tertiary"}),ie?e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(Ae,{style:{marginTop:"15%"}})}):e.jsxs(j,{children:[e.jsx(p,{children:e.jsxs(c,{children:[e.jsx(a,{scope:"col",children:"#"}),e.jsx(a,{scope:"col",children:"Type"}),e.jsx(a,{scope:"col",children:"URL"}),e.jsx(a,{scope:"col",children:"Action"}),e.jsx(a,{scope:"col",children:"View Details"})]})}),e.jsx(g,{children:L.length===0?e.jsx(c,{children:e.jsx(r,{colSpan:"4",style:{textAlign:"center",backgroundColor:"white"},children:e.jsx("h6",{style:{marginTop:"1%"},children:"No Data"})})}):L.map((s,t)=>e.jsxs(c,{children:[e.jsx(r,{children:f+t+1}),e.jsx(r,{children:s.type}),e.jsx(r,{children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("div",{children:s.url}),e.jsx("div",{children:e.jsx(P,{icon:Ee,onClick:()=>{navigator.clipboard.writeText(s.url),i({type:d,payload:{status:!0,title:"Copy Success",message:"URL copied to clipboard",color:"success"}})}})})]})}),e.jsx(r,{children:e.jsx(ae,{onClick:()=>{ye(s)},size:"sm",style:{backgroundColor:"#ff4d4d",color:"white"},variant:"outline",children:s!=null&&s.status?"Deactivate":"Activate"})}),e.jsx(r,{children:s.items===null?e.jsx(P,{icon:z,size:"xl"}):e.jsx(I,{children:e.jsx(P,{icon:z,size:"xl",onClick:()=>De(s)})})})]},t))})]}),e.jsxs(Ge,{"aria-label":"Page navigation example",children:[e.jsx(F,{disabled:f<=0,onClick:be,children:"Previous"}),Pe(),e.jsx(F,{disabled:he===!0,onClick:Me,children:"Next"})]}),e.jsxs(re,{visible:E,scrollable:!0,size:"xl",onClose:()=>{G(!1),q(""),Z([])},children:[e.jsx(le,{closeButton:!0,children:e.jsx(oe,{children:"Link Information"})}),e.jsx(ne,{style:{overflowY:"auto",maxHeight:"70vh",display:"flex",justifyContent:"center"},children:v.market!==null?e.jsx(e.Fragment,{children:e.jsxs(j,{children:[e.jsx(p,{children:e.jsxs(c,{children:[e.jsx(a,{scope:"col",children:"#"}),e.jsx(a,{scope:"col",children:"Chain Name"}),e.jsx(a,{scope:"col",children:"Address"})]})}),e.jsx(g,{children:e.jsxs(c,{children:[e.jsx(r,{children:"#"}),e.jsx(r,{children:(K=U.chain)==null?void 0:K.name}),e.jsx(r,{children:U.address})]})})]})}):v.marketGroup!==null?e.jsx(e.Fragment,{children:e.jsxs(j,{children:[e.jsx(p,{children:e.jsxs(c,{children:[e.jsx(a,{scope:"col",children:"#"}),e.jsx(a,{scope:"col",children:"Name"}),e.jsx(a,{scope:"col",children:"City"}),O?e.jsx(a,{scope:"col",children:"Market"}):e.jsx(e.Fragment,{})]})}),e.jsx(g,{children:e.jsxs(c,{children:[e.jsx(r,{children:"#"}),e.jsx(r,{children:V.name}),e.jsx(r,{children:V.city}),O?e.jsxs(r,{children:[" ",e.jsxs(I,{children:[" ",e.jsx(P,{icon:z,size:"xl",onClick:()=>{Le(Ce)}})," "]})]}):e.jsx(e.Fragment,{})]})})]})}):v.product!==null?e.jsx(e.Fragment,{children:e.jsxs(j,{children:[e.jsx(p,{children:e.jsxs(c,{children:[e.jsx(a,{scope:"col",children:"#"}),e.jsx(a,{scope:"col",children:"Product Id"}),e.jsx(a,{scope:"col",children:"Photo"}),e.jsx(a,{scope:"col",children:"Name"}),e.jsx(a,{scope:"col",children:"Base Price"}),e.jsx(a,{scope:"col",children:"Tax"}),e.jsx(a,{scope:"col",children:"Markup Percentage "}),e.jsx(a,{scope:"col",children:"Markup"}),e.jsx(a,{scope:"col",children:"Total"}),e.jsx(a,{scope:"col",children:"Brand"}),e.jsx(a,{scope:"col",children:"Chain"}),e.jsx(a,{scope:"col",children:"Market Address"})]})}),e.jsx(g,{children:e.jsxs(c,{children:[e.jsx(r,{children:"#"}),e.jsx(r,{children:n.pid}),e.jsx(a,{children:e.jsx(Re,{style:{width:"50px",height:"50px"},src:"https://api.zeuler.com/image/"+n.image})}),e.jsx(r,{children:n.name}),e.jsx(r,{children:(((Q=n.price)==null?void 0:Q.basePrice)??0).toFixed(2)}),e.jsx(r,{children:(((W=n.price)==null?void 0:W.tax)??0).toFixed(2)}),e.jsxs(r,{children:[(X=n.price)==null?void 0:X.percentage,"%"]}),e.jsx(r,{children:(((ee=n.price)==null?void 0:ee.markup)??0).toFixed(2)}),e.jsx(r,{children:(((se=n.price)==null?void 0:se.total)??0).toFixed(2)}),e.jsx(r,{children:n.brand}),e.jsx(r,{children:n.chainName}),e.jsx(r,{children:n.marketAddress})]})})]})}):e.jsx(e.Fragment,{})}),e.jsx(ce,{})]}),e.jsxs(re,{visible:ke,scrollable:!0,size:"xl",onClose:()=>{Y(!1)},children:[e.jsx(le,{closeButton:!0,children:e.jsx(oe,{children:"Link Market Information"})}),e.jsx(ne,{style:{overflowY:"auto",maxHeight:"70vh",display:"flex",justifyContent:"center"},children:e.jsxs(j,{children:[e.jsx(p,{children:e.jsxs(c,{children:[e.jsx(a,{scope:"col",children:"#"}),e.jsx(a,{scope:"col",children:"Chain Name"}),e.jsx(a,{scope:"col",children:"Address"})]})}),e.jsx(g,{children:e.jsxs(c,{children:[e.jsx(r,{children:"#"}),e.jsx(r,{children:(te=J.chain)==null?void 0:te.name}),e.jsx(r,{children:J.address})]})})]})}),e.jsx(ce,{})]})]})};export{es as default};
