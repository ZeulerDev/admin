import{r as l,y as xe,A as h,j as e,L as V,h as he,m as L}from"./index-BzWpTyRP.js";import{a as Y}from"./axios-Cm0UX6qg.js";import{B as Z}from"./config-HOLfLxHr.js";import{b as ue,a as pe}from"./CContainer-BohUAxSl.js";import{a as je,b as me,d as ge,e as y}from"./DefaultLayout-Blmcm6y8.js";import{C as fe}from"./CNavbar-u7Q3iHwm.js";import{C as b,a as P,b as i,c as t,d as T,e as a}from"./CTable-C62CAHLk.js";import{c as Ce}from"./cil-clipboard-CrSEg4F6.js";import{c as q}from"./cil-info-CmGCY32x.js";import{C as ke,a as w}from"./CPaginationItem-CQqCx2lq.js";import{C as ye,a as be,b as Pe,c as Te}from"./CModalTitle-BEoCtNfZ.js";import{C as Me}from"./CCardImage-DI-tOl1o.js";import{C as Se}from"./CModalFooter-COP8gJvv.js";const He=()=>{var R,z,U,$,H,_;const[v,A]=l.useState(!1);l.useState(!1);const[{user:N,token:u},d]=xe(),[I,J]=l.useState([]);l.useState([]);const[K,x]=l.useState(!1),[De,p]=l.useState(!1);l.useState(!1),l.useState([]);const[M,O]=l.useState([]),[j,S]=l.useState(0),[Q,B]=l.useState(!0),[W,X]=l.useState(0),[m,D]=l.useState(1),[c,ee]=l.useState([]),[G,se]=l.useState([]),[F,te]=l.useState([]),[ae,g]=l.useState("All"),[E,f]=l.useState("");l.useEffect(()=>{const s=setTimeout(()=>{d({type:h,payload:{status:!0,title:"Data Loading",message:"Data loading error or  Timeout exceeded",color:"warning"}}),x(!1)},2e4);return N&&u&&C(0,s),()=>{clearTimeout(s)}},[N,u,E]);const C=(s,r)=>{x(!0),Y.get(Z+`deepLinkUrls/all/${s}?type=${E}`,{headers:{Authorization:`Bearer ${u}`}}).then(o=>{o.status===200?(J(o.data.list),X(o.data.count),x(!1),clearTimeout(r),o.data.length<50?B(!0):o.data.length>49&&B(!1)):o.status===204?x(!1):o.status===500&&(x(!1),d({type:h,payload:{status:!0,title:"links loading error",message:o.data.message}}))}).catch(o=>{console.error("Error:",o),x(!1),d({type:h,payload:{status:!0,title:"links loading error",message:res.data.message}})})},re=()=>{D(m+1);const s=j+50;S(s),C(s,!0)},le=()=>{D(m-1);const s=j-50;console.log(s),S(s),C(s,!1)},oe=s=>{D(s);const r=(s-1)*50;S(r),C(r,!0)},ce=()=>{const s=Math.ceil(W/50),r=[];for(let n=1;n<=s;n++)r.push(n);const o=Math.max(m-2,1),de=Math.min(o+4,s);return r.slice(o-1,de).map(n=>e.jsx(w,{active:m===n,onClick:()=>oe(n),children:n},n))},ie=s=>{A(!v),O(s),s.market!==null?(console.log("market"),se(s.market)):s.marketGroup!==null?(console.log("marketGroup"),te(s.marketGroup)):s.product!==null&&(console.log("product"),ne(s.product._id))},ne=s=>{p(!0),Y.get(Z+`product/view/${s}`,{headers:{Authorization:`Bearer ${u}`}}).then(r=>{r.status===200?(ee(r.data.list),p(!1)):r.status===204?(p(!1),d({type:h,payload:{status:!0,title:"Product Loading error",message:r.data.message}})):r.status===500&&(p(!1),d({type:h,payload:{status:!0,title:"Product Loading error",message:r.data.message}}))}).catch(r=>{console.error("Error: ",r)})},k=s=>{s==="all"?(g("All"),f("")):s==="Product"?(g(s),f("Product")):s==="Market"?(g(s),f("Market")):s==="Market Group"&&(g(s),f("Market Group"))};return e.jsxs(ue,{children:[e.jsx(V,{to:"/marketing/create/marketing/none",children:e.jsx(pe,{style:{marginLeft:"0%",width:"17%",backgroundColor:"#ff4d4d",color:"white"},children:"Create URL"})}),e.jsxs(je,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[e.jsx(me,{style:{color:"white"},children:ae}),e.jsxs(ge,{children:[e.jsx(y,{onClick:()=>{k("all")},children:"All"}),e.jsx(y,{onClick:()=>{k("Product")},children:"Product"}),e.jsx(y,{onClick:()=>{k("Market")},children:"Market"}),e.jsx(y,{onClick:()=>{k("Market Group")},children:"Market Group"})]})]}),e.jsx(fe,{style:{marginTop:"1%"},className:"bg-body-tertiary"}),K?e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(he,{style:{marginTop:"15%"}})}):e.jsxs(b,{children:[e.jsx(P,{children:e.jsxs(i,{children:[e.jsx(t,{scope:"col",children:"#"}),e.jsx(t,{scope:"col",children:"Type"}),e.jsx(t,{scope:"col",children:"URL"}),e.jsx(t,{scope:"col",children:"View Details"})]})}),e.jsx(T,{children:I.length===0?e.jsx(i,{children:e.jsx(a,{colSpan:"4",style:{textAlign:"center",backgroundColor:"white"},children:e.jsx("h6",{style:{marginTop:"1%"},children:"No Data"})})}):I.map((s,r)=>e.jsxs(i,{children:[e.jsx(a,{children:j+r+1}),e.jsx(a,{children:s.type}),e.jsx(a,{children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("div",{children:s.url}),e.jsx("div",{children:e.jsx(L,{icon:Ce,onClick:()=>{navigator.clipboard.writeText(s.url),d({type:h,payload:{status:!0,title:"Copy Success",message:"URL copied to clipboard",color:"success"}})}})})]})}),e.jsx(a,{children:s.items===null?e.jsx(L,{icon:q,size:"xl"}):e.jsx(V,{children:e.jsx(L,{icon:q,size:"xl",onClick:()=>ie(s)})})})]},r))})]}),e.jsxs(ke,{"aria-label":"Page navigation example",children:[e.jsx(w,{disabled:j<=0,onClick:le,children:"Previous"}),ce(),e.jsx(w,{disabled:Q===!0,onClick:re,children:"Next"})]}),e.jsxs(ye,{visible:v,scrollable:!0,size:"xl",onClose:()=>A(!1),children:[e.jsx(be,{closeButton:!0,children:e.jsx(Pe,{children:"Link Information"})}),e.jsx(Te,{style:{overflowY:"auto",maxHeight:"70vh",display:"flex",justifyContent:"center"},children:M.market!==null?e.jsx(e.Fragment,{children:e.jsxs(b,{children:[e.jsx(P,{children:e.jsxs(i,{children:[e.jsx(t,{scope:"col",children:"#"}),e.jsx(t,{scope:"col",children:"Chain Name"}),e.jsx(t,{scope:"col",children:"Address"})]})}),e.jsx(T,{children:e.jsxs(i,{children:[e.jsx(a,{children:"#"}),e.jsx(a,{children:(R=G.chain)==null?void 0:R.name}),e.jsx(a,{children:G.address})]})})]})}):M.marketGroup!==null?e.jsx(e.Fragment,{children:e.jsxs(b,{children:[e.jsx(P,{children:e.jsxs(i,{children:[e.jsx(t,{scope:"col",children:"#"}),e.jsx(t,{scope:"col",children:"Name"}),e.jsx(t,{scope:"col",children:"City"})]})}),e.jsx(T,{children:e.jsxs(i,{children:[e.jsx(a,{children:"#"}),e.jsx(a,{children:F.name}),e.jsx(a,{children:F.city})]})})]})}):M.product!==null?e.jsx(e.Fragment,{children:e.jsxs(b,{children:[e.jsx(P,{children:e.jsxs(i,{children:[e.jsx(t,{scope:"col",children:"#"}),e.jsx(t,{scope:"col",children:"Product Id"}),e.jsx(t,{scope:"col",children:"Photo"}),e.jsx(t,{scope:"col",children:"Name"}),e.jsx(t,{scope:"col",children:"Base Price"}),e.jsx(t,{scope:"col",children:"Tax"}),e.jsx(t,{scope:"col",children:"Markup Percentage "}),e.jsx(t,{scope:"col",children:"Markup"}),e.jsx(t,{scope:"col",children:"Total"}),e.jsx(t,{scope:"col",children:"Brand"}),e.jsx(t,{scope:"col",children:"Chain"}),e.jsx(t,{scope:"col",children:"Market Address"})]})}),e.jsx(T,{children:e.jsxs(i,{children:[e.jsx(a,{children:"#"}),e.jsx(a,{children:c.pid}),e.jsx(t,{children:e.jsx(Me,{style:{width:"50px",height:"50px"},src:"https://api.zeuler.com/image/"+c.image})}),e.jsx(a,{children:c.name}),e.jsx(a,{children:(((z=c.price)==null?void 0:z.basePrice)??0).toFixed(2)}),e.jsx(a,{children:(((U=c.price)==null?void 0:U.tax)??0).toFixed(2)}),e.jsxs(a,{children:[($=c.price)==null?void 0:$.percentage,"%"]}),e.jsx(a,{children:(((H=c.price)==null?void 0:H.markup)??0).toFixed(2)}),e.jsx(a,{children:(((_=c.price)==null?void 0:_.total)??0).toFixed(2)}),e.jsx(a,{children:c.brand}),e.jsx(a,{children:c.chainName}),e.jsx(a,{children:c.marketAddress})]})})]})}):e.jsx(e.Fragment,{})}),e.jsx(Se,{})]})]})};export{He as default};
