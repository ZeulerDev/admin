import{r as s,y as U,l as J,A as l,j as e}from"./index-DCIC8fO6.js";import{a as L}from"./axios-Cm0UX6qg.js";import{B as K}from"./config-HOLfLxHr.js";import{b as O,a as v}from"./CContainer-Dhr2RTMc.js";import{C as i}from"./CCol-Wc4ZYHsw.js";import{C as d}from"./CFormInput-S43P1cjW.js";import{C as u}from"./CFormSelect-DZrSmur4.js";import{C as Q}from"./CNavbar-R1oxGH4k.js";import{C as V,a as X,b as R,c as h,d as Y,e as m}from"./CTable-Bvq_3Do7.js";import"./CFormLabel-BFz3Pslt.js";const ce=()=>{const[w,E]=s.useState([]),[{user:b,token:c},o]=U(),[B,Z]=s.useState(["conad","carrefour","everli","everli_Carrefour","pam","cosicomodo","il_Gigante"]),[p,F]=s.useState(""),[x,N]=s.useState(""),[y,_]=s.useState(""),[g,q]=s.useState(""),[j,z]=s.useState(""),[C,H]=s.useState(""),P=J(),[n,T]=s.useState(""),[S,k]=s.useState(""),[f,A]=s.useState(""),[r,M]=s.useState([]),W=()=>{if(n&&S&&f){if(r.find(D=>D.day===n)){o({type:l,payload:{status:!0,title:"Day already exists",message:"Schedule for "+n+" already exists"}});return}const a={day:n,info:{startTime:S,closeTime:f}};M([...r,a]),T(""),k(""),A("")}else console.log("All fields are required"),o({type:l,payload:{status:!0,title:"Please Check",message:"All fields are required"}})},$=t=>{const a=r.filter((D,I)=>I!==t);M(a)},G=()=>{if(console.log(r),p&&x&&y&&g&&j&&C){const t={lat:p,lng:x,address:y,id:g,city:j,source:C,times:r};console.log(t),b&&c&&L.post(K+"assistant/market/create",t,{headers:{Authorization:`Bearer ${c}`}}).then(a=>{a.status===200?(o({type:l,payload:{status:!0,title:"Market Registration",message:"Market Registration Success",color:"success"}}),P("/markets")):a.status===204?o({type:l,payload:{status:!0,title:"Market Registration error",message:a.data.message}}):a.status===500&&o({type:l,payload:{status:!0,title:"Market Registration error",message:a.data.message}})}).catch(a=>{console.error("Error:",a)})}else alert("Please Check the Fields!")};return s.useEffect(()=>{c&&b&&L.get("https://15.160.211.157/assistant/market/chains/all",{headers:{Authorization:`Bearer ${c}`}}).then(t=>{t.status===200?E(t.data):t.status===500&&o({type:l,payload:{status:!0,title:"Market Registration error",message:t.data.message}})}).catch(t=>{console.error("Error:",t)})},[]),e.jsx(O,{children:e.jsxs("div",{className:"row g-3",children:[e.jsx(i,{md:6,children:e.jsx(d,{id:"inputlatitue",label:"Latitude",value:p,onChange:t=>F(t.target.value)})}),e.jsx(i,{md:6,children:e.jsx(d,{id:"inputlongtitu",label:"Longitude",value:x,onChange:t=>N(t.target.value)})}),e.jsx(i,{xs:12,children:e.jsx(d,{id:"inputAddress",label:"Address",placeholder:"",value:y,onChange:t=>_(t.target.value)})}),e.jsx(i,{md:4,children:e.jsxs(u,{id:"inputState",label:"City",value:j,onChange:t=>z(t.target.value),children:[e.jsx("option",{children:"Select City"}),e.jsx("option",{children:"Milano"}),e.jsx("option",{children:"Napoli"})]})}),e.jsx(i,{md:4,children:e.jsxs(u,{id:"inputState",label:"Market Chain",value:g,onChange:t=>q(t.target.value),children:[e.jsx("option",{children:"Select Chain"}),w.map((t,a)=>e.jsx("option",{value:t.id,children:t.name},a))]})}),e.jsx(i,{md:4,children:e.jsxs(u,{id:"inputState",label:"Source",value:C,onChange:t=>H(t.target.value),children:[e.jsx("option",{children:"Select"}),B.map((t,a)=>e.jsx("option",{children:t},a))]})}),e.jsxs(Q,{style:{marginTop:"1%"},className:"bg-body-tertiary",children:[e.jsx(i,{md:2,children:e.jsxs(u,{id:"inputState",label:"Day",value:n,onChange:t=>T(t.target.value),children:[e.jsx("option",{children:"Select Day"}),e.jsx("option",{value:"mon",children:"Monday"}),e.jsx("option",{value:"tue",children:"Tuesday"}),e.jsx("option",{value:"wed",children:"Wednesday"}),e.jsx("option",{value:"thu",children:"Thursday"}),e.jsx("option",{value:"fri",children:"Friday"}),e.jsx("option",{value:"sat",children:"Saturday"}),e.jsx("option",{value:"sun",children:"Sunday"})]})}),e.jsx(i,{md:4,children:e.jsx(d,{id:"inputstart",label:"Start Time",type:"time",value:S,onChange:t=>k(t.target.value)})}),e.jsx(i,{md:4,children:e.jsx(d,{id:"inputend",label:"Close Time",type:"time",value:f,onChange:t=>A(t.target.value)})}),e.jsx(i,{md:2,children:e.jsx(v,{style:{marginTop:31,backgroundColor:"#ff4d4d",color:"white",marginLeft:"5%"},onClick:W,children:"Add"})})]}),e.jsxs(V,{children:[e.jsx(X,{children:e.jsxs(R,{children:[e.jsx(h,{scope:"col",children:"Day"}),e.jsx(h,{scope:"col",children:"Start Time"}),e.jsx(h,{scope:"col",children:"Close Time"}),e.jsx(h,{scope:"col",children:"Action"})]})}),e.jsx(Y,{children:r.map((t,a)=>e.jsxs(R,{children:[e.jsx(m,{children:t.day==="mon"?"Monday":t.day==="tue"?"Tuesday":t.day==="wed"?"Wednesday":t.day==="thu"?"Thursday":t.day==="fri"?"Friday":t.day==="sat"?"Saturday":"Sunday"}),e.jsx(m,{children:t.info.startTime}),e.jsx(m,{children:t.info.closeTime}),e.jsx(m,{children:e.jsx(v,{style:{backgroundColor:"#ff4d4d",color:"white"},onClick:()=>$(a),children:"Remove"})})]},a))})]}),e.jsx(i,{xs:12,children:e.jsx(v,{type:"submit",style:{marginBottom:"3%",width:"200px",backgroundColor:"#ff4d4d",color:"white"},onClick:()=>G(),children:"Add Market"})})]})})};export{ce as default};
