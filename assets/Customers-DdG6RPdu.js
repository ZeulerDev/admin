import{r,x as ne,l as de,z as n,j as e,i as G,L as v,m as S}from"./index-B2mJY6nk.js";import{a as w}from"./axios-B4uVmeYG.js";import{b as ue,a as p}from"./CContainer-HxaQKhHw.js";import{C as he}from"./CNavbar-C6aw6t1r.js";import{C as u}from"./CFormInput-DIFYjtpM.js";import{C as Q,a as Z,b as j,c as t,d as U,e as o}from"./CTable-D7t5m_Bv.js";import{C as me}from"./CCardImage-B6NAuy_J.js";import{c as xe}from"./cil-pencil-m516yCOw.js";import{c as pe}from"./cil-info-CmGCY32x.js";import{C as je,a as Y}from"./CPaginationItem-DTZe_mIK.js";import{C as _,a as q,b as J,c as K}from"./CModalTitle-CJnjKzOP.js";import{C as W}from"./CModalFooter-DI0RJn1I.js";import{C as Ce}from"./CForm-Auzu0woL.js";import{C as h}from"./CCol-DExom2-S.js";import"./CFormLabel-BMh_f0jF.js";import"./DefaultLayout-CXJ534N4.js";var ge=["512 512","<rect width='288' height='32' x='112' y='152' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='288' height='32' x='112' y='240' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='152' height='32' x='112' y='328' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M480,48H32V464H480ZM448,432H64V80H448Z' class='ci-primary'/>"];const Ae=()=>{const[E,C]=r.useState(!1),[{user:g,token:c},i]=ne();de();const[N,P]=r.useState([]),[X,O]=r.useState([]),[I,m]=r.useState(!1),[f,T]=r.useState(0),[k,x]=r.useState(!1),[d,ee]=r.useState([]),[z,B]=r.useState(),[D,H]=r.useState(),[A,L]=r.useState(),[V,M]=r.useState(),[y,se]=r.useState(""),[ae,F]=r.useState(!0);r.useEffect(()=>{g&&c&&b(0)},[g,c,y]);const b=(s,l)=>{m(!0),w.get("http://localhost:8003/assistant/customers/"+s+"?email="+y,{headers:{Authorization:`Bearer ${c}`}}).then(a=>{console.log(a.status),a.status===200?(P(a.data),m(!1),a.data.length<50?(F(!0),console.log("ok")):a.data.length>49&&F(!1)):a.status===500&&i({type:n,payload:{status:!0,title:"Customers loading error",message:a.data.message}})}).catch(a=>{console.error("Error:",a)})},te=()=>{const s=f+50;T(s),b(s)},re=()=>{const s=f-50;console.log(s),T(s),b(s)},oe=s=>{C(!E),c&&(m(!0),w.get("http://localhost:8003/assistant/addresses/customer/"+s,{headers:{Authorization:`Bearer ${c}`}}).then(l=>{l.status===200?(O(l.data),m(!1)):l.status===500&&i({type:n,payload:{status:!0,title:"Customers address error",message:l.data.message}})}).catch(l=>{console.error("Customers address:",l)}))},le=s=>{console.log(s),x(!k),ee(s),B(s.name),H(s.surname),L(s.email),M(s.contact)},ce=()=>{if(z&&D&&A&&V){const s={name:z,surname:D,email:A,contact:V},l=d.id;c&&g&&c&&w.patch("http://localhost:8003/assistant/customers/update/"+l,s,{headers:{Authorization:`Bearer ${c}`}}).then(a=>{if(a.status===200){x(!1);const R=a.data,ie=N.map($=>$.id===R.id?R:$);P([...ie])}else a.status===203?i({type:n,payload:{status:!0,title:"Customer update error",message:a.data.message,color:"warning"}}):a.status===204?i({type:n,payload:{status:!0,title:"Customer update error",message:a.data.message,color:"warning"}}):a.status===500&&i({type:n,payload:{status:!0,title:"Customer update error",message:a.data.message,color:"warning"}})}).catch(a=>{console.error("Error:",a)})}else i({type:n,payload:{status:!0,title:"Error!",message:"Customer update error, Please Check the input fields",color:"warning"}})};return e.jsxs(ue,{children:[e.jsx(he,{className:"bg-body-tertiary",children:e.jsx(u,{type:"text",placeholder:"Search by customer email",style:{width:450,marginLeft:"2%"},value:y,onChange:s=>se(s.target.value)})}),I?e.jsx(G,{}):e.jsxs(Q,{children:[e.jsx(Z,{children:e.jsxs(j,{children:[e.jsx(t,{scope:"col",children:"#"}),e.jsx(t,{scope:"col",children:"Name"}),e.jsx(t,{scope:"col",children:"Surname"}),e.jsx(t,{scope:"col",children:"email"}),e.jsx(t,{scope:"col",children:"Contact"}),e.jsx(t,{scope:"col",children:"Country"}),e.jsx(t,{scope:"col",children:"Language"}),e.jsx(t,{scope:"col",children:"Edit"}),e.jsx(t,{scope:"col",children:"Address"}),e.jsx(t,{scope:"col",children:"Grocery"})]})}),e.jsx(U,{children:N.map(s=>e.jsxs(j,{children:[e.jsx(t,{scope:"row",children:e.jsx(me,{style:{width:50,height:50,borderRadius:10},src:"https://api.zeuler.com/image/"+s.photo})}),e.jsx(o,{children:s.name}),e.jsx(o,{children:s.surname}),e.jsx(o,{children:s.email}),e.jsx(o,{children:s.contact}),e.jsx(o,{children:s.country==="it"||s.country==="Italy"?"Italy":s.country}),e.jsx(o,{children:s.language==="en"?"English":s.language==="it"?"Italy":s.language}),e.jsx(o,{children:e.jsx(v,{children:e.jsx(S,{icon:xe,size:"xl",onClick:()=>le(s)})})}),e.jsx(o,{children:e.jsx(v,{children:e.jsx(S,{icon:pe,size:"xl",onClick:()=>oe(s.id)})})}),e.jsx(o,{children:e.jsx(v,{to:`/customers/orders/${s.id}`,children:e.jsx(S,{icon:ge,size:"xl"})})})]},s.id))})]}),e.jsxs(je,{"aria-label":"Page navigation example",children:[e.jsx(Y,{disabled:f<=0,onClick:re,children:"Previous"}),e.jsx(Y,{disabled:ae===!0,onClick:te,children:"Next"})]}),e.jsxs(_,{visible:E,scrollable:!0,size:"xl",onClose:()=>C(!1),children:[e.jsx(q,{closeButton:!0,children:e.jsx(J,{children:"Order Grocery List"})}),e.jsx(K,{style:{overflowY:"auto",maxHeight:"70vh",display:"flex",justifyContent:"center"},children:I?e.jsx(G,{}):e.jsxs(Q,{children:[e.jsx(Z,{children:e.jsxs(j,{children:[e.jsx(t,{scope:"col",children:"#"}),e.jsx(t,{scope:"col",children:"Name"}),e.jsx(t,{scope:"col",children:"Intercom"}),e.jsx(t,{scope:"col",children:"Flat"}),e.jsx(t,{scope:"col",children:"Street"}),e.jsx(t,{scope:"col",children:"House Number"})]})}),e.jsx(U,{children:X.map((s,l)=>e.jsxs(j,{children:[e.jsx(t,{scope:"row"}),e.jsx(o,{children:s.name}),e.jsx(o,{children:s.intercom}),e.jsx(o,{children:s.flat}),e.jsx(o,{children:s.street}),e.jsx(o,{children:s.houseNumber})]},l))})]})}),e.jsxs(W,{children:[e.jsx(p,{color:"secondary",onClick:()=>C(!1),children:"Close"}),e.jsx(p,{color:"primary",children:"Save changes"})]})]}),e.jsxs(_,{visible:k,scrollable:!0,size:"lg",onClose:()=>x(!1),children:[e.jsx(q,{closeButton:!0,children:e.jsx(J,{children:"Edit Customer Information"})}),e.jsx(K,{children:e.jsxs(Ce,{className:"row g-3",onSubmit:ce,children:[e.jsx(h,{md:6,children:e.jsx(u,{id:"name",label:"Firt Name",defaultValue:d.name,onChange:s=>B(s.target.value)})}),e.jsx(h,{md:6,children:e.jsx(u,{id:"surname",label:"LastName",defaultValue:d.surname,onChange:s=>H(s.target.value)})}),e.jsx(h,{md:6,children:e.jsx(u,{id:"email",label:"Email",defaultValue:d.email,onChange:s=>L(s.target.value)})}),e.jsx(h,{md:6,children:e.jsx(u,{id:"phone",label:"Contact Number",defaultValue:d.contact,onChange:s=>M(s.target.value)})}),e.jsx(h,{xs:12,children:e.jsx(p,{color:"warning",type:"submit",style:{marginBottom:"3%",width:"200px"},children:"Update Customer"})})]})}),e.jsx(W,{children:e.jsx(p,{color:"secondary",onClick:()=>x(!1),children:"Close"})})]})]})};export{Ae as default};
