import{y as oe,r,A as l,j as a,i as le,L as ie,m as ce}from"./index-BWlRxZR8.js";import{a as u}from"./axios-Cm0UX6qg.js";import{B as N}from"./config-HOLfLxHr.js";import{b as ne,a as T}from"./CContainer-BeCNJf98.js";import{C as de}from"./CNavbar-CWGW5eE1.js";import{C as B}from"./CFormInput-OB57kctv.js";import{C as I,a as L,b as $,c as p}from"./DefaultLayout-DIJ05e3Y.js";import{C as he,a as ue,b as z,c,d as pe,e as m}from"./CTable-CyBDKgVE.js";import{C as me}from"./CCardImage-DgJs2Kx-.js";import{c as Ce}from"./cil-pencil-m516yCOw.js";import{C as ge,a as R}from"./CPaginationItem-CIV5qAIs.js";import{C as xe,a as fe,b as je,c as ye}from"./CModalTitle-DsWyG9u4.js";import{C as ke}from"./CModalFooter-ed5NJ-jx.js";import"./CFormLabel-CHPeVZLG.js";const ze=()=>{const[{user:C,token:i},o]=oe(),[U,k]=r.useState(!1),[F,H]=r.useState([]),[g,P]=r.useState(0),[_,n]=r.useState(!0),[Q,V]=r.useState([]),[q,x]=r.useState("All Chains"),[G,b]=r.useState("All market"),[Pe,f]=r.useState(""),[S,D]=r.useState(""),[J,K]=r.useState([]),[j,O]=r.useState(""),[W,d]=r.useState(!1),[X,M]=r.useState(""),[y,A]=r.useState(""),[Y,v]=r.useState("");r.useEffect(()=>{C&&i&&h(0)},[C,i,S,j]),r.useEffect(()=>{i&&u.get("http://localhost:8003/assistant/market/chains/all",{headers:{Authorization:`Bearer ${i}`}}).then(e=>{e.status===200?V(e.data):e.status===500&&o({type:l,payload:{status:!0,title:"Chain Loading error",message:e.data.message}})}).catch(e=>{console.error("Error: ",e)})},[]);const Z=e=>{u.get(`http://localhost:8003/assistant/market/locations?brand=${e}`,{headers:{Authorization:`Bearer ${i}`}}).then(t=>{t.status===200?(K(t.data.data),t.data.data.length<20?(n(!0),console.log("ok")):t.data.data.length>19&&n(!1)):t.status===500&&o({type:l,payload:{status:!0,title:"Market Loading error",message:t.data.message}})}).catch(t=>{console.error("Error: ",t)})},h=(e,t)=>{k(!0),u.get(N+`product/all/${e}?marketId=${S}&name=${j}`,{headers:{Authorization:`Bearer ${i}`}}).then(s=>{s.status===200?(H(s.data),k(!1),s.data.length<20?(n(!0),console.log("ok")):s.data.length>19&&n(!1)):s.status===203?o({type:l,payload:{status:!0,title:"product loading error error",message:s.data.message}}):s.status===204?o({type:l,payload:{status:!0,title:"No Products",message:"No products found in this market address",color:"info"}}):s.status===500&&o({type:l,payload:{status:!0,title:"product loading error error",message:s.data.message}})}).catch(s=>{console.error("Error:",s)})},w=(e,t)=>{e==="all"?(f(""),x("All Chains")):(f(e),Z(e),x(t))},E=(e,t)=>{e==="all"?(D(""),b("All Markets"),f(""),x("All Chains")):(D(e),b(t))},ee=()=>{const e=g+50;P(e),h(e)},ae=()=>{const e=g-50;console.log(e),P(e),h(e)},te=(e,t)=>{d(!0),M(e),v(t)},se=()=>{console.log("called"),y==""?o({type:l,payload:{status:!0,title:"Alert",message:"Please enter the price",color:"warning"}}):re(X)},re=e=>{if(e){let t={price:y+" â‚¬"};C&&i&&u.put(N+"product/update/price/"+e,t,{headers:{Authorization:`Bearer ${i}`}}).then(s=>{s.status===200?(o({type:l,payload:{status:!0,title:"Product Details Update",message:"Product price update Success",color:"success"}}),M(""),A(""),h(0),d(!1),v("")):s.status===204?o({type:l,payload:{status:!0,title:"Product Details Update error",message:s.data.message,color:"danger"}}):s.status===500&&o({type:l,payload:{status:!0,title:"Product Details Update error",message:s.data.message,color:"danger"}})}).catch(s=>{console.error("Error:",s)})}else alert("Please Check the Fields!")};return a.jsxs(ne,{children:[a.jsxs(de,{className:"bg-body-tertiary",children:[a.jsx(B,{type:"text",placeholder:"Search by Product name",style:{width:450,marginLeft:"2%"},value:j,onChange:e=>O(e.target.value)}),a.jsxs(I,{style:{marginRight:"1%",width:"15%",backgroundColor:"#ff4d4d"},children:[a.jsx(L,{children:q}),a.jsxs($,{children:[a.jsx(p,{onClick:()=>w("all"),children:"All"}),Q.map((e,t)=>a.jsx(p,{onClick:()=>w(e.id,e.name),children:e.name},t))]})]}),a.jsxs(I,{style:{marginRight:"1%",width:"35%",backgroundColor:"#ff4d4d"},children:[a.jsx(L,{children:G}),a.jsxs($,{children:[a.jsx(p,{onClick:()=>E("all"),children:"Select the Chain"}),J.map((e,t)=>a.jsx(p,{onClick:()=>E(e._id,e.address),children:e.address},t))]})]})]}),U?a.jsx(le,{}):a.jsxs(he,{children:[a.jsx(ue,{children:a.jsxs(z,{children:[a.jsx(c,{scope:"col",children:"Photo"}),a.jsx(c,{scope:"col",children:"Name"}),a.jsx(c,{scope:"col",children:"Price"}),a.jsx(c,{scope:"col",children:"Chain"}),a.jsx(c,{scope:"col",children:"Market Address"})]})}),a.jsx(pe,{children:F.map((e,t)=>a.jsxs(z,{children:[a.jsx(c,{scope:"row",children:a.jsx(me,{style:{width:"50px",height:"50px"},src:"https://api.zeuler.com/image/"+e.photo})}),a.jsx(m,{children:e.name}),a.jsxs(m,{children:[e.price,a.jsx(ie,{to:"",children:a.jsx(ce,{icon:Ce,size:"sm",onClick:()=>te(e.productId,e.price)})})]}),a.jsx(m,{children:e.chainName}),a.jsx(m,{children:e.marketAddress})]},t))})]}),a.jsxs(ge,{"aria-label":"Page navigation example",children:[a.jsx(R,{disabled:g<=0,onClick:ae,children:"Previous"}),a.jsx(R,{disabled:_===!0,onClick:ee,children:"Next"})]}),a.jsxs(xe,{alignment:"center",visible:W,scrollable:!0,size:"sm",onClose:()=>d(!1),children:[a.jsx(fe,{closeButton:!0,children:a.jsx(je,{children:"Change Price"})}),a.jsxs(ye,{children:[a.jsx("a",{children:"Enter New Name"}),a.jsx("br",{}),a.jsx(B,{type:"text",placeholder:Y,value:y,onChange:e=>A(e.target.value)})]}),a.jsxs(ke,{children:[a.jsx(T,{color:"secondary",onClick:()=>d(!1),children:"Close"}),a.jsx(T,{color:"primary",onClick:()=>se(),children:"Save changes"})]})]})]})};export{ze as default};
