import{x as N,r as o,z as l,j as e,L as m,i as R}from"./index-CPWz2mBo.js";import{a as D}from"./axios-B4uVmeYG.js";import{b as z,a as c}from"./CContainer-DVjuDtow.js";import{C as $}from"./CNavbar-BtIsg1Gz.js";import{C as B}from"./CForm-2L6OIrNj.js";import{C as I,a as _,b as H,c as g}from"./DefaultLayout-DMPR4tUM.js";import{C as F,a as q,b as M,c as i,d as J,e as h}from"./CTable-CHBcUNK4.js";import{C as K,a as v}from"./CPaginationItem-BKIV6uSe.js";const ee=()=>{const[{user:x,token:d},r]=N(),[C,f]=o.useState(""),[w,j]=o.useState("All Cities"),[G,P]=o.useState([]),[u,k]=o.useState(0),[S,y]=o.useState(!0),[L,b]=o.useState(!1),p=t=>{t==="all"?(f(""),j("All Cities")):(f(t),j(t))};o.useEffect(()=>{x&&d&&n(0)},[x,C]);const n=(t,a)=>{b(!0),D.get(`https://15.160.211.157/market/groups/fetch/${t}?city=${C}`,{headers:{Authorization:`Bearer ${d}`}}).then(s=>{console.log(s.status),s.status===200?(P(s.data),b(!1),s.data.length<20?(y(!0),console.log("ok")):s.data.length>19&&y(!1)):s.status===500&&r({type:l,payload:{status:!0,title:"Makrket Group loading error",message:s.data.message}})}).catch(s=>{console.error("Error:",s)})},T=()=>{const t=u+20;k(t),n(t)},A=()=>{const t=u-20;console.log(t),k(t),n(t)},E=t=>{console.log(t),D.delete("https://15.160.211.157/marketgroup/"+t,{headers:{Authorization:`Bearer ${d}`}}).then(a=>{a.status===200?(r({type:l,payload:{status:!0,title:"Market Group Delete",message:"Market Group Delete Success",color:"success"}}),n(0),console.log("Remove Market Group")):a.status===203?r({type:l,payload:{status:!0,title:"Market Group Delete",message:a.data.message,color:"warning"}}):a.status===404?r({type:l,payload:{status:!0,title:"Market Group Delete",message:a.data.message,color:"warning"}}):a.status===500&&r({type:l,payload:{status:!0,title:"Market Group Delete",message:a.data.message,color:"warning"}})}).catch(a=>{console.error("Error:",a)})};return e.jsxs(z,{children:[e.jsxs($,{className:"bg-body-tertiary",children:[e.jsxs(B,{children:[e.jsx(m,{to:"/marketgroups/marketmap",children:e.jsx(c,{type:"submit",color:"success",variant:"outline",style:{marginLeft:"5px"},children:"Add Market"})}),e.jsx(m,{to:"/marketgroups/createmarketgroup",children:e.jsx(c,{type:"submit",color:"warning",variant:"outline",style:{marginLeft:"5px"},children:"Create Market Group"})})]}),e.jsxs(I,{style:{marginLeft:"40%",width:"10%",marginRight:"5px",backgroundColor:"#ff4d4d"},children:[e.jsx(_,{children:w}),e.jsxs(H,{children:[e.jsx(g,{onClick:()=>p("all"),children:"All"}),e.jsx(g,{onClick:()=>p("Milano"),children:"Milano"}),e.jsx(g,{onClick:()=>p("Napoli"),children:"Napoli"})]})]})]}),L?e.jsx(R,{}):e.jsxs(F,{children:[e.jsx(q,{children:e.jsxs(M,{children:[e.jsx(i,{scope:"col",children:"Name"}),e.jsx(i,{scope:"col",children:"City"}),e.jsx(i,{scope:"col",children:"Location"}),e.jsx(i,{scope:"col",children:"Remove"})]})}),e.jsx(J,{children:G.map((t,a)=>e.jsxs(M,{children:[e.jsx(i,{scope:"row",children:t.name}),e.jsx(h,{children:t.city}),e.jsx(h,{children:e.jsx(m,{to:`/marketgroups/marketdistance/${t._id}`,children:e.jsx(c,{size:"sm",color:"light",variant:"outline",style:{marginLeft:"5px"},children:"view"})})}),e.jsx(h,{children:e.jsx(c,{size:"sm",style:{backgroundColor:"#ff4d4d"},variant:"outline",onClick:()=>E(t._id),children:"Remove"})})]},a))})]}),e.jsxs(K,{"aria-label":"Page navigation example",children:[e.jsx(v,{disabled:u<=0,onClick:A,children:"Previous"}),e.jsx(v,{disabled:S===!0,onClick:T,children:"Next"})]})]})};export{ee as default};
