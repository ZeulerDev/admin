import{r as l,y as de,l as ue,A as n,j as e,h as $,L as y,m as b}from"./index-Cmo8jOUG.js";import{a as v}from"./axios-Cm0UX6qg.js";import{B as x}from"./config-HOLfLxHr.js";import{b as he,a as me}from"./CContainer-D7fLRyZt.js";import{C as xe}from"./CNavbar-15em09iB.js";import{C as u}from"./CFormInput-C1iM2HIO.js";import{C as G,a as Q,b as p,c as t,d as U,e as o}from"./CTable-CC7vKO1g.js";import{C as pe}from"./CCardImage-CVyhqt8j.js";import{c as je}from"./cil-pencil-m516yCOw.js";import{c as ge}from"./cil-info-CmGCY32x.js";import{C as Ce,a as Z}from"./CPaginationItem-CjQjA-61.js";import{C as Y,a as q,b as J,c as K}from"./CModalTitle-C6NN_sbf.js";import{C as fe}from"./CModalFooter-tE8B90GT.js";import{C as h}from"./CCol-B7RSY0v1.js";import"./CFormLabel-Ds_mHWoR.js";import"./DefaultLayout-CcL3hFND.js";var ye=["512 512","<rect width='288' height='32' x='112' y='152' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='288' height='32' x='112' y='240' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='152' height='32' x='112' y='328' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><path fill='var(--ci-primary-color, currentColor)' d='M480,48H32V464H480ZM448,432H64V80H448Z' class='ci-primary'/>"];const Me=()=>{const[S,E]=l.useState(!1),[{user:j,token:i},c]=de();ue();const[w,N]=l.useState([]),[W,X]=l.useState([]),[O,P]=l.useState(!1),[ee,I]=l.useState(!1),[m,B]=l.useState(0),[T,g]=l.useState(!1),[d,se]=l.useState([]),[k,A]=l.useState(),[L,z]=l.useState(),[D,H]=l.useState(),[M,V]=l.useState(),[C,ae]=l.useState(""),[te,R]=l.useState(!0);l.useEffect(()=>{j&&i&&f(0)},[j,i,C]);const f=(s,r)=>{I(!0),v.get(x+"assistant/customers/"+s+"?email="+C,{headers:{Authorization:`Bearer ${i}`}}).then(a=>{a.status===200?(N(a.data.list),I(!1),console.log(x),a.data.list.length<50?(R(!0),console.log("ok")):a.data.list.length>49&&R(!1)):a.status===500&&c({type:n,payload:{status:!0,title:"Customers loading error",message:a.data.message}})}).catch(a=>{console.error("Error:",a)})},re=()=>{const s=m+50;B(s),f(s)},oe=()=>{const s=m-50;console.log(s),B(s),f(s)},le=s=>{E(!S),i&&(P(!0),v.get(x+"assistant/addresses/customer/"+s,{headers:{Authorization:`Bearer ${i}`}}).then(r=>{r.status===200?(console.log(r.data),X(r.data),P(!1)):r.status===500&&c({type:n,payload:{status:!0,title:"Customers address error",message:r.data.message}})}).catch(r=>{console.error("Customers address:",r)}))},ie=s=>{console.log(s),g(!T),se(s),A(s.name),z(s.surname),H(s.email),V(s.contact)},ce=()=>{if(k&&L&&D&&M){const s={name:k,surname:L,email:D,contact:M},r=d.id;i&&j&&i&&v.patch(x+"assistant/customers/update/"+r,s,{headers:{Authorization:`Bearer ${i}`}}).then(a=>{if(a.status===200){g(!1);const F=a.data,ne=w.map(_=>_.id===F.id?F:_);N([...ne])}else a.status===203?c({type:n,payload:{status:!0,title:"Customer update error",message:a.data.message,color:"warning"}}):a.status===204?c({type:n,payload:{status:!0,title:"Customer update error",message:a.data.message,color:"warning"}}):a.status===500&&c({type:n,payload:{status:!0,title:"Customer update error",message:a.data.message,color:"warning"}})}).catch(a=>{console.error("Error:",a)})}else c({type:n,payload:{status:!0,title:"Error!",message:"Customer update error, Please Check the input fields",color:"warning"}})};return e.jsxs(he,{children:[e.jsx(xe,{className:"bg-body-tertiary",children:e.jsx(u,{type:"text",placeholder:"Search by customer email",style:{width:450,marginLeft:"0%"},value:C,onChange:s=>ae(s.target.value)})}),ee?e.jsx($,{}):e.jsxs(G,{children:[e.jsx(Q,{children:e.jsxs(p,{children:[e.jsx(t,{scope:"col",children:"#"}),e.jsx(t,{scope:"col",children:"Photo"}),e.jsx(t,{scope:"col",children:"Name"}),e.jsx(t,{scope:"col",children:"Surname"}),e.jsx(t,{scope:"col",children:"email"}),e.jsx(t,{scope:"col",children:"Contact"}),e.jsx(t,{scope:"col",children:"Country"}),e.jsx(t,{scope:"col",children:"Language"}),e.jsx(t,{scope:"col",children:"Edit"}),e.jsx(t,{scope:"col",children:"Address"}),e.jsx(t,{scope:"col",children:"Grocery"})]})}),e.jsx(U,{children:w.map((s,r)=>e.jsxs(p,{children:[e.jsx(o,{children:m+r+1}),e.jsx(t,{scope:"row",children:e.jsx(pe,{style:{width:50,height:50,borderRadius:10},src:"https://api.zeuler.com/image/"+s.photo})}),e.jsx(o,{children:s.name}),e.jsx(o,{children:s.surname}),e.jsx(o,{children:s.email}),e.jsx(o,{children:s.contact}),e.jsx(o,{children:s.country==="it"||s.country==="Italy"?"Italy":s.country}),e.jsx(o,{children:s.language==="en"?"English":s.language==="it"?"Italy":s.language}),e.jsx(o,{children:e.jsx(y,{children:e.jsx(b,{icon:je,size:"xl",onClick:()=>ie(s)})})}),e.jsx(o,{children:e.jsx(y,{children:e.jsx(b,{icon:ge,size:"xl",onClick:()=>le(s._id)})})}),e.jsx(o,{children:e.jsx(y,{to:`/customers/list/${s._id}`,children:e.jsx(b,{icon:ye,size:"xl"})})})]},r))})]}),e.jsxs(Ce,{"aria-label":"Page navigation example",children:[e.jsx(Z,{disabled:m<=0,onClick:oe,children:"Previous"}),e.jsx(Z,{disabled:te===!0,onClick:re,children:"Next"})]}),e.jsxs(Y,{visible:S,scrollable:!0,size:"xl",onClose:()=>E(!1),children:[e.jsx(q,{closeButton:!0,children:e.jsx(J,{children:"Order Grocery List"})}),e.jsx(K,{style:{overflowY:"auto",maxHeight:"70vh",display:"flex",justifyContent:"center"},children:O?e.jsx($,{}):e.jsxs(G,{children:[e.jsx(Q,{children:e.jsxs(p,{children:[e.jsx(t,{scope:"col",children:"#"}),e.jsx(t,{scope:"col",children:"Name"}),e.jsx(t,{scope:"col",children:"Intercom"}),e.jsx(t,{scope:"col",children:"Flat"}),e.jsx(t,{scope:"col",children:"Street"}),e.jsx(t,{scope:"col",children:"House Number"})]})}),e.jsx(U,{children:W.map((s,r)=>e.jsxs(p,{children:[e.jsx(o,{scope:"row",children:r+1}),e.jsx(o,{children:s.name}),e.jsx(o,{children:s.intercom}),e.jsx(o,{children:s.flat}),e.jsx(o,{children:s.street}),e.jsx(o,{children:s.houseNumber})]},r))})]})}),e.jsx(fe,{})]}),e.jsxs(Y,{visible:T,scrollable:!0,size:"lg",onClose:()=>g(!1),children:[e.jsx(q,{closeButton:!0,children:e.jsx(J,{children:"Edit Customer Information"})}),e.jsx(K,{children:e.jsxs("div",{className:"row g-3",children:[e.jsx(h,{md:6,children:e.jsx(u,{id:"name",label:"Firt Name",defaultValue:d.name,onChange:s=>A(s.target.value)})}),e.jsx(h,{md:6,children:e.jsx(u,{id:"surname",label:"LastName",defaultValue:d.surname,onChange:s=>z(s.target.value)})}),e.jsx(h,{md:6,children:e.jsx(u,{id:"email",label:"Email",defaultValue:d.email,onChange:s=>H(s.target.value)})}),e.jsx(h,{md:6,children:e.jsx(u,{id:"phone",label:"Contact Number",defaultValue:d.contact,onChange:s=>V(s.target.value)})}),e.jsx(h,{xs:12,children:e.jsx(me,{type:"submit",style:{marginBottom:"3%",width:"200px",backgroundColor:"#ff4d4d",color:"white"},onClick:()=>ce(),children:"Update Customer"})})]})})]})]})};export{Me as default};
