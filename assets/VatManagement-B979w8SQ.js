import{r as l,y as N,A as i,j as e,h as z}from"./index-C5Bwpkvq.js";import{a as T}from"./axios-Cm0UX6qg.js";import{B as D}from"./config-HOLfLxHr.js";import{b as L,a as f}from"./CContainer-C1WIjXH1.js";import{C as R}from"./CNavbar-BSl6MFMs.js";import{C as A}from"./CFormInput-B7GuH3nF.js";import{C as H,a as F,b as V,c as t,d as Q,e as r}from"./CTable-DFNtBtEq.js";import{d}from"./DefaultLayout-C-xguh5Y.js";import{C as U,a as Y,b as _,c as $}from"./CModalTitle-D6Hg3qg_.js";import{C as G}from"./CModalFooter-C5wvQAvz.js";import"./CFormLabel-Cogh2aXj.js";const te=()=>{const[m,h]=l.useState(!1),[{user:p,token:c},o]=N(),[x,C]=l.useState([]),[w,g]=l.useState(!1),[E,I]=l.useState(""),[y,v]=l.useState(""),[j,S]=l.useState("");l.useEffect(()=>{const s=setTimeout(()=>{o({type:i,payload:{status:!0,title:"Data Loading",message:"Data loading error: Timeout exceeded",color:"warning"}}),g(!1)},2e4);return p&&c&&B(s),()=>{clearTimeout(s)}},[j]);const B=s=>{p&&c&&(g(!0),T.get(D+"assistant/vat/riders/00?search="+j,{headers:{Authorization:`Bearer ${c}`}}).then(a=>{a.status===200?(C(a.data),g(!1),console.log("done"),clearTimeout(s)):a.status===204?o({type:i,payload:{status:!0,title:"Error",message:a.data.message,color:"warning"}}):a.status===500&&o({type:i,payload:{status:!0,title:"Error",message:a.data.message,color:"warning"}})}).catch(a=>{console.error("Error:",a)}))},b=(s,a=null)=>{h(!m),I(s),a!==null?v(a):console.log("VAT DID not provided"),console.log(s)},k=()=>{const s={vat:y};p&&c&&T.patch(D+"assistant/rider/vat/"+E,s,{headers:{Authorization:`Bearer ${c}`}}).then(a=>{if(a.status===200){console.log("updated"),h(!1);const n=a.data,u=x.find(M=>M.id===n.id);u&&(u.vat=n.vat),C([...x]),o({type:i,payload:{status:!0,title:"Driver VAT Id ",message:"VAT Id updated successfully"}})}else a.status===203?(console.log("203"),o({type:i,payload:{status:!0,title:"Driver VAT Id error",message:a.data.message}})):a.status===204?(console.log("204"),o({type:i,payload:{status:!0,title:"Driver VAT Id error",message:a.data.message}})):a.status===500&&o({type:i,payload:{status:!0,title:"Driver VAT Id update error",message:a.data.message}})}).catch(a=>{console.error(a)})};return e.jsxs(L,{children:[e.jsx(R,{className:"bg-body-tertiary",children:e.jsx(A,{type:"text",placeholder:"Search",style:{width:450,marginLeft:"0%"},value:j,onChange:s=>S(s.target.value)})}),w?e.jsx(z,{}):e.jsxs(H,{children:[e.jsx(F,{children:e.jsxs(V,{children:[e.jsx(t,{scope:"col",children:"#"}),e.jsx(t,{scope:"col",children:"Name"}),e.jsx(t,{scope:"col",children:"City"}),e.jsx(t,{scope:"col",children:"Vat"}),e.jsx(t,{scope:"col",children:"Activate"}),e.jsx(t,{scope:"col",children:"Disabled"}),e.jsx(t,{scope:"col",children:"Groups"}),e.jsx(t,{scope:"col",children:"Action"})]})}),e.jsx(Q,{children:x.map((s,a)=>e.jsxs(V,{children:[e.jsx(r,{children:a+1}),e.jsx(r,{children:s.name}),e.jsx(r,{children:s.city}),e.jsx(r,{children:s.vat?s.vat:e.jsx(d,{color:"warning",children:"Null"})}),e.jsx(r,{children:s.activate?e.jsx(d,{color:"success",children:"Yes"}):e.jsx(d,{color:"warning",children:"No"})}),e.jsx(r,{children:s.disabled?e.jsx(d,{color:"success",children:"No"}):e.jsx(d,{color:"warning",children:"Yes"})}),e.jsx(r,{children:s.groups.map((n,u)=>e.jsx("div",{children:n.name},u))}),e.jsx(r,{children:s.vat===""?e.jsx(f,{size:"sm",style:{backgroundColor:"#ff4d4d",width:70,color:"white"},onClick:()=>b(s.id,s.vat),children:"Insert "}):e.jsx(f,{size:"sm",style:{backgroundColor:"#ff4d4d",width:70,color:"white"},onClick:()=>b(s.id,s.vat),children:"Edit "})})]},a))})]}),e.jsxs(U,{alignment:"center",visible:m,scrollable:!0,size:"sm",onClose:()=>h(!1),children:[e.jsx(Y,{closeButton:!0,children:e.jsx(_,{children:"Confirmation"})}),e.jsxs($,{children:[e.jsx("a",{children:"Enter Driver's VAT id here"}),e.jsx("br",{}),e.jsx(A,{type:"text",placeholder:"Vat id",value:y,onChange:s=>v(s.target.value)})]}),e.jsx(G,{children:e.jsx(f,{style:{backgroundColor:"#ff4d4d",color:"white"},onClick:()=>k(),children:"Save changes"})})]})]})};export{te as default};
