import{r as a,y as _e,l as Ue,A as o,j as e,L as ge,h as Ye,m as je}from"./index-BxH1rakr.js";import{a as f}from"./axios-Cm0UX6qg.js";/* empty css               */import{B as g}from"./config-HOLfLxHr.js";import{b as qe,a as u}from"./CContainer-ylatMxJB.js";import{d as Ce,C as N,a as B,b as I,c as m}from"./DefaultLayout-Bcif4Pss.js";import{C as Je}from"./CNavbar-Biexb92H.js";import{C as p}from"./CFormInput-BenDwOPe.js";import{C as Ke,a as Qe,b as ye,c as i,d as We,e as n}from"./CTable-Bx9QinPx.js";import{c as Xe}from"./cil-pencil-m516yCOw.js";import{c as Ze}from"./cil-trash-CBbKHhHb.js";import{C as M,a as z,b as T,c as G}from"./CModalTitle-DB18yAI6.js";import{C as h}from"./CCol-B7zMXfy9.js";import{C as Oe}from"./CFormSelect-B_DbtZxV.js";import"./CFormLabel-CIPrM9rP.js";const xt=()=>{const[V,j]=a.useState(!1),[P,C]=a.useState(!1),[{user:b,token:c},l]=_e(),[D,k]=a.useState([]),[ve,R]=a.useState(!1),[$,F]=a.useState(""),[H,_]=a.useState(""),[U,Y]=a.useState(""),[y,be]=a.useState(""),[S,q]=a.useState(!1),[J,K]=a.useState("");Ue();const[De,ke]=a.useState(!1),[Se,Q]=a.useState("All Cities"),[we,W]=a.useState("All Market Groups"),[Ae,X]=a.useState("All Chains"),[Ee,Le]=a.useState([]),[Ne,Be]=a.useState([]),[Z,w]=a.useState(!1),[d,Ie]=a.useState([]),[O,ee]=a.useState(),[te,se]=a.useState(),[ae,le]=a.useState(),[re,oe]=a.useState(),[ie,ne]=a.useState(),[A,ce]=a.useState(),[Me,de]=a.useState(),[ue,he]=a.useState(),[ze,Te]=a.useState();a.useEffect(()=>{Ge(),Ve()},[]);const Ge=()=>{c&&f.get(g+"market/groups/dropdown/fetch",{headers:{Authorization:`Bearer ${c}`}}).then(t=>{t.status===200?Le(t.data):t.status===500&&l({type:o,payload:{status:!0,title:"Market Group Loading error",message:t.data.message}})}).catch(t=>{console.error("Error: ",t)})},Ve=()=>{c&&f.get(g+"assistant/market/chains/all",{headers:{Authorization:`Bearer ${c}`}}).then(t=>{t.status===200?(Be(t.data),ke(!1)):t.status===500&&l({type:o,payload:{status:!0,title:"Chain Loading error",message:t.data.message}})}).catch(t=>{console.error("Error: ",t)})};a.useEffect(()=>{E()},[$,H,U,y,De]);const E=()=>{if(b&&c){R(!0);let t=g+`assistant/riders/:skip?city=${$}&group=${H}&chain=${U}`;y&&(t+=`&code=${y}`),f.get(t,{headers:{Authorization:`Bearer ${c}`}}).then(s=>{s.status===200?(k(s.data),R(!1)):s.status===500&&l({type:o,payload:{status:!0,title:"Error",message:s.data.message,color:"warning"}})}).catch(s=>{console.error("Error:",s)})}},L=t=>{t==="all"?(F(""),Q("All Cities")):(F(t),Q(t))},pe=(t,s)=>{t==="all"?(_(""),W("All Market Groups")):(_(t),W(s))},me=(t,s)=>{t==="all"?(Y(""),X("All Chains")):(Y(t),X(s))},xe=(t,s)=>{j(!V),q(s),K(t)},Pe=()=>{const t={status:S};console.log(S),console.log(J,t),b&&c&&f.patch(g+"assistant/rider/status/"+J,t,{headers:{Authorization:`Bearer ${c}`}}).then(s=>{if(s.status===200){console.log("updated",s.data),j(!1),q(""),K("");const r=s.data,x=D.map(v=>v.id===r.id?r:v);k([...x]),l({type:o,payload:{status:!0,title:"Driver status update",message:"Driver status updated successfully",color:"success"}})}else s.status===203?l({type:o,payload:{status:!0,title:"Driver status update error",message:s.data.message}}):s.status===204?l({type:o,payload:{status:!0,title:"Driver status update error",message:s.data.message}}):s.status===500&&l({type:o,payload:{status:!0,title:"Driver status update error",message:s.data.message}})}).catch(s=>{console.error(s)})},Re=t=>{w(!Z),Ie(t),ee(t.name),se(t.surname),le(t.email),oe(t.contact),ne(t.iban),ce(t.city),he(t.address),de(t.vat)},$e=()=>{if(O&&te&&ae&&re&&ie&&A&&ue){const t={name:O,surname:te,email:ae,contact:re,iban:ie,city:A,vat:Me,address:ue},s=d.id;c&&b&&c&&f.patch(g+"assistant/rider/update/"+s,t,{headers:{Authorization:`Bearer ${c}`}}).then(r=>{if(r.status===200){w(!1);const x=r.data,v=D.map(fe=>fe.id===x.id?x:fe);k([...v]),E(),l({type:o,payload:{status:!0,title:"Driver update",message:"Driver updated successfully",color:"success"}})}else r.status===203?l({type:o,payload:{status:!0,title:"Driver update error",message:"Email already exist",color:"warning"}}):r.status===204?(console.log(r.message),l({type:o,payload:{status:!0,title:"Driver update error",message:"Something is missing",color:"warning"}})):r.status===404?(console.log(r.message),l({type:o,payload:{status:!0,title:"Driver update error",message:"Driver not found",color:"warning"}})):r.status===500&&l({type:o,payload:{status:!0,title:"Driver update error",message:r.data.message,color:"warning"}})}).catch(r=>{console.error("Error:",r)})}else l({type:o,payload:{status:!0,title:"Error!",message:"Picker update error, Please Check the input fields",color:"warning"}})},Fe=t=>{C(!P),Te(t)},He=t=>{f.delete(g+"assistant/rider/delete/"+t,{headers:{Authorization:`Bearer ${c}`}}).then(s=>{s.status===200?(l({type:o,payload:{status:!0,title:"Driver Delete",message:"Driver deleted successfully",color:"success"}}),C(!1),E()):s.status===404?l({type:o,payload:{status:!0,title:"Driver remove error",message:s.data.message}}):s.status===500&&l({type:o,payload:{status:!0,title:"Driver remove error",message:s.data.message}})}).catch(s=>{console.error("Error:",s)})};return e.jsxs(qe,{children:[e.jsx(ge,{to:"/driver/adddriver",className:"picker-link",children:e.jsx(u,{style:{marginLeft:"0%",width:"17%",backgroundColor:"#ff4d4d",color:"white"},children:"Add Driver"})}),e.jsx(Ce,{style:{marginLeft:"20%"},color:"secondary",children:"Filter by"}),e.jsxs(N,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d",color:"white"},children:[e.jsx(B,{style:{color:"white"},children:Se}),e.jsxs(I,{children:[e.jsx(m,{onClick:()=>L("all"),children:"All"}),e.jsx(m,{onClick:()=>L("Milan"),children:"Milan"}),e.jsx(m,{onClick:()=>L("Napoli"),children:"Napoli"})]})]}),e.jsxs(N,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d",color:"white"},children:[e.jsx(B,{style:{color:"white"},children:Ae}),e.jsxs(I,{children:[e.jsx(m,{onClick:()=>me("all"),children:"All"}),Ne.map((t,s)=>e.jsx(m,{onClick:()=>me(t.id,t.name),children:t.name},s))]})]}),e.jsxs(N,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d",color:"white"},children:[e.jsx(B,{style:{color:"white"},children:we}),e.jsxs(I,{children:[e.jsx(m,{onClick:()=>pe("all"),children:"All"}),Ee.map((t,s)=>e.jsx(m,{onClick:()=>pe(t._id,t.name),children:t.name},s))]})]}),e.jsx(Je,{className:"bg-body-tertiary",children:e.jsx(p,{type:"text",placeholder:"Search by Driver ID",style:{width:450,marginLeft:"0%"},value:y,onChange:t=>be(t.target.value)})}),ve?e.jsx(Ye,{}):e.jsxs(Ke,{children:[e.jsx(Qe,{children:e.jsxs(ye,{children:[e.jsx(i,{scope:"col",children:"#"}),e.jsx(i,{scope:"col",children:"Id"}),e.jsx(i,{scope:"col",children:"First Name"}),e.jsx(i,{scope:"col",children:"Last Name"}),e.jsx(i,{scope:"col",children:"Email"}),e.jsx(i,{scope:"col",children:"Phone"}),e.jsx(i,{scope:"col",children:"Country"}),e.jsx(i,{scope:"col",children:"Employee ID"}),e.jsx(i,{scope:"col",children:"Language"}),e.jsx(i,{scope:"col",children:"Group"}),e.jsx(i,{scope:"col",children:"Edit"}),e.jsx(i,{scope:"col",children:"Edit Status"}),e.jsx(i,{scope:"col",children:"Action"})]})}),e.jsx(We,{children:D.map((t,s)=>e.jsxs(ye,{children:[e.jsx(n,{children:s+1}),e.jsx(n,{children:t.code}),e.jsx(n,{children:t.name}),e.jsx(n,{children:t.surname}),e.jsx(n,{children:t.email}),e.jsx(n,{children:t.contact}),e.jsx(n,{children:t.country==="it"||t.country==="Italy"?"Italy":t.country}),e.jsx(n,{children:t.employeeId?t.employeeId:e.jsx(Ce,{color:"warning",children:"Not Provide"})}),e.jsx(n,{children:t.language==="en"?"English":t.language==="it"?"Italy":t.language==="es"?"Spanish":t.language}),e.jsx(n,{children:t.groups.map((r,x)=>e.jsx("div",{children:r.name},x))}),e.jsx(n,{children:e.jsx(ge,{children:e.jsx(je,{icon:Xe,size:"xl",onClick:()=>Re(t)})})}),e.jsx(n,{children:t.activate?e.jsx(u,{size:"sm",onClick:()=>xe(t.id,!1),style:{backgroundColor:"#ff4d4d",width:90,color:"white"},children:"Deactivate"}):e.jsx(u,{size:"sm",onClick:()=>xe(t.id,!0),style:{backgroundColor:"#ff4d4d",width:90,color:"white"},children:"Activate"})}),e.jsx(n,{children:e.jsx(u,{size:"sm",style:{backgroundColor:"#ff4d4d"},variant:"outline",onClick:()=>Fe(t.id),children:e.jsx(je,{icon:Ze,size:"lg",style:{color:"white"}})})})]},s))})]}),e.jsxs(M,{alignment:"center",visible:P,scrollable:!0,size:"sm",onClose:()=>C(!1),children:[e.jsx(z,{closeButton:!1,children:e.jsx(T,{children:"Confirmation"})}),e.jsxs(G,{children:[e.jsx("a",{children:"Are you sure you want to delete this driver?"}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{style:{display:"flex",justifyContent:"center"},children:[e.jsx(u,{onClick:()=>He(ze),style:{backgroundColor:"#ff4d4d",color:"white",marginRight:"10px"},children:"Yes"}),e.jsx(u,{onClick:()=>C(!1),style:{backgroundColor:"#ff4d4d",color:"white",marginLeft:"10px"},children:"No"})]})]})]}),e.jsxs(M,{alignment:"center",visible:V,scrollable:!0,size:"sm",onClose:()=>j(!1),children:[e.jsx(z,{closeButton:!1,children:e.jsx(T,{children:"Confirmation"})}),e.jsxs(G,{children:[e.jsxs("a",{children:["Are you sure you want to ",S?"activate":"deactivate"," this driver?"]}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{style:{display:"flex",justifyContent:"center"},children:[e.jsx(u,{onClick:()=>Pe(),style:{backgroundColor:"#ff4d4d",color:"white",marginRight:"10px"},children:"Yes"}),e.jsx(u,{onClick:()=>j(!1),style:{backgroundColor:"#ff4d4d",color:"white",marginLeft:"10px"},children:"No"})]})]})]}),e.jsxs(M,{visible:Z,scrollable:!0,size:"lg",onClose:()=>w(!1),children:[e.jsx(z,{closeButton:!0,children:e.jsx(T,{children:"Edit Driver Information"})}),e.jsx(G,{children:e.jsxs("div",{className:"row g-3",children:[e.jsx(h,{md:6,children:e.jsx(p,{id:"name",label:"Firt Name",defaultValue:d.name,onChange:t=>ee(t.target.value)})}),e.jsx(h,{md:6,children:e.jsx(p,{id:"surname",label:"LastName",defaultValue:d.surname,onChange:t=>se(t.target.value)})}),e.jsx(h,{md:6,children:e.jsx(p,{id:"address",label:"Address",defaultValue:d.address,onChange:t=>he(t.target.value)})}),e.jsx(h,{md:6,children:e.jsx(p,{id:"email",label:"Email",defaultValue:d.email,onChange:t=>le(t.target.value)})}),e.jsx(h,{md:6,children:e.jsx(p,{id:"phone",label:"Contact Number",defaultValue:d.contact,onChange:t=>oe(t.target.value)})}),e.jsx(h,{md:6,children:e.jsx(p,{id:"iban",label:"IBAN",defaultValue:d.iban,onChange:t=>ne(t.target.value)})}),e.jsx(h,{md:6,children:e.jsx(p,{id:"vat",label:"Vat",defaultValue:d.vat,onChange:t=>de(t.target.value)})}),e.jsx(h,{md:6,children:e.jsxs(Oe,{id:"inputState",label:"City",value:A,onChange:t=>ce(t.target.value),children:[e.jsx("option",{children:d.city}),e.jsx("option",{children:"Milano"}),e.jsx("option",{children:"Napoli"})]})}),e.jsx(h,{xs:12,children:e.jsx(u,{style:{marginBottom:"3%",width:"200px",backgroundColor:"#ff4d4d",color:"white"},onClick:()=>$e(),children:"Update Rider"})})]})})]})]})};export{xt as default};
