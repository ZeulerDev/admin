import{y as ge,r,A as l,j as e,h as xe,L as Ce,m as fe}from"./index-DCIC8fO6.js";import{a as x}from"./axios-Cm0UX6qg.js";import{B as F}from"./config-HOLfLxHr.js";import{b as je,a as ye}from"./CContainer-Dhr2RTMc.js";import{C as H,a as M,b as A,c as N,d}from"./DefaultLayout-C0sUmu94.js";import{C as ke}from"./CNavbar-R1oxGH4k.js";import{C as _}from"./CFormInput-S43P1cjW.js";import{C as Pe,a as be,b as Q,c,d as Se,e as h}from"./CTable-Bvq_3Do7.js";import{C as De}from"./CCardImage-l6bmM88m.js";import{c as Me}from"./cil-pencil-m516yCOw.js";import{C as Ae,a as B}from"./CPaginationItem-Dt9jjho8.js";import{C as Ne,a as Be,b as Ee,c as Ie}from"./CModalTitle-CmK17VBN.js";import{C as Te}from"./CModalFooter-DFO6hTF8.js";import"./CFormLabel-BFz3Pslt.js";const Oe=()=>{const[{user:C,token:n},o]=ge(),[V,E]=r.useState(!1),[q,G]=r.useState([]),[p,f]=r.useState(0),[J,m]=r.useState(!0),[K,O]=r.useState([]),[W,j]=r.useState("All Chains"),[X,I]=r.useState("All market"),[ve,y]=r.useState(""),[T,v]=r.useState(""),[Y,Z]=r.useState([]),[k,ee]=r.useState(""),[te,P]=r.useState(!1),[ae,w]=r.useState(""),[b,L]=r.useState(""),[se,R]=r.useState(""),[re,oe]=r.useState(0),[g,S]=r.useState(1),[$,D]=r.useState("NAME");r.useEffect(()=>{C&&n&&u(0)},[C,n,T,k]),r.useEffect(()=>{n&&x.get("http://localhost:8003/assistant/market/chains/all",{headers:{Authorization:`Bearer ${n}`}}).then(t=>{t.status===200?O(t.data):t.status===500&&o({type:l,payload:{status:!0,title:"Chain Loading error",message:t.data.message}})}).catch(t=>{console.error("Error: ",t)})},[]);const le=t=>{x.get(`http://localhost:8003/assistant/market/locations?brand=${t}`,{headers:{Authorization:`Bearer ${n}`}}).then(a=>{a.status===200?(Z(a.data.data),a.data.data.length<20?(m(!0),console.log("ok")):a.data.data.length>19&&m(!1)):a.status===500&&o({type:l,payload:{status:!0,title:"Market Loading error",message:a.data.message}})}).catch(a=>{console.error("Error: ",a)})},u=(t,a)=>{E(!0),x.get(F+`product/all/${t}?marketId=${T}&name=${k}&type=${$}`,{headers:{Authorization:`Bearer ${n}`}}).then(s=>{s.status===200?(G(s.data.list),oe(s.data.count),E(!1),s.data.list.length<20?(m(!0),console.log("ok")):s.data.list.length>19&&m(!1)):s.status===203?o({type:l,payload:{status:!0,title:"product loading error error",message:s.data.message}}):s.status===204?o({type:l,payload:{status:!0,title:"No Products",message:"No products found in this market address",color:"info"}}):s.status===500&&o({type:l,payload:{status:!0,title:"product loading error error",message:s.data.message}})}).catch(s=>{console.error("Error:",s)})},z=(t,a)=>{t==="all"?(y(""),j("All Chains")):(y(t),le(t),j(a))},U=(t,a)=>{t==="all"?(v(""),I("All Markets"),y(""),j("All Chains")):(v(t),I(a))},ce=()=>{S(g+1);const t=p+50;f(t),u(t)},ne=()=>{S(g-1);const t=p-50;console.log(t),f(t),u(t)},ie=(t,a)=>{P(!0),w(t),R(a)},de=()=>{console.log("called"),b==""?o({type:l,payload:{status:!0,title:"Alert",message:"Please enter the price",color:"warning"}}):pe(ae)},he=t=>{S(t);const a=(t-1)*50;f(a),u(a)},ue=()=>{const t=Math.ceil(re/50),a=[];for(let i=1;i<=t;i++)a.push(i);const s=Math.max(g-2,1),me=Math.min(s+4,t);return a.slice(s-1,me).map(i=>e.jsx(B,{active:g===i,onClick:()=>he(i),children:i},i))},pe=t=>{if(t){let a={price:b+" â‚¬"};C&&n&&x.put(F+"product/update/price/"+t,a,{headers:{Authorization:`Bearer ${n}`}}).then(s=>{s.status===200?(o({type:l,payload:{status:!0,title:"Product Details Update",message:"Product price update Success",color:"success"}}),w(""),L(""),u(0),P(!1),R("")):s.status===204?o({type:l,payload:{status:!0,title:"Product Details Update error",message:s.data.message,color:"danger"}}):s.status===500&&o({type:l,payload:{status:!0,title:"Product Details Update error",message:s.data.message,color:"danger"}})}).catch(s=>{console.error("Error:",s)})}else alert("Please Check the Fields!")};return e.jsxs(je,{children:[e.jsx(H,{style:{marginLeft:"57%"},color:"secondary",children:"Filter by"}),e.jsxs(M,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[e.jsx(A,{children:W}),e.jsxs(N,{children:[e.jsx(d,{onClick:()=>z("all"),children:"All"}),K.map((t,a)=>e.jsx(d,{onClick:()=>z(t.id,t.name),children:t.name},a))]})]}),e.jsxs(M,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[e.jsx(A,{children:X}),e.jsxs(N,{children:[e.jsx(d,{onClick:()=>U("all"),children:"Select the Chain"}),Y.map((t,a)=>e.jsx(d,{onClick:()=>U(t._id,t.address),children:t.address},a))]})]}),e.jsxs(ke,{style:{marginTop:"1%"},className:"bg-body-tertiary",children:[e.jsx(H,{style:{marginLeft:"0.2%"},color:"secondary",children:"Select the seatch type"}),e.jsxs(M,{style:{marginRight:"0%",width:"17%",backgroundColor:"#ff4d4d"},children:[e.jsxs(A,{children:[$," "]}),e.jsxs(N,{children:[e.jsx(d,{onClick:()=>D("NAME"),children:"By Name"}),e.jsx(d,{onClick:()=>D("ID"),children:"By Product Id"}),e.jsx(d,{onClick:()=>D("BRAND"),children:"By BRAND NAME"})]})]}),e.jsx(_,{type:"text",placeholder:"Search here",style:{width:450,marginRight:"30%"},value:k,onChange:t=>ee(t.target.value)})]}),V?e.jsx(xe,{}):e.jsxs(Pe,{children:[e.jsx(be,{children:e.jsxs(Q,{children:[e.jsx(c,{scope:"col",children:"#"}),e.jsx(c,{scope:"col",children:"Product Id"}),e.jsx(c,{scope:"col",children:"Photo"}),e.jsx(c,{scope:"col",children:"Name"}),e.jsx(c,{scope:"col",children:"Price"}),e.jsx(c,{scope:"col",children:"Brand"}),e.jsx(c,{scope:"col",children:"Chain"}),e.jsx(c,{scope:"col",children:"Market Address"})]})}),e.jsx(Se,{children:q.map((t,a)=>e.jsxs(Q,{children:[e.jsx(h,{children:p+a+1}),e.jsx(h,{children:t.pid}),e.jsx(c,{onClick:()=>{console.log("click image")},children:e.jsx(De,{style:{width:"50px",height:"50px"},src:"https://api.zeuler.com/image/"+t.image})}),e.jsx(h,{children:t.name}),e.jsxs(h,{children:[t.price,e.jsx(Ce,{to:"",children:e.jsx(fe,{icon:Me,size:"sm",onClick:()=>ie(t.productId,t.price)})})]}),e.jsx(h,{children:t.brand}),e.jsx(h,{children:t.chainName}),e.jsx(h,{children:t.marketAddress})]},a))})]}),e.jsxs(Ae,{"aria-label":"Page navigation example",children:[e.jsx(B,{disabled:p<=0,onClick:ne,children:"Previous"}),ue(),e.jsx(B,{disabled:J===!0,onClick:ce,children:"Next"})]}),e.jsxs(Ne,{alignment:"center",visible:te,scrollable:!0,size:"sm",onClose:()=>P(!1),children:[e.jsx(Be,{closeButton:!0,children:e.jsx(Ee,{children:"Change Price"})}),e.jsxs(Ie,{children:[e.jsx("a",{children:"Enter New Name"}),e.jsx("br",{}),e.jsx(_,{type:"text",placeholder:se,value:b,onChange:t=>L(t.target.value)})]}),e.jsx(Te,{children:e.jsx(ye,{style:{backgroundColor:"#ff4d4d",color:"white"},onClick:()=>de(),children:"Save changes"})})]})]})};export{Oe as default};
