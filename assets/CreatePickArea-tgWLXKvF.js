import{r,y as B,A as p,j as e,m as L}from"./index-D3KQsf9W.js";import{E as P}from"./leaflet.draw-DdViCsJs.js";import{M as R,T,P as v}from"./leaflet-D_BMRS8M.js";import{a as x}from"./axios-Cm0UX6qg.js";import{B as y}from"./config-HOLfLxHr.js";import{b as z,a as j}from"./CContainer-DeYOFS1t.js";import{C as D}from"./CNavbar-8Vz5wnKh.js";import{C as F,a as G,b as I,c as k}from"./DefaultLayout-2NlSY9ji.js";import{M as _}from"./Marker-CEp1ZkrY.js";import{c as $}from"./cil-info-CmGCY32x.js";import{F as H}from"./FeatureGroup-_0zup9Xv.js";import{C as O,a as U,b as V,c as W}from"./CModalTitle-CaH6arnE.js";import{C as Z}from"./CFormInput-DDDSfwu-.js";import{C as q}from"./CModalFooter-BZDbv7_x.js";import"./index-C6_K5ivz.js";import"./CFormLabel-BuEYAOkN.js";function de(){const M=r.useRef(null),[{user:i,token:s},l]=B(),[n,d]=r.useState("Napoli"),[m,u]=r.useState("Napoli"),[b,S]=r.useState([]),[c,f]=r.useState(""),[E,o]=r.useState(!1),[h,w]=r.useState([]),A=t=>{const a=t.layerType,C=t.layer;console.log(a),console.log("layer",C._latlngs),o(!0),w(C._latlngs)},N=()=>{if(o(!1),n&&c&&h){const t={area:h,name:c,city:m};console.log(t),i&&s&&x.post(y+"pickup/area/create",t,{headers:{Authorization:`Bearer ${s}`}}).then(a=>{a.status===200?(l({type:p,payload:{status:!0,title:"Pickup Area Registration",message:"Pick up area registration Success",color:"success"}}),f("")):a.status===500&&l({type:p,payload:{status:!0,title:"Pick up area registration  error",message:a.data.message,color:"danger"}})}).catch(a=>{console.error("Error:",a)})}else alert("Please Check the Fields!")},g=t=>{t==="all"?(d(""),u("Napoli")):(d(t),u(t))};return r.useEffect(()=>{i&&s&&x.get(y+`assistant/markets/groups/locations/pickup/${n}`,{headers:{Authorization:`Bearer ${s}`}}).then(t=>{t.status===200?S(t.data):t.status===500&&l({type:p,payload:{status:!0,title:"Market Group loading error",message:t.data.message}})}).catch(t=>{console.error("Error:",t)})},[i,n]),e.jsxs(z,{children:[e.jsx(D,{className:"bg-body-tertiary",children:e.jsxs(F,{style:{marginLeft:"90%",width:"10%",marginRight:"5px",backgroundColor:"#ff4d4d"},children:[e.jsx(G,{children:m}),e.jsxs(I,{children:[e.jsx(k,{onClick:()=>g("Napoli"),children:"Napoli"}),e.jsx(k,{onClick:()=>g("Milano"),children:"Milano"})]})]})}),e.jsxs(R,{dragging:!0,center:[40.85631,14.24641],zoom:13,scrollWheelZoom:!0,style:{height:"500px",width:"100%"},children:[e.jsx(T,{attribution:'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),b.map((t,a)=>e.jsx(_,{position:[t.lat,t.lng],children:e.jsx(v,{children:e.jsxs("div",{children:[e.jsx(L,{icon:$,size:"lg",style:{marginLeft:"10px"}})," ",e.jsx("span",{children:t.address})]})})},a)),e.jsx(H,{ref:M,children:e.jsx(P,{position:"topright",onCreated:A,draw:{polygon:!0,circle:!0,polyline:!1,marker:!1,circlemarker:!1}})})]}),e.jsxs(O,{alignment:"center",visible:E,scrollable:!0,size:"sm",onClose:()=>o(!1),children:[e.jsx(U,{closeButton:!0,children:e.jsx(V,{children:"Confirmation"})}),e.jsxs(W,{children:[e.jsx("a",{children:"Enter name for selected area"}),e.jsx("br",{}),e.jsx(Z,{type:"text",value:c,onChange:t=>f(t.target.value)})]}),e.jsxs(q,{children:[e.jsx(j,{color:"secondary",onClick:()=>o(!1),children:"Close"}),e.jsx(j,{color:"primary",onClick:()=>N(),children:"Save area"})]})]})]})}export{de as default};
