import{r as t,y as Ve,l as ze,A as c,j as e,L as ue,i as Le,m as $e}from"./index-AYqcHeD4.js";import{a as C}from"./axios-Cm0UX6qg.js";/* empty css               */import{B as j}from"./config-HOLfLxHr.js";import{b as Re,a as p}from"./CContainer-WLeCJSt9.js";import{C as Fe}from"./CNavbar-Dfw1TMqb.js";import{C as h}from"./CFormInput-hkwTe5tV.js";import{C as w,a as N,b as M,c as m,e as He}from"./DefaultLayout-Hp1CfVoz.js";import{C as _e,a as Ue,b as he,c as o,d as Ye,e as n}from"./CTable-Cl-87Af2.js";import{c as qe}from"./cil-pencil-m516yCOw.js";import{C as pe,a as me,b as xe,c as Ce}from"./CModalTitle-Bffx4EKX.js";import{C as je}from"./CModalFooter-B1tqGzsx.js";import{C as u}from"./CCol-CxiQLVdN.js";import{C as Je}from"./CFormSelect-D5VpS_XG.js";import"./CFormLabel-BYWnOsul.js";const ca=()=>{const[B,g]=t.useState(!1),[{user:v,token:r},i]=Ve(),[b,S]=t.useState([]),[ge,I]=t.useState(!1),[P,G]=t.useState(""),[T,V]=t.useState(""),[z,L]=t.useState(""),[f,fe]=t.useState(""),[A,$]=t.useState(!1),[R,F]=t.useState("");ze();const[ye,ke]=t.useState(!1),[ve,H]=t.useState("All Cities"),[be,_]=t.useState("All Market Groups"),[Se,U]=t.useState("All Chains"),[Ae,De]=t.useState([]),[Ee,we]=t.useState([]),[Y,y]=t.useState(!1),[d,Ne]=t.useState([]),[q,J]=t.useState(),[K,Q]=t.useState(),[W,X]=t.useState(),[Z,O]=t.useState(),[ee,ae]=t.useState(),[D,se]=t.useState(),[te,le]=t.useState(),[re,oe]=t.useState();t.useEffect(()=>{Me(),Be()},[]);const Me=()=>{r&&C.get(j+"market/groups/dropdown/fetch",{headers:{Authorization:`Bearer ${r}`}}).then(a=>{a.status===200?De(a.data):a.status===500&&i({type:c,payload:{status:!0,title:"Market Group Loading error",message:a.data.message}})}).catch(a=>{console.error("Error: ",a)})},Be=()=>{r&&C.get(j+"assistant/market/chains/all",{headers:{Authorization:`Bearer ${r}`}}).then(a=>{a.status===200?(we(a.data),ke(!1)):a.status===500&&i({type:c,payload:{status:!0,title:"Chain Loading error",message:a.data.message}})}).catch(a=>{console.error("Error: ",a)})};t.useEffect(()=>{Ie()},[P,T,z,f,ye]);const Ie=()=>{if(v&&r){I(!0);let a=j+`assistant/riders/:skip?city=${P}&group=${T}&chain=${z}`;f&&(a+=`&code=${f}`),C.get(a,{headers:{Authorization:`Bearer ${r}`}}).then(s=>{s.status===200?(S(s.data),I(!1)):s.status===500&&i({type:c,payload:{status:!0,title:"Error",message:s.data.message,color:"warning"}})}).catch(s=>{console.error("Error:",s)})}},E=a=>{a==="all"?(G(""),H("All Cities")):(G(a),H(a))},ne=(a,s)=>{a==="all"?(V(""),_("All Market Groups")):(V(a),_(s))},ie=(a,s)=>{a==="all"?(L(""),U("All Chains")):(L(a),U(s))},ce=(a,s)=>{g(!B),$(s),F(a)},Pe=()=>{const a={status:A};console.log(A),console.log(R,a),v&&r&&C.patch(j+"assistant/rider/status/"+R,a,{headers:{Authorization:`Bearer ${r}`}}).then(s=>{if(s.status===200){console.log("updated",s.data),g(!1),$(""),F("");const l=s.data,x=b.map(k=>k.id===l.id?l:k);S([...x])}else s.status===203?i({type:c,payload:{status:!0,title:"Driver status update error",message:s.data.message}}):s.status===204?i({type:c,payload:{status:!0,title:"Driver status update error",message:s.data.message}}):s.status===500&&i({type:c,payload:{status:!0,title:"Driver status update error",message:s.data.message}})}).catch(s=>{console.error(s)})},Ge=a=>{y(!Y),Ne(a),J(a.name),Q(a.surname),X(a.email),O(a.contact),ae(a.iban),se(a.city),oe(a.address),le(a.vat)},Te=()=>{if(q&&K&&W&&Z&&ee&&D&&te&&re){const a={name:q,surname:K,email:W,contact:Z,iban:ee,city:D,vat:te,address:re},s=d.id;r&&v&&r&&C.patch(j+"assistant/rider/update/"+s,a,{headers:{Authorization:`Bearer ${r}`}}).then(l=>{if(l.status===200){y(!1);const x=l.data,k=b.map(de=>de.id===x.id?x:de);S([...k])}else l.status===203?i({type:c,payload:{status:!0,title:"Picker update error",message:l.data.message,color:"warning"}}):l.status===204?(console.log(l.message),i({type:c,payload:{status:!0,title:"Picker update error",message:"Email Already include",color:"warning"}})):l.status===500&&i({type:c,payload:{status:!0,title:"Picker update error",message:l.data.message,color:"warning"}})}).catch(l=>{console.error("Error:",l)})}else i({type:c,payload:{status:!0,title:"Error!",message:"Picker update error, Please Check the input fields",color:"warning"}})};return e.jsxs(Re,{children:[e.jsxs(Fe,{className:"bg-body-tertiary picker-navbar",children:[e.jsx(h,{type:"text",placeholder:"Search by Driver ID",className:"picker-input",value:f,onChange:a=>fe(a.target.value)}),e.jsx(ue,{to:"/picker/addpicker",className:"picker-link",children:e.jsx(p,{type:"submit",color:"success",variant:"outline",className:"picker-button",children:"Add Picker"})}),e.jsxs(w,{className:"picker-dropdown",style:{backgroundColor:"#ff4d4d"},children:[e.jsx(N,{children:ve}),e.jsxs(M,{children:[e.jsx(m,{onClick:()=>E("all"),children:"All"}),e.jsx(m,{onClick:()=>E("Milan"),children:"Milan"}),e.jsx(m,{onClick:()=>E("Napoli"),children:"Napoli"})]})]}),e.jsxs(w,{className:"picker-dropdown",style:{backgroundColor:"#ff4d4d"},children:[e.jsx(N,{children:Se}),e.jsxs(M,{children:[e.jsx(m,{onClick:()=>ie("all"),children:"All"}),Ee.map((a,s)=>e.jsx(m,{onClick:()=>ie(a.id,a.name),children:a.name},s))]})]}),e.jsxs(w,{className:"picker-dropdown",style:{backgroundColor:"#ff4d4d"},children:[e.jsx(N,{children:be}),e.jsxs(M,{children:[e.jsx(m,{onClick:()=>ne("all"),children:"All"}),Ae.map((a,s)=>e.jsx(m,{onClick:()=>ne(a._id,a.name),children:a.name},s))]})]})]}),ge?e.jsx(Le,{}):e.jsxs(_e,{children:[e.jsx(Ue,{children:e.jsxs(he,{children:[e.jsx(o,{scope:"col",children:"Id"}),e.jsx(o,{scope:"col",children:"First Name"}),e.jsx(o,{scope:"col",children:"Last Name"}),e.jsx(o,{scope:"col",children:"Email"}),e.jsx(o,{scope:"col",children:"Phone"}),e.jsx(o,{scope:"col",children:"Country"}),e.jsx(o,{scope:"col",children:"Employee ID"}),e.jsx(o,{scope:"col",children:"Language"}),e.jsx(o,{scope:"col",children:"Group"}),e.jsx(o,{scope:"col",children:"Edit"}),e.jsx(o,{scope:"col",children:"Status"})]})}),e.jsx(Ye,{children:b.map((a,s)=>e.jsxs(he,{children:[e.jsx(n,{children:a.code}),e.jsx(n,{children:a.name}),e.jsx(n,{children:a.surname}),e.jsx(n,{children:a.email}),e.jsx(n,{children:a.contact}),e.jsx(n,{children:a.country==="it"||a.country==="Italy"?"Italy":a.country}),e.jsx(n,{children:a.employeeId?a.employeeId:e.jsx(He,{color:"warning",children:"Not Provide"})}),e.jsx(n,{children:a.language==="en"?"English":a.language==="it"?"Italy":a.language==="es"?"Spanish":a.language}),e.jsx(n,{children:a.groups.map((l,x)=>e.jsx("div",{children:l.name},x))}),e.jsx(n,{children:e.jsx(ue,{children:e.jsx($e,{icon:qe,size:"xl",onClick:()=>Ge(a)})})}),e.jsx(n,{children:a.activate?e.jsx(p,{size:"sm",onClick:()=>ce(a.id,!1),style:{backgroundColor:"#ff4d4d",width:90},children:"Deactivate"}):e.jsx(p,{size:"sm",onClick:()=>ce(a.id,!0),style:{backgroundColor:"#ff4d4d",width:90},children:"Activate"})})]},s))})]}),e.jsxs(pe,{alignment:"center",visible:B,scrollable:!0,size:"sm",onClose:()=>g(!1),children:[e.jsx(me,{closeButton:!0,children:e.jsx(xe,{children:"Confirmation"})}),e.jsxs(Ce,{children:[e.jsxs("a",{children:["Are you sure you want to ",A?"activate":"deactivate"," this user?"]}),e.jsx("br",{}),e.jsx(p,{onClick:()=>Pe(),style:{display:"flex",justifyContent:"center"},color:"primary",children:"Yes"})]}),e.jsx(je,{children:e.jsx(p,{color:"secondary",onClick:()=>g(!1),children:"Close"})})]}),e.jsxs(pe,{visible:Y,scrollable:!0,size:"lg",onClose:()=>y(!1),children:[e.jsx(me,{closeButton:!0,children:e.jsx(xe,{children:"Edit Driver Information"})}),e.jsx(Ce,{children:e.jsxs("div",{className:"row g-3",children:[e.jsx(u,{md:6,children:e.jsx(h,{id:"name",label:"Firt Name",defaultValue:d.name,onChange:a=>J(a.target.value)})}),e.jsx(u,{md:6,children:e.jsx(h,{id:"surname",label:"LastName",defaultValue:d.surname,onChange:a=>Q(a.target.value)})}),e.jsx(u,{md:6,children:e.jsx(h,{id:"address",label:"Address",defaultValue:d.address,onChange:a=>oe(a.target.value)})}),e.jsx(u,{md:6,children:e.jsx(h,{id:"email",label:"Email",defaultValue:d.email,onChange:a=>X(a.target.value)})}),e.jsx(u,{md:6,children:e.jsx(h,{id:"phone",label:"Contact Number",defaultValue:d.contact,onChange:a=>O(a.target.value)})}),e.jsx(u,{md:6,children:e.jsx(h,{id:"iban",label:"IBAN",defaultValue:d.iban,onChange:a=>ae(a.target.value)})}),e.jsx(u,{md:6,children:e.jsx(h,{id:"vat",label:"Vat",defaultValue:d.vat,onChange:a=>le(a.target.value)})}),e.jsx(u,{md:6,children:e.jsxs(Je,{id:"inputState",label:"City",value:D,onChange:a=>se(a.target.value),children:[e.jsx("option",{children:d.city}),e.jsx("option",{children:"Milano"}),e.jsx("option",{children:"Napoli"})]})}),e.jsx(u,{xs:12,children:e.jsx(p,{color:"warning",type:"submit",style:{marginBottom:"3%",width:"200px"},onClick:()=>Te(),children:"Update Rider"})})]})}),e.jsx(je,{children:e.jsx(p,{color:"secondary",onClick:()=>y(!1),children:"Close"})})]})]})};export{ca as default};
