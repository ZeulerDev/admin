import{r as o,y as G,A as i,j as s,h as J}from"./index-DAsP9voM.js";import{a as B}from"./axios-Cm0UX6qg.js";import{P as E,F as K,O as X}from"./OccasionalEmployeePDF-D4qILX_C.js";import{B as R}from"./config-HOLfLxHr.js";import{b as Z,a as u}from"./CContainer-CNWVNE3j.js";import{d as F,C as ss,a as es,b as as,c as h}from"./DefaultLayout-C20riYYY.js";import{C as ts}from"./CNavbar-ll-tvqBp.js";import{C as os}from"./CFormInput-DnKel7m3.js";import{C as ls,a as rs,b as L,c as l,d as ns,e as r}from"./CTable-DPdXPM9f.js";import{C as z,a as I,b as N,c as V}from"./CModalTitle-Dzz95ONy.js";import"./inheritsLoose-CkMbdMht.js";import"./index-DGD48nhb.js";import"./CFormLabel-LzdqjwNr.js";const Ps=()=>{const[y,P]=o.useState(!1),[M,p]=o.useState(!1),[{user:O,token:f},c]=G(),[H,g]=o.useState(!1),[b,k]=o.useState([]),[x,$]=o.useState([]),[_,S]=o.useState("All"),[T,m]=o.useState(""),[j,Q]=o.useState(""),[D,C]=o.useState(""),[v,W]=o.useState("");o.useEffect(()=>{const e=setTimeout(()=>{c({type:i,payload:{status:!0,title:"Data Loading",message:"Data loading error: Timeout exceeded",color:"warning"}}),g(!1)},2e4);return Y(e),()=>{clearTimeout(e)}},[T,j]);const Y=e=>{g(!0),B.get(R+`assistant/pickers/payouts/0?status=${T}&no=${j}`,{headers:{Authorization:`Bearer ${f}`}}).then(a=>{a.status===200?(k(a.data),g(!1),clearTimeout(e)):a.status===204?c({type:i,payload:{status:!0,title:"Error",message:a.data.message,color:"warning"}}):a.status===500&&(console.log("error","500"),c({type:i,payload:{status:!0,title:"Error",message:a.data.message,color:"warning"}}))}).catch(a=>{console.log("Error",a)})},U=(e,a)=>{P(!y),$({type:e,item:a}),console.log("Toggle",e,a)},w=(e,a)=>{p(!y),W(e),console.log("VIew",e,a),a==="waiting"||a==="sent"?C("ready"):a==="ready"&&C("done")},q=()=>{console.log("Confirmation",D,v);const e={status:D};O&&f&&B.patch(R+"assistant/payout/change/"+v,e,{headers:{Authorization:`Bearer ${f}`}}).then(a=>{if(a.status===200){console.log("updated"),p(!1);const t=a.data,n=b.map(A=>A.id===t.id?t:A);k([...n]),c({type:i,payload:{status:!0,title:"Pricker Payout status",message:"Payout status updated successfully",color:"success"}})}else a.status===203?c({type:i,payload:{status:!0,title:"Pricker Payout status error",message:a.data.message}}):a.status===204?(console.log("204"),c({type:i,payload:{status:!0,title:"Pricker Payout status error",message:a.data.message}})):a.status===500&&c({type:i,payload:{status:!0,title:"Pricker Payout status update error",message:a.data.message}})}).catch(a=>{console.error(a)})},d=e=>{e==="all"?(m(""),S("All")):(console.log(e),m(e),S(e))};return s.jsxs(Z,{children:[s.jsx(F,{style:{marginLeft:"75%"},color:"secondary",children:"Filter by"}),s.jsxs(ss,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[s.jsx(es,{style:{color:"white"},children:_}),s.jsxs(as,{children:[s.jsx(h,{onClick:()=>d("all"),children:"All"}),s.jsx(h,{onClick:()=>d("pending"),children:"Pending"}),s.jsx(h,{onClick:()=>d("sent"),children:"Sent"}),s.jsx(h,{onClick:()=>d("ready"),children:"Ready"}),s.jsx(h,{onClick:()=>d("waiting"),children:"Waiting"}),s.jsx(h,{onClick:()=>d("done"),children:"Done"})]})]}),s.jsx(ts,{style:{marginTop:"1%"},className:"bg-body-tertiary",children:s.jsx(os,{type:"text",placeholder:"Search By No",style:{width:450,marginLeft:"0%"},value:j,onChange:e=>Q(e.target.value)})}),H?s.jsx(J,{}):s.jsxs(ls,{children:[s.jsx(rs,{children:s.jsxs(L,{children:[s.jsx(l,{scope:"col",children:"#"}),s.jsx(l,{scope:"col",children:"No"}),s.jsx(l,{scope:"col",children:"Name"}),s.jsx(l,{scope:"col",children:"Status"}),s.jsx(l,{scope:"col",children:"Date"}),s.jsx(l,{scope:"col",children:"Total"}),s.jsx(l,{scope:"col",children:"Tax"}),s.jsx(l,{scope:"col",children:"Tips"}),s.jsx(l,{scope:"col",children:"Payable"}),s.jsx(l,{scope:"col",children:"Action"}),s.jsx(l,{scope:"col",children:"PDF"})]})}),s.jsx(ns,{children:b.map((e,a)=>{let t="info",n="";return(e==null?void 0:e.status)==="pending"?(n="Pending",t="info"):(e==null?void 0:e.status)==="done"?(n="Paid",t="primary"):(e==null?void 0:e.status)==="sent"?(n="Sent",t="success"):(e==null?void 0:e.status)==="waiting"?(n="Waiting",t="warning"):(e==null?void 0:e.status)==="ready"&&(n="Ready",t="danger"),s.jsxs(L,{children:[s.jsx(r,{children:a+1}),s.jsx(r,{children:e.no}),s.jsx(r,{children:e.name}),s.jsx(r,{children:s.jsx(F,{style:{width:60},color:t,children:n})}),s.jsx(r,{children:e.date}),s.jsx(r,{children:e.total}),s.jsx(r,{children:e.tax}),s.jsx(r,{children:e.tips}),s.jsx(r,{children:e.payable}),s.jsxs(r,{children:[(e==null?void 0:e.status)==="waiting"&&s.jsx(u,{onClick:()=>w(e.id,e.status),size:"sm",color:t,style:{width:90},children:"Received"}),(e==null?void 0:e.status)==="sent"&&s.jsx(u,{size:"sm",onClick:()=>w(e.id,e.status),color:t,style:{width:90},children:"Received"}),(e==null?void 0:e.status)==="ready"&&s.jsx(u,{size:"sm",onClick:()=>w(e.id,e.status),color:t,style:{width:90},children:"To Pay"})]}),s.jsxs(r,{children:[s.jsx(u,{size:"sm",style:{backgroundColor:"#ff4d4d",width:80,color:"white"},onClick:()=>U(e.type,e),children:"View"})," "]})]},a)})})]}),s.jsxs(z,{visible:y,scrollable:!0,size:"xl",onClose:()=>P(!1),children:[s.jsx(I,{closeButton:!0,children:s.jsx(N,{children:"Information"})}),s.jsx(V,{style:{overflowY:"auto",maxHeight:"70vh",display:"flex",justifyContent:"center"},children:s.jsx(o.Suspense,{fallback:s.jsx("div",{children:"Loading PDF Viewer..."}),children:x.type==="flat_rate"?s.jsx(E,{style:{width:"100%",height:"100vh"},children:s.jsx(K,{data:x.item})}):x.type==="occasional"?s.jsx(E,{style:{width:"100%",height:"100vh"},children:s.jsx(X,{data:x.item})}):null})})]}),s.jsxs(z,{alignment:"center",visible:M,scrollable:!0,size:"sm",onClose:()=>p(!1),children:[s.jsx(I,{closeButton:!1,children:s.jsx(N,{children:"Confirmation"})}),s.jsxs(V,{children:[s.jsx("a",{children:"Are you sure you want to pay out status ?"}),s.jsx("br",{}),s.jsx("br",{}),s.jsxs("div",{style:{display:"flex",justifyContent:"center"},children:[s.jsx(u,{onClick:()=>q(),style:{backgroundColor:"#ff4d4d",color:"white",marginRight:"10px"},children:"Yes"}),s.jsx(u,{onClick:()=>p(!1),style:{backgroundColor:"#ff4d4d",color:"white",marginLeft:"10px"},children:"No"})]})]})]})]})};export{Ps as default};
