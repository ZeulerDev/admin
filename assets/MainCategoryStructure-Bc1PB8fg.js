import{y as ne,r as l,A as r,j as e,h as ce,m as de}from"./index-D8W7eoM5.js";import{a as u}from"./axios-Cm0UX6qg.js";import{B as g}from"./config-HOLfLxHr.js";import{b as ue,a as c}from"./CContainer-EQGOw-z2.js";import{C as ge}from"./CNavbar-bbh6w27I.js";import{C as he}from"./DefaultLayout-CwPF-zRq.js";import{C as v,a as k,b as D,c as E}from"./CModalTitle-DXUyO86j.js";import{C as P}from"./CFormInput-uSeXsJ0R.js";import{C as R}from"./CModalFooter-VrnOxKGp.js";import{C as Ce}from"./CRow-DDUdh4fX.js";import{C as $}from"./CCol-EtOQoGL3.js";import{C as fe}from"./CFormCheck-Ddsih5WE.js";import{C as I,a as F,b as m,c as h,d as V,e as C}from"./CTable-jf2tizix.js";import{c as me}from"./cil-view-module-CSS15w8m.js";import"./CFormLabel-Dh9Dcp0z.js";const Ne=()=>{const[{user:B,token:i},s]=ne(),[H,A]=l.useState(!1),[U,z]=l.useState(!1),[ye,n]=l.useState(!1),[pe,L]=l.useState(!0),[_,y]=l.useState(!1),[xe,O]=l.useState("All Main Categories"),[p,x]=l.useState(""),[W,Y]=l.useState([]),[q,G]=l.useState(""),[J,j]=l.useState(!1),[f,b]=l.useState(""),[M,w]=l.useState(""),[K,Q]=l.useState([]),[S,X]=l.useState([]);l.useEffect(()=>{T(),le()},[]);const T=()=>{i&&u.get(g+"product/categories",{headers:{Authorization:`Bearer ${i}`}}).then(t=>{t.status===200?(console.log(t.data[1]),Y(t.data)):t.status===500&&s({type:r,payload:{status:!0,title:"Main Category Loading error",message:"Main Category loading error"}})}).catch(t=>{console.error("Error: ",t)})},Z=(t,o,a)=>{a==="move2"&&(console.log("index",t,o,a),t==="all"||(console.log("index",t,o,a),x(t),O(o),G(t)))},ee=()=>{console.log("save",p),M&&p!==""?(y(!1),N({subName:M,index:p},"sub")):s({type:r,payload:{status:!0,title:"Check the fields",message:"Please check the fields",color:"warning"}})},te=(t,o)=>{n(!0),u.get(g+`product/category/${t}?ids=${o}`,{headers:{Authorization:`Bearer ${i}`}}).then(a=>{a.status===200?(setProductData(a.data.list),console.log(a.data.list.length),setResultCount(a.data.count),n(!1),a.data.list.length<50?(L(!0),console.log("ok")):a.data.list.length>50&&L(!1)):a.status===203?(n(!1),s({type:r,payload:{status:!0,title:"product loading error error",message:a.data.message}})):a.status===204?(n(!1),s({type:r,payload:{status:!0,title:"No Products",message:"No products found in this market address",color:"info"}})):a.status===500&&(n(!1),s({type:r,payload:{status:!0,title:"product loading error error",message:a.data.message}}))}).catch(a=>{n(!1),console.error("Error:",a)})},ae=()=>{j(!0)},oe=()=>{y(!0)},se=()=>{f?(console.log(f),N({name:f},"main"),j(!1)):s({type:r,payload:{status:!0,title:"Check the fields",message:"Please check the fields",color:"warning"}})},N=(t,o)=>{if(t&&o){let a;o==="main"?a={name:t.name}:o==="sub"&&(a={name:t.subName,index:t.index}),i&&u.post(g+"product/category/add",a,{headers:{Authorization:`Bearer ${i}`}}).then(d=>{d.status===200?(s({type:r,payload:{status:!0,title:"Category Registration",message:"Category Registration Success",color:"success"}}),b(""),w(""),x(""),T()):d.status===400?s({type:r,payload:{status:!0,title:"Category Registration error",message:"Category Registration error",color:"warning"}}):d.status===500&&s({type:r,payload:{status:!0,title:"Category Registration error",message:"Category Registration error 500",color:"warning"}})}).catch(d=>{console.error("Error:",d)})}else s({type:r,payload:{status:!0,title:"Error!",message:" error, Please Check the input fields",color:"warning"}})},re=()=>{B&&i&&u.get(g+"product/categories/download",{headers:{Authorization:`Bearer ${i}`},responseType:"blob"}).then(t=>{if(t.status===200){const o=window.URL.createObjectURL(new Blob([t.data])),a=document.createElement("a");a.href=o,a.setAttribute("download","category.json"),document.body.appendChild(a),a.click(),a.remove(),s({type:r,payload:{status:!0,title:"Download file ",message:"Download file success",color:"success"}}),te(0,!0)}else t.status===500&&s({type:r,payload:{status:!0,title:"Download file ",message:"Download file error",color:"danger"}})}).catch(t=>{console.error("Error:",t)})},le=()=>{B&&i?(A(!0),u.get(g+"product/list/categories",{headers:{Authorization:`Bearer ${i}`}}).then(t=>{t.status===200?(console.log(t.data),Q(t.data),A(!1)):t.status===204?s({type:r,payload:{status:!0,title:"Error!",message:" error",color:"warning"}}):t.status===500&&s({type:r,payload:{status:!0,title:"Error!",message:" error",color:"warning"}})}).catch(t=>{s({type:r,payload:{status:!0,title:"Error!",message:" error",color:"warning"}})})):s({type:r,payload:{status:!0,title:"Error!",message:" error",color:"warning"}})},ie=t=>{z(!0),X(t)};return e.jsxs(ue,{children:[e.jsxs(ge,{style:{justifyContent:"flex-start"},className:"bg-body-tertiary",children:[e.jsx(he,{style:{marginLeft:"0.2%"},color:"secondary",children:"Download Category file"}),e.jsx(c,{style:{backgroundColor:"#ff4d4d",color:"white",marginLeft:"0.5%"},onClick:()=>{re()},children:"Download File"}),e.jsx(c,{onClick:()=>{ae()},style:{backgroundColor:"#ff4d4d",width:"17%",color:"white",marginLeft:"41%"},children:"Add Main Category"}),e.jsx(c,{onClick:()=>{oe()},style:{backgroundColor:"#ff4d4d",width:"17%",color:"white",marginLeft:5},children:"Add Sub Category"})]}),e.jsxs(v,{alignment:"center",visible:J,scrollable:!0,size:"sm",onClose:()=>{j(!1),b("")},children:[e.jsx(k,{closeButton:!0,children:e.jsx(D,{children:"Category Registration"})}),e.jsx(E,{children:e.jsx(P,{type:"text",placeholder:"Enter Category Name",value:f,onChange:t=>b(t.target.value)})}),e.jsx(R,{children:e.jsx(c,{style:{backgroundColor:"#ff4d4d",color:"white"},onClick:()=>{se()},children:"Save"})})]}),e.jsxs(v,{alignment:"center",visible:_,scrollable:!0,size:"lg",onClose:()=>{x(""),w(""),y(!1)},children:[e.jsx(k,{closeButton:!0,children:e.jsx(D,{children:"Add Sub Category"})}),e.jsx(E,{children:e.jsxs(Ce,{children:[e.jsxs($,{md:6,children:[e.jsx("a",{style:{fontSize:17,fontWeight:"bold"},children:"Select the Main Category"}),e.jsx("br",{}),e.jsx("br",{}),W.map((t,o)=>e.jsx(fe,{onChange:()=>Z(o,t,"move2"),type:"radio",name:"mainCategoryRadio",id:`flexRadioDefault${o}`,label:t,checked:q===o},o))]}),e.jsx($,{md:6,children:e.jsx(P,{type:"text",placeholder:"Enter Subcategory Name",value:M,onChange:t=>w(t.target.value)})})]})}),e.jsx(R,{children:e.jsx(c,{style:{backgroundColor:"#ff4d4d",color:"white"},onClick:()=>{ee()},children:"Save"})})]}),H?e.jsx(ce,{}):e.jsxs(I,{children:[e.jsx(F,{children:e.jsxs(m,{children:[e.jsx(h,{scope:"col",children:"#"}),e.jsx(h,{scope:"col",children:"Main Category"}),e.jsx(h,{scope:"col",children:"View Sub Categories"})]})}),e.jsx(V,{children:K.map((t,o)=>e.jsxs(m,{children:[e.jsx(C,{children:o+1}),e.jsx(C,{children:t.mainCategory}),e.jsx(C,{children:e.jsx(c,{size:"sm",style:{backgroundColor:"#ff4d4d"},variant:"outline",onClick:()=>{ie(t.subCategories)},children:e.jsx(de,{icon:me,size:"lg",style:{color:"white"}})})})]},o))})]}),e.jsxs(v,{visible:U,scrollable:!0,size:"sm",onClose:()=>z(!1),children:[e.jsx(k,{closeButton:!0,children:e.jsx(D,{children:"SubCategories Information"})}),e.jsx(E,{style:{overflowY:"auto",maxHeight:"70vh",display:"flex",justifyContent:"center"},children:e.jsxs(I,{children:[e.jsx(F,{children:e.jsxs(m,{children:[e.jsx(h,{scope:"col",children:"#"}),e.jsx(h,{scope:"col",children:"SubCategory"})]})}),e.jsx(V,{children:S==null?void 0:S.map((t,o)=>e.jsxs(m,{children:[e.jsx(C,{children:o+1}),e.jsx(C,{children:t})]},o))})]})}),e.jsx(R,{})]})]})};export{Ne as default};
