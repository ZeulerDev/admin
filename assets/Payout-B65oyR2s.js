import{r as o,y as he,A as x,j as e,h as xe}from"./index-xkWvTOBi.js";import{a as q}from"./axios-Cm0UX6qg.js";import{P as G,F as ge,O as fe}from"./OccasionalEmployeePDF-DlrqQnis.js";/* empty css               */import{B as J}from"./config-CAsDK75y.js";import{b as pe,a as d}from"./CContainer-3EDy8eE_.js";import{C as K,a as ye,b as je,d as Ce,e as g}from"./DefaultLayout-CKh5LGPH.js";import{C as me}from"./CNavbar-DMk1JdFZ.js";import{C as Pe}from"./CFormInput-8S3bA1RE.js";import{C as be,a as we,b as N,c as n,d as Se,e as l}from"./CTable-B86afwyC.js";import{C as Te,a as E}from"./CPaginationItem-DHPF0yFA.js";import{C as R,a as B,b as I,c as z}from"./CModalTitle-DjS0_zGB.js";import"./inheritsLoose-BR9xv5Kf.js";import"./typeof-QjJsDpFa.js";import"./index-87cCOErT.js";import"./CFormLabel-CPyH9RWq.js";const Qe=()=>{const[m,F]=o.useState(!1),[L,f]=o.useState(!1),[{user:M,token:p},u]=he(),[X,P]=o.useState(!1),[b,H]=o.useState([]),[y,Z]=o.useState([]),[ee,O]=o.useState("All"),[V,$]=o.useState(""),[i,w]=o.useState(""),[se,Q]=o.useState(i),[Y,S]=o.useState(""),[_,te]=o.useState(""),[ve,ae]=o.useState(!1),[oe,le]=o.useState(0),[j,T]=o.useState(1),[v,D]=o.useState(0),[ne,W]=o.useState(!0);o.useEffect(()=>{const s=setTimeout(()=>{u({type:x,payload:{status:!0,title:"Data Loading",message:"Data loading error: Timeout exceeded",color:"warning"}}),P(!1)},2e4);return M&&p&&C(0,s),()=>{clearTimeout(s)}},[V,se]),o.useEffect(()=>{const s=setTimeout(()=>{(i.length>=3||i.length===0)&&Q(i)},500);return()=>{clearTimeout(s)}},[i]);const C=(s,t)=>{P(!0),q.get(J+`assistant/drivers/payouts/${s}?status=${V}&no=${i}`,{headers:{Authorization:`Bearer ${p}`}}).then(a=>{a.status===200?(H(a.data.data),le(a.data.count),P(!1),ae(!1),clearTimeout(t),a.data.data.length<50?(W(!0),console.log("ok")):a.data.data.length>49&&W(!1)):a.status===204?u({type:x,payload:{status:!0,title:"Error",message:a.data.message,color:"warning"}}):a.status===500&&u({type:x,payload:{status:!0,title:"Error",message:a.data.message,color:"warning"}})}).catch(a=>{console.log("Error",a)})},re=()=>{T(j+1);const s=v+50;D(s),C(s,!0)},ie=()=>{T(j-1);const s=v-50;console.log(s),D(s),C(s,!1)},ce=(s,t)=>{F(!m),Z({type:s,item:t}),console.log("Toggle",s,t)},k=(s,t)=>{f(!m),te(s),console.log("VIew",s,t),t==="waiting"||t==="sent"?S("ready"):t==="ready"&&S("done")},U=()=>{console.log("Confirmation",Y,_);const s={status:Y};M&&p&&q.patch(J+"assistant/payout/change/"+_,s,{headers:{Authorization:`Bearer ${p}`}}).then(t=>{if(t.status===200){console.log("updated"),f(!1);const a=t.data,r=b.map(A=>A.id===a.id?a:A);H([...r])}else t.status===203?u({type:x,payload:{status:!0,title:"Driver Payout status error",message:t.data.message}}):t.status===204?(console.log("204"),u({type:x,payload:{status:!0,title:"Driver Payout status error",message:t.data.message}})):t.status===500&&u({type:x,payload:{status:!0,title:"Driver Payout status update error",message:t.data.message}})}).catch(t=>{console.error(t)})},h=s=>{s==="all"?($(""),O("All"),w("")):(console.log(s),$(s),O(s),w(""))},de=s=>{T(s);const t=(s-1)*50;D(t),C(t,!0)},ue=()=>{const s=Math.ceil(oe/50),t=[];for(let c=1;c<=s;c++)t.push(c);const a=Math.max(j-2,1),r=Math.min(a+4,s);return t.slice(a-1,r).map(c=>e.jsx(E,{active:j===c,onClick:()=>de(c),children:c},c))};return e.jsxs(pe,{children:[e.jsx(K,{style:{marginLeft:"75%"},color:"secondary",children:"Filter by"}),e.jsxs(ye,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[e.jsx(je,{style:{color:"white"},children:ee}),e.jsxs(Ce,{children:[e.jsx(g,{onClick:()=>h("all"),children:"All"}),e.jsx(g,{onClick:()=>h("pending"),children:"Pending"}),e.jsx(g,{onClick:()=>h("sent"),children:"Sent"}),e.jsx(g,{onClick:()=>h("ready"),children:"Ready"}),e.jsx(g,{onClick:()=>h("waiting"),children:"Waiting"}),e.jsx(g,{onClick:()=>h("done"),children:"Paid"})]})]}),e.jsx(me,{style:{marginTop:"1%"},className:"bg-body-tertiary",children:e.jsx(Pe,{type:"text",placeholder:"Search by No",style:{width:450,marginLeft:"0%"},value:i,onChange:s=>w(s.target.value)})}),X?e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(xe,{style:{marginTop:"15%"}})}):e.jsxs(be,{children:[e.jsx(we,{children:e.jsxs(N,{children:[e.jsx(n,{scope:"col",children:"#"}),e.jsx(n,{scope:"col",children:"No"}),e.jsx(n,{scope:"col",children:"Name"}),e.jsx(n,{scope:"col",children:"Status"}),e.jsx(n,{scope:"col",children:"Date"}),e.jsx(n,{scope:"col",children:"Total"}),e.jsx(n,{scope:"col",children:"Tax"}),e.jsx(n,{scope:"col",children:"Tips"}),e.jsx(n,{scope:"col",children:"Payable"}),e.jsx(n,{scope:"col",children:"Action"}),e.jsx(n,{scope:"col",children:"PDF"})]})}),e.jsx(Se,{children:b.length===0?e.jsx(N,{children:e.jsx(l,{colSpan:"11",style:{textAlign:"center",backgroundColor:"white"},children:e.jsx("h6",{style:{marginTop:"1%"},children:"No Data"})})}):b.map((s,t)=>{let a="info",r="";return(s==null?void 0:s.status)==="pending"?(r="Pending",a="info"):(s==null?void 0:s.status)==="done"?(r="Paid",a="primary"):(s==null?void 0:s.status)==="sent"?(r="Sent",a="success"):(s==null?void 0:s.status)==="waiting"?(r="Waiting",a="warning"):(s==null?void 0:s.status)==="ready"&&(r="Ready",a="danger"),e.jsxs(N,{children:[e.jsx(l,{children:t+1}),e.jsx(l,{children:s.no}),e.jsx(l,{children:s.name}),e.jsx(l,{children:e.jsx(K,{style:{width:60},color:a,children:r})}),e.jsx(l,{children:s.date}),e.jsx(l,{children:s.total}),e.jsx(l,{children:s.tax}),e.jsx(l,{children:s.tips}),e.jsx(l,{children:s.payable}),e.jsxs(l,{children:[(s==null?void 0:s.status)==="waiting"&&e.jsx(d,{onClick:()=>k(s.id,s.status),size:"sm",color:a,style:{width:90},children:"Received"}),(s==null?void 0:s.status)==="sent"&&e.jsx(d,{size:"sm",onClick:()=>k(s.id,s.status),color:a,style:{width:90},children:"Received"}),(s==null?void 0:s.status)==="ready"&&e.jsx(d,{size:"sm",onClick:()=>k(s.id,s.status),color:a,style:{width:90},children:"To Pay"})]}),e.jsxs(l,{children:[e.jsx(d,{size:"sm",style:{backgroundColor:"#ff4d4d",width:80,color:"white"},onClick:()=>ce(s.type,s),children:"View"})," "]})]},t)})})]}),e.jsxs(Te,{"aria-label":"Page navigation example",children:[e.jsx(E,{disabled:v<=0,onClick:ie,children:"Previous"}),ue(),e.jsx(E,{disabled:ne===!0,onClick:re,children:"Next"})]}),e.jsxs(R,{visible:m,scrollable:!0,size:"xl",onClose:()=>F(!1),children:[e.jsx(B,{closeButton:!0,children:e.jsx(I,{children:"Information"})}),e.jsx(z,{style:{overflowY:"auto",maxHeight:"70vh",display:"flex",justifyContent:"center"},children:y.type==="flat_rate"?e.jsx(G,{style:{width:"100%",height:"100vh"},children:e.jsx(ge,{data:y.item})}):y.type==="occasional"?e.jsx(G,{style:{width:"100%",height:"100vh"},children:e.jsx(fe,{data:y.item})}):null})]}),e.jsxs(R,{alignment:"center",transition:!1,visible:L,scrollable:!0,size:"lg",onClose:()=>f(!1),children:[e.jsx(B,{closeButton:!0,children:e.jsx(I,{children:"Confirmation"})}),e.jsxs(z,{style:{overflowY:"auto",maxHeight:"70vh",display:"flex",justifyContent:"center"},children:[e.jsx("a",{children:"Are you sure you want to pay out status ?"}),e.jsx(d,{onClick:()=>U(),style:{display:"flex",justifyContent:"center"},color:"primary",children:"Yes"})]})]}),e.jsxs(R,{alignment:"center",visible:L,scrollable:!0,size:"sm",onClose:()=>f(!1),children:[e.jsx(B,{closeButton:!1,children:e.jsx(I,{children:"Confirmation"})}),e.jsxs(z,{children:[e.jsx("a",{children:"Are you sure you want to pay out status ?"}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{style:{display:"flex",justifyContent:"center"},children:[e.jsx(d,{onClick:()=>U(),style:{backgroundColor:"#ff4d4d",color:"white",marginRight:"10px"},children:"Yes"}),e.jsx(d,{onClick:()=>f(!1),style:{backgroundColor:"#ff4d4d",color:"white",marginLeft:"10px"},children:"No"})]})]})]})]})};export{Qe as default};
