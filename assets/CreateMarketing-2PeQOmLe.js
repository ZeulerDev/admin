import{B as ss,r,y as as,l as ts,A as d,j as e,h as ie}from"./index-CUWfyW-O.js";import{a as b}from"./axios-Cm0UX6qg.js";import{B as S}from"./config-HOLfLxHr.js";import{b as rs,a as U}from"./CContainer-BItPl6AZ.js";import{C as V}from"./CNavbar-DtbDRkDL.js";import{a as C,b as y,d as M,e as n,C as ne}from"./DefaultLayout-DhMnxolp.js";import{C as ls}from"./CFormInput-D-GUVRHw.js";import{C as ce,a as de,b as g,c as i,d as he,e as o}from"./CTable-DCkylyCt.js";import{C as os}from"./CCardImage-2oki6Tdu.js";import{C as ue,a as A}from"./CPaginationItem-H7icVTj5.js";import{C as is,a as ns,b as cs,c as ds}from"./CModalTitle-CVe0vSxH.js";import{C as hs}from"./CRow-TrTc4_2j.js";import{C as us}from"./CCol-WbltVhQd.js";import{C as Ie}from"./CFormCheck-BasxRHeg.js";import{C as xs}from"./CModalFooter-ZYN1WUD3.js";import"./CFormLabel-D70FFWaS.js";const Ns=()=>{const{id:xe}=ss(),[$,Be]=r.useState(""),[t,I]=r.useState("all"),[{user:B,token:h},c]=as(),[W,x]=r.useState(!1),[pe,Re]=r.useState([]),[p,q]=r.useState(0),[J,f]=r.useState(!0),[ge,Ee]=r.useState([]),[fe,G]=r.useState("All Chains"),[K,P]=r.useState("All market"),[je,D]=r.useState(""),[ke,j]=r.useState(""),[O,R]=r.useState([]),[k,m]=r.useState(""),[Fe,me]=r.useState(k),[Ce,ye]=r.useState(0),[E,X]=r.useState(1),Me=ts(),[ze,F]=r.useState(!1),[_e,ps]=r.useState(""),[Qe,He]=r.useState([]),[Ue,be]=r.useState("All MarketGroups"),[Y,Z]=r.useState("All Markets in Group"),[Ve,Se]=r.useState([]),[Ae,We]=r.useState(""),[w,ee]=r.useState(""),[se,Pe]=r.useState(""),[Le,Ge]=r.useState("All Cities"),[De,qe]=r.useState([]),[Je,we]=r.useState(!1);r.useState("");const[Ke,Te]=r.useState([]),[gs,Ne]=r.useState(!1);r.useEffect(()=>{console.log("ID",xe),Be(xe)},[]),r.useEffect(()=>{ze&&(t==="Market"?N(0):t==="Market Group"&&v(0))},[B,se,je]),r.useEffect(()=>{t==="Product"&&B&&h&&T(0)},[B,h,ke,Fe]),r.useEffect(()=>{if(t==="Product"){const s=setTimeout(()=>{(k.length>=3||k.length===0)&&me(k)},500);return()=>{clearTimeout(s)}}},[k]);const z=s=>{D(""),G("All Chains"),j(""),P("All Markets"),s==="all"?(I("All"),F(!1)):s==="Product"?(T(0),ve(),I(s),Ye(),F(!0)):s==="Market"?(N(0),ve(),I(s),F(!0)):s==="Market Group"&&(v(0),I(s),F(!0))},T=(s,a)=>{x(!0),b.get(S+`product/all/${s}?marketId=${ke}&name=${k}`,{headers:{Authorization:`Bearer ${h}`}}).then(l=>{l.status===200?(Re(l.data.list),ye(l.data.count),x(!1),l.data.list.length<20?(f(!0),console.log("ok")):l.data.list.length>19&&f(!1)):l.status===203?(x(!1),c({type:d,payload:{status:!0,title:"product loading error error",message:l.data.message}})):l.status===204?x(!1):l.status===500&&(x(!1),c({type:d,payload:{status:!0,title:"product loading error error",message:l.data.message}}))}).catch(l=>{x(!1),console.error("Error:",l)})},ve=()=>{h&&b.get(S+"assistant/market/chains/all",{headers:{Authorization:`Bearer ${h}`}}).then(s=>{s.status===200?Ee(s.data):s.status===500&&c({type:d,payload:{status:!0,title:"Chain Loading error",message:s.data.message}})}).catch(s=>{console.error("Error: ",s)})},_=(s,a)=>{s==="all"?(D(""),G("All Chains"),j(""),P("All Markets"),m("")):(m(""),j(""),P("All Markets"),D(s),t==="Product"&&Oe(s),G(a))},Oe=s=>{b.get(S+`assistant/market/locations?brand=${s}`,{headers:{Authorization:`Bearer ${h}`}}).then(a=>{a.status===200?(R(a.data.data),a.data.data.length<20?(f(!0),console.log("ok")):a.data.data.length>19&&f(!1)):a.status===500&&c({type:d,payload:{status:!0,title:"Market Loading error",message:a.data.message}})}).catch(a=>{console.error("Error: ",a)})},ae=(s,a)=>{s==="all"?(j(""),P("All Markets"),D(""),G("All Chains"),R([]),m("")):s==="group"?(j(a.marketId),Z(`${a.chainName}- ${a.marketAddress}`),m("")):(j(s),P(a),m(""))},Xe=s=>{X(s);let a;t==="Product"?a=(s-1)*50:(t==="Market"||t==="Market Group")&&(a=(s-1)*20),q(a),t==="Product"?T(a):t==="Market"?N(a):t==="Market Group"&&v(a)},$e=()=>{let s;t==="Product"?s=Math.ceil(Ce/50):(t==="Market"||t==="Market Group")&&(s=Math.ceil(Ce/20));const a=[];for(let u=1;u<=s;u++)a.push(u);const l=Math.max(E-2,1),H=Math.min(l+4,s);return a.slice(l-1,H).map(u=>e.jsx(A,{active:E===u,onClick:()=>Xe(u),children:u},u))},te=()=>{X(E+1);let s;t==="Product"?s=p+50:(t==="Market"||t==="Market Group")&&(s=p+20),q(s),t==="Product"?T(s):t==="Market"?N(s):t==="Market Group"&&v(s)},re=()=>{X(E-1);let s;t==="Product"?s=p-50:(t==="Market"||t==="Market Group")&&(s=p-20),q(s),t==="Product"?T(s):t==="Market"?N(s):t==="Market Group"&&v(s)},Ye=()=>{b.get(S+"market/group/all",{headers:{Authorization:`Bearer ${h}`}}).then(s=>{s.status===200?He(s.data):s.status===500&&c({type:d,payload:{status:!0,title:"MarketGroup Loading error",message:s.data.message}})}).catch(s=>{console.error("Error: ",s),c({type:d,payload:{status:!0,title:"MarketGroup Loading error",message:res.data.message}})})},le=(s,a)=>{s==="all"?(j(""),P("All Markets"),D(""),G("All Chains"),R([]),m(""),Se([]),be("All MarketGroups"),Z("All Markets in Group")):(j(""),Z("All Markets in Group"),m(""),be(a.name),Se(a.market))},L=s=>{s==="all"?(Pe(""),Ge("All Cities")):(Pe(s),Ge(s))},N=s=>{x(!0),b.get(S+`assistant/market/link/${s}?brand=${je}&city=${se}`,{headers:{Authorization:`Bearer ${h}`}}).then(a=>{a.status===200?(R(a.data.data),ye(a.data.count),x(!1),a.data.data.length<20?(f(!0),console.log("ok")):a.data.data.length>19&&f(!1)):a.status===500&&c({type:d,payload:{status:!0,title:"Market Loading error",message:a.data.message}})}).catch(a=>{console.error("Error: ",a)})},v=s=>{x(!0),b.get(S+`market/groups/base/link/fetch/${s}?city=${se}`,{headers:{Authorization:`Bearer ${h}`}}).then(a=>{console.log(a.status),a.status===200?(console.log(a.data),qe(a.data),x(!1),a.data.length<20?(f(!0),console.log("ok")):a.data.length>19&&f(!1)):a.status===500&&c({type:d,payload:{status:!0,title:"Makrket Group loading error",message:a.data.message}})}).catch(a=>{console.error("Error:",a)})},Q=s=>{if(console.log(t,_e),t&&s){let a;$!==""?w!==""&&w!=="all"?a={type:t,id:s,baseLinkId:$,marketIndex:w}:a={type:t,id:s,baseLinkId:$}:a={type:t,id:s},console.log(a),B&&h&&b.post(S+"deepLink/urls/create",a,{headers:{Authorization:`Bearer ${h}`}}).then(l=>{l.status===200?(c({type:d,payload:{status:!0,title:"Link Registration",message:"Link Registration Success",color:"success"}}),Me($!=="none"?"/marketing/app/flayer/all":"/marketing/all")):l.status===400?c({type:d,payload:{status:!0,title:"Link Registration error",message:"Link Registration Failed",color:"info"}}):l.status===500&&c({type:d,payload:{status:!0,title:"Link Registration error",message:l.data.message}})}).catch(l=>{console.error("Error:",l)})}else alert("Please Check the Fields!")},Ze=(s,a)=>{Ne(!0),console.log("markets",s),we(!0),Te(s),We(a),Ne(!1)},es=()=>{w==="all"||w!==""?Q(Ae):c({type:d,payload:{status:!0,title:"Market Selection",message:"Please select the market",color:"info"}})};return e.jsxs(rs,{children:[e.jsx(V,{style:{marginTop:"1%"},className:"bg-body-tertiary",children:e.jsxs(C,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[e.jsx(y,{style:{color:"white"},children:t}),e.jsxs(M,{children:[e.jsx(n,{onClick:()=>z("all"),children:"All"}),e.jsx(n,{onClick:()=>z("Product"),children:"Product"}),e.jsx(n,{onClick:()=>z("Market"),children:"Market"}),e.jsx(n,{onClick:()=>z("Market Group"),children:"Market Group"})]})]})}),t==="all"&&e.jsx("h1",{}),t==="Product"&&e.jsxs(e.Fragment,{children:[e.jsx(ne,{style:{marginLeft:"40%"},color:"secondary",children:"Filter by"}),e.jsxs(C,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[e.jsx(y,{children:Ue}),e.jsxs(M,{children:[e.jsx(n,{onClick:()=>le("all"),children:"All"}),Qe.map((s,a)=>e.jsx(n,{onClick:()=>{le(s.id,s)},children:s.name},a))]})]}),e.jsxs(C,{style:{marginLeft:"2%",width:"21%",backgroundColor:"#ff4d4d"},children:[e.jsxs(y,{children:["   ",Y.length>20?`${Y.substring(0,20)}...`:Y]}),e.jsxs(M,{children:[e.jsx(n,{onClick:()=>le("all"),children:"All"}),Ve.map((s,a)=>e.jsxs(n,{onClick:()=>{ae("group",s)},children:[s.chainName," - ",s.marketAddress]},a))]})]}),e.jsxs(C,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[e.jsx(y,{children:fe}),e.jsxs(M,{children:[e.jsx(n,{onClick:()=>_("all"),children:"All"}),ge.map((s,a)=>e.jsx(n,{onClick:()=>_(s.id,s.name),children:s.name},a))]})]}),e.jsxs(C,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[e.jsx(y,{children:K.length>15?`${K.substring(0,15)}...`:K}),e.jsxs(M,{children:[e.jsx(n,{onClick:()=>ae("all"),children:"Select the Chain"}),O.map((s,a)=>e.jsx(n,{onClick:()=>ae(s._id,s.address),children:e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsx("span",{children:s.address.substring(0,s.address.length/2)}),e.jsx("span",{children:s.address.substring(s.address.length/2)})]})},a))]})]}),e.jsx(V,{style:{marginTop:"1%"},className:"bg-body-tertiary",children:e.jsx(ls,{type:"text",placeholder:"Search products by name, brand name and product id",style:{width:450,marginRight:"60%"},value:k,onChange:s=>m(s.target.value)})}),W?e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(ie,{style:{marginTop:"15%"}})}):e.jsxs(ce,{children:[e.jsx(de,{children:e.jsxs(g,{children:[e.jsx(i,{scope:"col",children:"#"}),e.jsx(i,{scope:"col",children:"Product Id"}),e.jsx(i,{scope:"col",children:"Photo"}),e.jsx(i,{scope:"col",children:"Name"}),e.jsx(i,{scope:"col",children:"Base Price"}),e.jsx(i,{scope:"col",children:"Tax"}),e.jsx(i,{scope:"col",children:"Markup Percentage "}),e.jsx(i,{scope:"col",children:"Markup"}),e.jsx(i,{scope:"col",children:"Total"}),e.jsx(i,{scope:"col",children:"Brand"}),e.jsx(i,{scope:"col",children:"Chain"}),e.jsx(i,{scope:"col",children:"Market Address"}),e.jsx(i,{scope:"col",children:"Add Link"})]})}),e.jsx(he,{children:pe.length===0?e.jsx(g,{children:e.jsx(o,{colSpan:"13",style:{textAlign:"center",backgroundColor:"white"},children:e.jsx("h6",{style:{marginTop:"1%"},children:"No Data"})})}):pe.map((s,a)=>{var l,H,oe,u;return e.jsxs(g,{children:[e.jsx(o,{children:p+a+1}),e.jsx(o,{children:s.pid}),e.jsx(i,{children:e.jsx(os,{style:{width:"50px",height:"50px"},src:"https://api.zeuler.com/image/"+s.image})}),e.jsx(o,{children:s.name}),e.jsx(o,{children:(((l=s.price)==null?void 0:l.basePrice)??0).toFixed(2)}),e.jsx(o,{children:(((H=s.price)==null?void 0:H.tax)??0).toFixed(2)}),e.jsxs(o,{children:[s.price.percentage,"%"]}),e.jsx(o,{children:(((oe=s.price)==null?void 0:oe.markup)??0).toFixed(2)}),e.jsx(o,{children:(((u=s.price)==null?void 0:u.total)??0).toFixed(2)}),e.jsx(o,{children:s.brand}),e.jsx(o,{children:s.chainName}),e.jsx(o,{children:s.marketAddress}),e.jsx(o,{children:e.jsx(U,{size:"sm",style:{backgroundColor:"#ff4d4d",marginLeft:"5px",color:"white"},variant:"outline",onClick:()=>{Q(s.productId)},children:"Add"})})]},a)})})]}),e.jsxs(ue,{"aria-label":"Page navigation example",children:[e.jsx(A,{disabled:p<=0,onClick:re,children:"Previous"}),$e(),e.jsx(A,{disabled:J===!0,onClick:te,children:"Next"})]})]}),t==="Market"&&e.jsxs(e.Fragment,{children:[e.jsx(ne,{style:{marginLeft:"57%"},color:"secondary",children:"Filter by"}),e.jsxs(C,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[e.jsx(y,{style:{color:"white"},children:Le}),e.jsxs(M,{children:[e.jsx(n,{onClick:()=>L("all"),children:"All"}),e.jsx(n,{onClick:()=>L("Milano"),children:"Milano"}),e.jsx(n,{onClick:()=>L("Napoli"),children:"Napoli"})]})]}),e.jsxs(C,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d"},children:[e.jsx(y,{style:{color:"white"},children:fe}),e.jsxs(M,{children:[e.jsx(n,{onClick:()=>_("all"),children:"All"}),ge.map((s,a)=>e.jsx(n,{onClick:()=>_(s.id,s.name),children:s.name},a))]})]}),e.jsx(V,{style:{marginTop:"1%"},className:"bg-body-tertiary"}),W?e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(ie,{style:{marginTop:"15%"}})}):e.jsxs(ce,{children:[e.jsx(de,{children:e.jsxs(g,{children:[e.jsx(i,{scope:"col",children:"#"}),e.jsx(i,{scope:"col",children:"Name"}),e.jsx(i,{scope:"col",children:"Address"}),e.jsx(i,{scope:"col",children:"City"}),e.jsx(i,{scope:"col",children:"Scraped"}),e.jsx(i,{scope:"col",children:"Add Link"})]})}),e.jsx(he,{children:O.length===0?e.jsx(g,{children:e.jsx(o,{colSpan:"6",style:{textAlign:"center",backgroundColor:"white"},children:e.jsx("h6",{style:{marginTop:"1%"},children:"No Data"})})}):O.map((s,a)=>{var l;return e.jsxs(g,{children:[e.jsx(o,{children:p+a+1}),e.jsx(o,{children:(l=s.chain)==null?void 0:l.name}),e.jsx(o,{children:s.address}),e.jsx(o,{children:s.city}),e.jsx(o,{children:s.scraped}),e.jsx(o,{children:e.jsx(U,{size:"sm",style:{backgroundColor:"#ff4d4d",marginLeft:"5px",color:"white"},variant:"outline",onClick:()=>{Q(s._id)},children:"Add"})})]},a)})})]}),e.jsxs(ue,{"aria-label":"Page navigation example",children:[e.jsx(A,{disabled:p<=0,onClick:re,children:"Previous"}),$e(),e.jsx(A,{disabled:J===!0,onClick:te,children:"Next"})]})]}),t==="Market Group"&&e.jsxs(e.Fragment,{children:[e.jsx(ne,{style:{marginLeft:"75%",marginTop:"2%"},color:"secondary",children:"Filter by"}),e.jsxs(C,{style:{marginLeft:"2%",width:"17%",marginRight:"5px",backgroundColor:"#ff4d4d"},children:[e.jsx(y,{style:{color:"white"},children:Le}),e.jsxs(M,{children:[e.jsx(n,{onClick:()=>L("all"),children:"All"}),e.jsx(n,{onClick:()=>L("Milano"),children:"Milano"}),e.jsx(n,{onClick:()=>L("Napoli"),children:"Napoli"})]})]}),e.jsx(V,{style:{marginTop:"1%"},className:"bg-body-tertiary"}),W?e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(ie,{style:{marginTop:"15%"}})}):e.jsxs(ce,{children:[e.jsx(de,{children:e.jsxs(g,{children:[e.jsx(i,{scope:"col",children:"#"}),e.jsx(i,{scope:"col",children:"Name"}),e.jsx(i,{scope:"col",children:"City"}),e.jsx(i,{scope:"col",children:"Add Link"})]})}),e.jsx(he,{children:De.length===0?e.jsx(g,{children:e.jsx(o,{colSpan:"4",style:{textAlign:"center",backgroundColor:"white"},children:e.jsx("h6",{style:{marginTop:"1%"},children:"No Data"})})}):De.map((s,a)=>e.jsxs(g,{children:[e.jsx(o,{children:p+a+1}),e.jsx(o,{children:e.jsx("span",{children:s.name})}),e.jsx(o,{children:s.city}),e.jsx(o,{children:e.jsx(U,{onClick:()=>{Ze(s.markets,s._id)},size:"sm",style:{backgroundColor:"#ff4d4d",marginLeft:"5px",color:"white"},children:"Add"})})]},a))})]}),e.jsxs(ue,{"aria-label":"Page navigation example",children:[e.jsx(A,{disabled:p<=0,onClick:re,children:"Previous"}),e.jsx(A,{disabled:J===!0,onClick:te,children:"Next"})]})]}),e.jsxs(is,{alignment:"center",visible:Je,scrollable:!0,size:"lg",onClose:()=>{we(!1),Te([]),ee("")},children:[e.jsx(ns,{closeButton:!0,children:e.jsx(cs,{children:" Markets details of Market Group "})}),e.jsx(ds,{children:e.jsx(hs,{children:e.jsxs(us,{md:6,children:[e.jsx("a",{style:{fontSize:17,fontWeight:"bold"},children:"Select the Market"}),e.jsx("br",{}),e.jsx("br",{}),e.jsx(Ie,{onChange:()=>{ee("all")},type:"radio",name:"mainCategoryRadio",id:"flexRadioDefault0",label:"All"},"0"),Ke.map((s,a)=>e.jsx(Ie,{onChange:()=>{ee(s.id)},type:"radio",name:"mainCategoryRadio",id:`flexRadioDefault${a}`,label:s.address},a))]})})}),e.jsx(xs,{children:e.jsx(U,{size:"sm",onClick:()=>{es()},style:{backgroundColor:"#ff4d4d",width:90,color:"white"},children:"Save"})})]})]})};export{Ns as default};
