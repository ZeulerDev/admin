import{r as o,y as G,A as u,j as e,i as J}from"./index-D7hMCpfZ.js";import{a as B}from"./axios-Cm0UX6qg.js";import{P as R,F as K,O as X}from"./OccasionalEmployeePDF-DbYCI8gI.js";/* empty css               */import{B as z}from"./config-HOLfLxHr.js";import{b as Z,a as h}from"./CContainer-CtIWBirN.js";import{C as ss}from"./CNavbar-CF5s_Yu1.js";import{C as es}from"./CFormInput-C_rKCNW0.js";import{C as as,a as ts,b as os,c,e as ls}from"./DefaultLayout-jgAbWox0.js";import{C as ns,a as rs,b as F,c as l,d as is,e as n}from"./CTable-DPgvjQZA.js";import{C as I,a as H,b as L,c as M}from"./CModalTitle-CcgDWxHa.js";import"./inheritsLoose-CkMbdMht.js";import"./index-CTsLmSaI.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./CFormLabel-COYWKIaa.js";const Ds=()=>{const[y,w]=o.useState(!1),[N,f]=o.useState(!1),[{user:b,token:p},d]=G(),[O,S]=o.useState(!1),[P,v]=o.useState([]),[x,V]=o.useState([]),[$,D]=o.useState("All"),[T,k]=o.useState(""),[j,Y]=o.useState(""),[A,g]=o.useState(""),[m,_]=o.useState(""),[cs,Q]=o.useState(!1);o.useEffect(()=>{b&&p&&W()},[T,j]);const W=()=>{S(!0),B.get(z+`assistant/drivers/payouts/0?status=${T}&no=${j}`,{headers:{Authorization:`Bearer ${p}`}}).then(s=>{s.status===200?(v(s.data),S(!1),Q(!1)):s.status===204?d({type:u,payload:{status:!0,title:"Error",message:s.data.message,color:"warning"}}):s.status===500&&d({type:u,payload:{status:!0,title:"Error",message:s.data.message,color:"warning"}})}).catch(s=>{console.log("Error",s)})},U=(s,a)=>{w(!y),V({type:s,item:a}),console.log("Toggle",s,a)},C=(s,a)=>{f(!y),_(s),console.log("VIew",s,a),a==="waiting"||a==="sent"?g("ready"):a==="ready"&&g("done")},q=()=>{console.log("Confirmation",A,m);const s={status:A};b&&p&&B.patch(z+"assistant/payout/change/"+m,s,{headers:{Authorization:`Bearer ${p}`}}).then(a=>{if(a.status===200){console.log("updated"),f(!1);const t=a.data,r=P.map(E=>E.id===t.id?t:E);v([...r])}else a.status===203?d({type:u,payload:{status:!0,title:"Driver Payout status error",message:a.data.message}}):a.status===204?(console.log("204"),d({type:u,payload:{status:!0,title:"Driver Payout status error",message:a.data.message}})):a.status===500&&d({type:u,payload:{status:!0,title:"Driver Payout status update error",message:a.data.message}})}).catch(a=>{console.error(a)})},i=s=>{s==="all"?(k(""),D("All")):(console.log(s),k(s),D(s))};return e.jsxs(Z,{children:[e.jsxs(ss,{className:"bg-body-tertiary",children:[e.jsx(es,{type:"text",placeholder:"Search by No",style:{width:200,marginLeft:"2%"},value:j,onChange:s=>Y(s.target.value)}),e.jsxs(as,{style:{marginLeft:"63%",width:"10%",backgroundColor:"#ff4d4d"},children:[e.jsx(ts,{children:$}),e.jsxs(os,{children:[e.jsx(c,{onClick:()=>i("all"),children:"All"}),e.jsx(c,{onClick:()=>i("pending"),children:"Pending"}),e.jsx(c,{onClick:()=>i("sent"),children:"Sent"}),e.jsx(c,{onClick:()=>i("ready"),children:"Ready"}),e.jsx(c,{onClick:()=>i("waiting"),children:"Waiting"}),e.jsx(c,{onClick:()=>i("done"),children:"Done"})]})]}),e.jsx("br",{})]}),O?e.jsx(J,{}):e.jsxs(ns,{children:[e.jsx(rs,{children:e.jsxs(F,{children:[e.jsx(l,{scope:"col",children:"No"}),e.jsx(l,{scope:"col",children:"Name"}),e.jsx(l,{scope:"col",children:"Status"}),e.jsx(l,{scope:"col",children:"Date"}),e.jsx(l,{scope:"col",children:"Total"}),e.jsx(l,{scope:"col",children:"Tax"}),e.jsx(l,{scope:"col",children:"Tips"}),e.jsx(l,{scope:"col",children:"Payable"}),e.jsx(l,{scope:"col",children:"Action"}),e.jsx(l,{scope:"col",children:"Action"})]})}),e.jsx(is,{children:P.map((s,a)=>{let t="info",r="";return(s==null?void 0:s.status)==="pending"?(r="Pending",t="info"):(s==null?void 0:s.status)==="done"?(r="Paid",t="primary"):(s==null?void 0:s.status)==="sent"?(r="Sent",t="success"):(s==null?void 0:s.status)==="waiting"?(r="Waiting",t="warning"):(s==null?void 0:s.status)==="ready"&&(r="Ready",t="danger"),e.jsxs(F,{children:[e.jsx(n,{children:s.no}),e.jsx(n,{children:s.name}),e.jsx(n,{children:e.jsx(ls,{style:{width:60},color:t,children:r})}),e.jsx(n,{children:s.date}),e.jsx(n,{children:s.total}),e.jsx(n,{children:s.tax}),e.jsx(n,{children:s.tips}),e.jsx(n,{children:s.payable}),e.jsxs(n,{children:[(s==null?void 0:s.status)==="waiting"&&e.jsx(h,{onClick:()=>C(s.id,s.status),size:"sm",color:t,style:{width:90},children:"Received"}),(s==null?void 0:s.status)==="sent"&&e.jsx(h,{size:"sm",onClick:()=>C(s.id,s.status),color:t,style:{width:90},children:"Received"}),(s==null?void 0:s.status)==="ready"&&e.jsx(h,{size:"sm",onClick:()=>C(s.id,s.status),color:t,style:{width:90},children:"To Pay"})]}),e.jsxs(n,{children:[e.jsx(h,{size:"sm",style:{backgroundColor:"#ff4d4d",width:80},onClick:()=>U(s.type,s),children:"View"})," "]})]},a)})})]}),e.jsxs(I,{visible:y,scrollable:!0,size:"xl",onClose:()=>w(!1),children:[e.jsx(H,{closeButton:!0,children:e.jsx(L,{children:"Information"})}),e.jsx(M,{style:{overflowY:"auto",maxHeight:"70vh",display:"flex",justifyContent:"center"},children:x.type==="flat_rate"?e.jsx(R,{style:{width:"100%",height:"100vh"},children:e.jsx(K,{data:x.item})}):x.type==="occasional"?e.jsx(R,{style:{width:"100%",height:"100vh"},children:e.jsx(X,{data:x.item})}):null})]}),e.jsxs(I,{alignment:"center",transition:!1,visible:N,scrollable:!0,size:"lg",onClose:()=>f(!1),children:[e.jsx(H,{closeButton:!0,children:e.jsx(L,{children:"Confirmation"})}),e.jsxs(M,{style:{overflowY:"auto",maxHeight:"70vh",display:"flex",justifyContent:"center"},children:[e.jsx("a",{children:"Are you sure you want to pay out status ?"}),e.jsx(h,{onClick:()=>q(),style:{display:"flex",justifyContent:"center"},color:"primary",children:"Yes"})]})]})]})};export{Ds as default};
