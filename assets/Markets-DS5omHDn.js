import{r as o,_ as te,u as se,a as r,b as z,P as c,c as N,y as re,l as le,A as d,j as a,L as oe,i as ne}from"./index-B_IxP1Ll.js";import{a as F}from"./axios-Cm0UX6qg.js";import{B as L}from"./config-HOLfLxHr.js";import{b as ie,a as K}from"./CContainer-CDAlY_dy.js";import{C as ce}from"./CNavbar-B9n1oyL9.js";import{C as Q,a as W,b as X,c as P}from"./DefaultLayout-B7swiLMY.js";import{C as de,a as ue,b as Y,c as k,d as me,e as C}from"./CTable-CbTKEW9C.js";import{a as ee,C as Z}from"./CFormLabel-DhLxvRDg.js";import{C as he,a as _}from"./CPaginationItem-BTOTgEMQ.js";var y=o.forwardRef(function(s,u){var n=s.className,i=s.button,U=s.feedback,R=s.feedbackInvalid,V=s.feedbackValid,T=s.floatingLabel,w=s.tooltipFeedback,j=s.hitArea,m=s.id,h=s.indeterminate,$=s.inline,E=s.invalid,p=s.label,I=s.reverse,D=s.type,O=D===void 0?"checkbox":D,b=s.valid,B=te(s,["className","button","feedback","feedbackInvalid","feedbackValid","floatingLabel","tooltipFeedback","hitArea","id","indeterminate","inline","invalid","label","reverse","type","valid"]),f=o.useRef(null),g=se(u,f);o.useEffect(function(){f.current&&h&&(f.current.indeterminate=h)},[h,f.current]);var v=function(){return r.createElement("input",z({type:O,className:N(i?"btn-check":"form-check-input",{"is-invalid":E,"is-valid":b,"me-2":j}),id:m},B,{ref:g}))},A=function(){return r.createElement(ee,{describedby:B["aria-describedby"],feedback:U,feedbackInvalid:R,feedbackValid:V,floatingLabel:T,invalid:E,tooltipFeedback:w,valid:b})},M=function(){var x;return r.createElement(Z,z({customClassName:N(i?N("btn",i.variant?"btn-".concat(i.variant,"-").concat(i.color):"btn-".concat(i.color),(x={},x["btn-".concat(i.size)]=i.size,x),"".concat(i.shape)):"form-check-label")},m&&{htmlFor:m}),p)},S=function(){return i?r.createElement(r.Fragment,null,r.createElement(v,null),p&&r.createElement(M,null),r.createElement(A,null)):p?j?r.createElement(r.Fragment,null,r.createElement(v,null),r.createElement(Z,z({customClassName:N("form-check-label stretched-link",n)},m&&{htmlFor:m}),p),r.createElement(A,null)):r.createElement("div",{className:N("form-check",{"form-check-inline":$,"form-check-reverse":I,"is-invalid":E,"is-valid":b},n)},r.createElement(v,null),r.createElement(M,null),r.createElement(A,null)):r.createElement(v,null)};return r.createElement(S,null)});y.propTypes=z({button:c.object,className:c.string,hitArea:c.oneOf(["full"]),id:c.string,indeterminate:c.bool,inline:c.bool,label:c.oneOfType([c.string,c.node]),reverse:c.bool,type:c.oneOf(["checkbox","radio"])},ee.propTypes);y.displayName="CFormCheck";const je=()=>{const[{user:s,token:u},n]=re(),[i,U]=o.useState([]),[R,V]=o.useState([]),[T,w]=o.useState(""),[j,m]=o.useState(""),[h,$]=o.useState(0),[E,p]=o.useState("All Cities"),[I,D]=o.useState("All Chains");o.useState();const[O,b]=o.useState(!1),[B,f]=o.useState(!0);le(),o.useEffect(()=>{u&&F.get(L+"assistant/market/chains/all",{headers:{Authorization:`Bearer ${u}`}}).then(e=>{e.status===200?U(e.data):e.status===500&&n({type:d,payload:{status:!0,title:"Chain Loading error",message:e.data.message}})}).catch(e=>{console.error("Error: ",e)})},[]),o.useEffect(()=>{s&&u&&g(0)},[T,j,s]);const g=(e,t)=>{b(!0),F.get(L+`assistant/market/locations/${e}?brand=${T}&city=${j}`,{headers:{Authorization:`Bearer ${u}`}}).then(l=>{l.status===200?(V(l.data.data),b(!1),l.data.data.length<20?(f(!0),console.log("ok")):l.data.data.length>19&&f(!1)):l.status===500&&n({type:d,payload:{status:!0,title:"Market Loading error",message:l.data.message}})}).catch(l=>{console.error("Error: ",l)})},v=()=>{const e=h+20;$(e),g(e)},A=()=>{const e=h-20;console.log(e),$(e),g(e)},M=(e,t)=>{e==="all"?(w(""),D("All Chains")):(w(e),D(t))},S=e=>{e==="all"?(m(""),p("All Cities")):(m(e),p(e))},x=(e,t,l)=>{console.log(e),console.log(R),l==="delivery"?(G({market:e,service:l}),console.log("add delivery")):l==="pickup"&&(G({market:e,service:l}),console.log("add pickup"))},q=(e,t,l)=>{l==="delivery"?(J({market:e,service:l}),console.log("remove delivery")):l==="pickup"&&(J({market:e,service:l}),console.log("remove pickup"))},G=e=>{F.post(L+"assistant/markets/add/services",e,{headers:{Authorization:`Bearer ${u}`}}).then(t=>{t.status===200?console.log("Updated add service"):t.status===203?n({type:d,payload:{status:!0,title:"Market Updated error",message:t.data.message}}):t.status===204?n({type:d,payload:{status:!0,title:"Market Updated error",message:t.data.message}}):t.status===500&&n({type:d,payload:{status:!0,title:"Market Updated error",message:t.data.message}})}).catch(t=>{console.error("Error:",t)})},J=e=>{F.post(L+"assistant/markets/remove/services",e,{headers:{Authorization:`Bearer ${u}`}}).then(t=>{t.status===200?console.log("Updated remove service"):t.status===203?n({type:d,payload:{status:!0,title:"Market remove error",message:t.data.message}}):t.status===204?n({type:d,payload:{status:!0,title:"Market remove error",message:t.data.message}}):t.status===500&&n({type:d,payload:{status:!0,title:"Market remove error",message:t.data.message}})}).catch(t=>{console.error("Error:",t)})},ae=e=>{console.log(e),F.delete(L+"market/"+e,{headers:{Authorization:`Bearer ${u}`}}).then(t=>{t.status===200?(n({type:d,payload:{status:!0,title:"Market Delete",message:"Market Remove Success",color:"success"}}),g(0),console.log("Remove Market")):t.status===404?n({type:d,payload:{status:!0,title:"Market remove error",message:t.data.message}}):t.status===500&&n({type:d,payload:{status:!0,title:"Market remove error",message:t.data.message}})}).catch(t=>{console.error("Error:",t)})};return a.jsxs(ie,{children:[a.jsxs(ce,{className:"bg-body-tertiary",children:[a.jsx(oe,{to:"/markets/addmarket",children:a.jsx(K,{color:"success",variant:"outline",style:{marginLeft:"3%",width:"200px"},children:"Add New Market"})}),a.jsxs(Q,{style:{marginLeft:"55%",width:"10%",backgroundColor:"#ff4d4d"},children:[a.jsx(W,{children:E}),a.jsxs(X,{children:[a.jsx(P,{onClick:()=>S("all"),children:"All"}),a.jsx(P,{onClick:()=>S("Milano"),children:"Milano"}),a.jsx(P,{onClick:()=>S("Napoli"),children:"Napoli"})]})]}),a.jsxs(Q,{style:{marginRight:"1%",width:"15%",backgroundColor:"#ff4d4d"},children:[a.jsx(W,{children:I}),a.jsxs(X,{children:[a.jsx(P,{onClick:()=>M("all"),children:"All"}),i.map((e,t)=>a.jsx(P,{onClick:()=>M(e.id,e.name),children:e.name},t))]})]})]}),O?a.jsx(ne,{}):a.jsxs(de,{children:[a.jsx(ue,{children:a.jsxs(Y,{children:[a.jsx(k,{scope:"col",children:"Name"}),a.jsx(k,{scope:"col",children:"Address"}),a.jsx(k,{scope:"col",children:"City"}),a.jsx(k,{scope:"col",children:"Delivery"}),a.jsx(k,{scope:"col",children:"Pickup"}),a.jsx(k,{scope:"col",children:"Scraped"}),a.jsx(k,{scope:"col",children:"Remove"})]})}),a.jsx(me,{children:R.map((e,t)=>a.jsxs(Y,{children:[a.jsx(C,{children:e.chain.name}),a.jsx(C,{children:e.address}),a.jsx(C,{children:e.city}),a.jsx(C,{children:e.services.includes("delivery")?a.jsx(y,{id:"flexCheckChecked",label:"",defaultChecked:!0,onChange:()=>q(e._id,!0,"delivery")}):a.jsx(y,{id:"flexCheckChecked",label:"",onChange:()=>x(e._id,!0,"delivery")})}),a.jsx(C,{children:e.services.includes("pickup")?a.jsx(y,{id:"flexCheckChecked",label:"",defaultChecked:!0,onChange:()=>q(e._id,!0,"pickup")}):a.jsx(y,{id:"flexCheckChecked",label:"",onChange:()=>x(e._id,!0,"pickup")})}),a.jsx(C,{children:e.scraped}),a.jsx(C,{children:a.jsx(K,{size:"sm",style:{backgroundColor:"#ff4d4d"},variant:"outline",onClick:()=>ae(e._id),children:"Remove"})})]},t))})]}),a.jsxs(he,{"aria-label":"Page navigation example",children:[a.jsx(_,{disabled:h<=0,onClick:A,children:"Previous"}),a.jsx(_,{disabled:B===!0,onClick:v,children:"Next"})]})]})};export{je as default};
