import{y as _,r as o,A as i,j as e,L as g,i as H,m as F}from"./index-CjCXLRkW.js";import{a as D}from"./axios-Cm0UX6qg.js";import{B as G}from"./config-HOLfLxHr.js";import{b as U,a as r}from"./CContainer-BW2BquLn.js";import{d as V,C as Y,a as q,b as J,c as x}from"./DefaultLayout-Dj8TmLuH.js";import{C as K}from"./CNavbar-CVLaW_qY.js";import{C as O,a as Q,b as S,c as n,d as W,e as c}from"./CTable-Dq4mQIri.js";import{c as X}from"./cil-trash-CBbKHhHb.js";import{C as Z,a as T}from"./CPaginationItem-izTBqF-z.js";import{C as ee,a as te,b as se,c as ae}from"./CModalTitle-cCF-Sb-H.js";const me=()=>{const[{user:f,token:p},l]=_(),[C,j]=o.useState(""),[L,k]=o.useState("All Cities"),[v,A]=o.useState([]),[h,y]=o.useState(0),[P,b]=o.useState(!0),[B,w]=o.useState(!1),[M,d]=o.useState(!1),[E,N]=o.useState(""),m=t=>{t==="all"?(j(""),k("All Cities")):(j(t),k(t))};o.useEffect(()=>{f&&p&&u(0)},[f,C]);const u=(t,s)=>{w(!0),D.get(G+`market/groups/fetch/${t}?city=${C}`,{headers:{Authorization:`Bearer ${p}`}}).then(a=>{console.log(a.status),a.status===200?(A(a.data),w(!1),a.data.length<20?(b(!0),console.log("ok")):a.data.length>19&&b(!1)):a.status===500&&l({type:i,payload:{status:!0,title:"Makrket Group loading error",message:a.data.message}})}).catch(a=>{console.error("Error:",a)})},R=()=>{const t=h+20;y(t),u(t)},I=()=>{const t=h-20;console.log(t),y(t),u(t)},z=t=>{d(!M),N(t)},$=t=>{console.log(t),D.delete(G+"marketgroup/"+t,{headers:{Authorization:`Bearer ${p}`}}).then(s=>{s.status===200?(l({type:i,payload:{status:!0,title:"Market Group Delete",message:"Market Group Delete Success",color:"success"}}),d(!1),u(0),console.log("Remove Market Group")):s.status===203?l({type:i,payload:{status:!0,title:"Market Group Delete",message:s.data.message,color:"warning"}}):s.status===404?l({type:i,payload:{status:!0,title:"Market Group Delete",message:s.data.message,color:"warning"}}):s.status===500&&l({type:i,payload:{status:!0,title:"Market Group Delete",message:s.data.message,color:"warning"}})}).catch(s=>{console.error("Error:",s)})};return e.jsxs(U,{children:[e.jsx(g,{to:"/marketgroups/marketmap",children:e.jsx(r,{style:{marginLeft:"0%",width:"17%",backgroundColor:"#ff4d4d",color:"white"},children:"Add Market"})}),e.jsx(g,{to:"/marketgroups/createmarketgroup",children:e.jsx(r,{style:{marginLeft:"2%",width:"17%",backgroundColor:"#ff4d4d",color:"white"},children:"Create Market Group"})}),e.jsx(V,{style:{marginLeft:"39%"},color:"secondary",children:"Filter by"}),e.jsxs(Y,{style:{marginLeft:"2%",width:"17%",marginRight:"5px",backgroundColor:"#ff4d4d"},children:[e.jsx(q,{style:{color:"white"},children:L}),e.jsxs(J,{children:[e.jsx(x,{onClick:()=>m("all"),children:"All"}),e.jsx(x,{onClick:()=>m("Milano"),children:"Milano"}),e.jsx(x,{onClick:()=>m("Napoli"),children:"Napoli"})]})]}),e.jsx(K,{style:{marginTop:"1%"},className:"bg-body-tertiary"}),B?e.jsx(H,{}):e.jsxs(O,{children:[e.jsx(Q,{children:e.jsxs(S,{children:[e.jsx(n,{scope:"col",children:"#"}),e.jsx(n,{scope:"col",children:"Name"}),e.jsx(n,{scope:"col",children:"City"}),e.jsx(n,{scope:"col",children:"Location"}),e.jsx(n,{scope:"col",children:"Remove"})]})}),e.jsx(W,{children:v.map((t,s)=>e.jsxs(S,{children:[e.jsx(c,{children:s+1}),e.jsx(c,{children:t.name}),e.jsx(c,{children:t.city}),e.jsx(c,{children:e.jsx(g,{to:`/marketgroups/marketdistance/${t._id}`,children:e.jsx(r,{size:"sm",style:{backgroundColor:"#ff4d4d",marginLeft:"5px",color:"white"},children:"view"})})}),e.jsx(c,{children:e.jsx(r,{size:"sm",style:{backgroundColor:"#ff4d4d"},variant:"outline",onClick:()=>z(t._id),children:e.jsx(F,{icon:X,size:"lg",style:{color:"white"}})})})]},s))})]}),e.jsxs(Z,{"aria-label":"Page navigation example",children:[e.jsx(T,{disabled:h<=0,onClick:I,children:"Previous"}),e.jsx(T,{disabled:P===!0,onClick:R,children:"Next"})]}),e.jsxs(ee,{alignment:"center",visible:M,scrollable:!0,size:"sm",onClose:()=>d(!1),children:[e.jsx(te,{closeButton:!1,children:e.jsx(se,{children:"Confirmation"})}),e.jsxs(ae,{children:[e.jsx("a",{children:"Are you sure you want to delete this market group?"}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("div",{style:{display:"flex",justifyContent:"center"},children:[e.jsx(r,{onClick:()=>$(E),style:{backgroundColor:"#ff4d4d",color:"white",marginRight:"10px"},children:"Yes"}),e.jsx(r,{onClick:()=>d(!1),style:{backgroundColor:"#ff4d4d",color:"white",marginLeft:"10px"},children:"No"})]})]})]})]})};export{me as default};
